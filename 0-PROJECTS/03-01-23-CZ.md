<small>Claude Sonnet 4 **(N√°stroj pro Hodnocen√≠ Dopad≈Ø na ≈Ωivotn√≠ Prost≈ôed√≠ s RAG)**</small>
# Environmental Impact Assessment Tool

## 1. N√°zev Projektu

**Environmental Impact Assessment Tool** - Inteligentn√≠ syst√©m pro hodnocen√≠ dopad≈Ø na ≈æivotn√≠ prost≈ôed√≠ vyu≈æ√≠vaj√≠c√≠ RAG (Retrieval-Augmented Generation) pro anal√Ωzu uhl√≠kov√© stopy, udr≈æitelnosti a regulaƒçn√≠ch standard≈Ø.

## 2. Kl√≠ƒçov√© Koncepty

### RAG (Retrieval-Augmented Generation)
Kombinace vyhled√°v√°n√≠ relevantn√≠ch informac√≠ z datab√°ze znalost√≠ s generativn√≠mi schopnostmi LLM pro vytv√°≈ôen√≠ p≈ôesn√Ωch a kontextu√°lnƒõ bohat√Ωch odpovƒõd√≠.

### Uhl√≠kov√° Stopa (Carbon Footprint)
Celkov√© mno≈æstv√≠ sklen√≠kov√Ωch plyn≈Ø vyprodukovan√Ωch p≈ô√≠mo nebo nep≈ô√≠mo lidsk√Ωmi aktivitami, mƒõ≈ôen√© v ekvivalentu CO2.

### Zpr√°vy o Udr≈æitelnosti
Dokumenty popisuj√≠c√≠ environment√°ln√≠, soci√°ln√≠ a governance (ESG) v√Ωkonnost organizac√≠.

### Regulaƒçn√≠ Standardy
Pr√°vn√≠ p≈ôedpisy a smƒõrnice stanovuj√≠c√≠ limity a po≈æadavky pro ochranu ≈æivotn√≠ho prost≈ôed√≠.

### Klimatick√© Modely
Matematick√© reprezentace klimatick√©ho syst√©mu pou≈æ√≠van√© pro p≈ôedpovƒõdi a anal√Ωzy klimatick√Ωch zmƒõn.

### EPA Datab√°ze
Datab√°ze Agentury pro ochranu ≈æivotn√≠ho prost≈ôed√≠ USA obsahuj√≠c√≠ environment√°ln√≠ data a regulace.

### Zelen√© Technologie
Inovativn√≠ technologie navr≈æen√© k minimalizaci negativn√≠ch dopad≈Ø na ≈æivotn√≠ prost≈ôed√≠.

### Vizualizace Dopad≈Ø
Grafick√© reprezentace environment√°ln√≠ch dat pro lep≈°√≠ pochopen√≠ a komunikaci v√Ωsledk≈Ø.

## 3. Komplexn√≠ Vysvƒõtlen√≠ Projektu

### C√≠le Projektu
Tento projekt vytv√°≈ô√≠ inteligentn√≠ syst√©m pro komplexn√≠ hodnocen√≠ environment√°ln√≠ch dopad≈Ø firem a projekt≈Ø. Syst√©m vyu≈æ√≠v√° RAG architekturu pro:

- **Automatizovanou anal√Ωzu**: Zpracov√°n√≠ velk√Ωch objem≈Ø environment√°ln√≠ch dat
- **Regulaƒçn√≠ compliance**: Kontrola souladu s environment√°ln√≠mi p≈ôedpisy
- **Prediktivn√≠ modelov√°n√≠**: Odhad budouc√≠ch environment√°ln√≠ch dopad≈Ø
- **Doporuƒçen√≠ pro zlep≈°en√≠**: N√°vrhy pro sn√≠≈æen√≠ environment√°ln√≠ z√°tƒõ≈æe

### V√Ωzvy Projektu
- **Heterogenita dat**: Integrace r≈Øzn√Ωch typ≈Ø environment√°ln√≠ch dat
- **Aktu√°lnost informac√≠**: Rychle se mƒõn√≠c√≠ regulace a standardy
- **P≈ôesnost v√Ωpoƒçt≈Ø**: Slo≈æit√© kalkulace uhl√≠kov√© stopy
- **Interpretace v√Ωsledk≈Ø**: P≈ôevod technick√Ωch dat do srozumiteln√© formy

### Potenci√°ln√≠ Dopad
- **Firemn√≠ udr≈æitelnost**: Pomoc firm√°m sni≈æovat environment√°ln√≠ dopady
- **Regulaƒçn√≠ podpora**: Zjednodu≈°en√≠ compliance proces≈Ø
- **Investiƒçn√≠ rozhodov√°n√≠**: Informovan√° ESG investiƒçn√≠ rozhodnut√≠
- **Transparentnost**: Lep≈°√≠ komunikace environment√°ln√≠ch v√Ωsledk≈Ø

## 4. Komplexn√≠ P≈ô√≠klad s Python Implementac√≠

````python
import os
import json
import numpy as np
import pandas as pd
import requests
from datetime import datetime
from typing import List, Dict, Any, Optional
import logging
from dataclasses import dataclass

# AI/ML knihovny
from langchain.embeddings import OpenAIEmbeddings
from langchain.vectorstores import Chroma
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain.llms import OpenAI
from langchain.chains import RetrievalQA
from langchain.document_loaders import TextLoader
from langchain.schema import Document

# Vizualizace
import matplotlib.pyplot as plt
import seaborn as sns
import plotly.graph_objects as go
import plotly.express as px
from plotly.subplots import make_subplots

# Konfigurace logov√°n√≠
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

@dataclass
class EmissionFactor:
    """Struktura pro emisn√≠ faktory"""
    source: str
    factor_co2: float  # kg CO2 eq per unit
    unit: str
    category: str
    reliability: float

@dataclass
class EnvironmentalData:
    """Struktura pro environment√°ln√≠ data"""
    company_id: str
    period: str
    energy_consumption: float  # kWh
    fuel_consumption: float  # liters
    waste_generated: float  # kg
    water_usage: float  # liters
    renewable_energy_ratio: float  # 0-1
    recycling_ratio: float  # 0-1
    
class EnvironmentalDataManager:
    """Spr√°vce environment√°ln√≠ch dat"""
    
    def __init__(self):
        self.emission_factors = self._load_emission_factors()
        self.regulatory_standards = self._load_regulatory_standards()
        
    def _load_emission_factors(self) -> Dict[str, EmissionFactor]:
        """Naƒçten√≠ emisn√≠ch faktor≈Ø"""
        return {
            'electricity_grid': EmissionFactor(
                source='electricity',
                factor_co2=0.5,  # kg CO2/kWh (pr≈Ømƒõr EU)
                unit='kWh',
                category='energy',
                reliability=0.9
            ),
            'diesel_fuel': EmissionFactor(
                source='diesel',
                factor_co2=2.68,  # kg CO2/liter
                unit='liter',
                category='transport',
                reliability=0.95
            ),
            'natural_gas': EmissionFactor(
                source='natural_gas',
                factor_co2=2.0,  # kg CO2/m3
                unit='m3',
                category='heating',
                reliability=0.93
            ),
            'waste_landfill': EmissionFactor(
                source='waste',
                factor_co2=0.5,  # kg CO2/kg
                unit='kg',
                category='waste',
                reliability=0.7
            )
        }
    
    def _load_regulatory_standards(self) -> Dict[str, Dict]:
        """Naƒçten√≠ regulaƒçn√≠ch standard≈Ø"""
        return {
            'eu_taxonomy': {
                'description': 'EU Taxonomy for Sustainable Activities',
                'carbon_intensity_threshold': 100,  # gCO2/kWh
                'renewable_energy_min': 0.67,
                'waste_recycling_min': 0.65
            },
            'iso_14001': {
                'description': 'Environmental Management Systems',
                'requires_monitoring': True,
                'continuous_improvement': True
            },
            'ghg_protocol': {
                'description': 'Greenhouse Gas Protocol',
                'scope1_direct': True,
                'scope2_indirect': True,
                'scope3_value_chain': True
            }
        }

class CarbonFootprintCalculator:
    """Kalkul√°tor uhl√≠kov√© stopy"""
    
    def __init__(self, data_manager: EnvironmentalDataManager):
        self.data_manager = data_manager
        
    def calculate_scope1_emissions(self, data: EnvironmentalData) -> float:
        """V√Ωpoƒçet p≈ô√≠m√Ωch emis√≠ (Scope 1)"""
        try:
            diesel_factor = self.data_manager.emission_factors['diesel_fuel']
            gas_factor = self.data_manager.emission_factors['natural_gas']
            
            diesel_emissions = data.fuel_consumption * diesel_factor.factor_co2
            gas_emissions = data.fuel_consumption * 0.3 * gas_factor.factor_co2  # p≈ôedpoklad 30% zemn√≠ plyn
            
            return diesel_emissions + gas_emissions
        except Exception as e:
            logger.error(f"Chyba p≈ôi v√Ωpoƒçtu Scope 1: {e}")
            return 0.0
    
    def calculate_scope2_emissions(self, data: EnvironmentalData) -> float:
        """V√Ωpoƒçet nep≈ô√≠m√Ωch emis√≠ z energie (Scope 2)"""
        try:
            electricity_factor = self.data_manager.emission_factors['electricity_grid']
            
            # Zohlednƒõn√≠ pod√≠lu obnoviteln√© energie
            grid_electricity = data.energy_consumption * (1 - data.renewable_energy_ratio)
            emissions = grid_electricity * electricity_factor.factor_co2
            
            return emissions
        except Exception as e:
            logger.error(f"Chyba p≈ôi v√Ωpoƒçtu Scope 2: {e}")
            return 0.0
    
    def calculate_scope3_emissions(self, data: EnvironmentalData) -> float:
        """V√Ωpoƒçet ostatn√≠ch nep≈ô√≠m√Ωch emis√≠ (Scope 3)"""
        try:
            waste_factor = self.data_manager.emission_factors['waste_landfill']
            
            # Zohlednƒõn√≠ recyklace
            landfill_waste = data.waste_generated * (1 - data.recycling_ratio)
            emissions = landfill_waste * waste_factor.factor_co2
            
            return emissions
        except Exception as e:
            logger.error(f"Chyba p≈ôi v√Ωpoƒçtu Scope 3: {e}")
            return 0.0
    
    def calculate_total_footprint(self, data: EnvironmentalData) -> Dict[str, float]:
        """V√Ωpoƒçet celkov√© uhl√≠kov√© stopy"""
        scope1 = self.calculate_scope1_emissions(data)
        scope2 = self.calculate_scope2_emissions(data)
        scope3 = self.calculate_scope3_emissions(data)
        total = scope1 + scope2 + scope3
        
        return {
            'scope1': scope1,
            'scope2': scope2,
            'scope3': scope3,
            'total': total,
            'intensity': total / max(data.energy_consumption, 1),  # kg CO2/kWh
            'period': data.period
        }

class KnowledgeBase:
    """Znalostn√≠ b√°ze pro RAG syst√©m"""
    
    def __init__(self):
        self.documents = []
        self.vector_store = None
        self.embeddings = OpenAIEmbeddings(openai_api_key=os.getenv('OPENAI_API_KEY'))
        self._initialize_knowledge_base()
    
    def _initialize_knowledge_base(self):
        """Inicializace znalostn√≠ b√°ze s environment√°ln√≠mi dokumenty"""
        try:
            # Vytvo≈ôen√≠ syntetick√Ωch dokument≈Ø
            documents_data = [
                {
                    'title': 'EU Taxonomy Regulation',
                    'content': """
                    EU Taxonomy je klasifikaƒçn√≠ syst√©m pro environment√°lnƒõ udr≈æiteln√© ekonomick√© aktivity.
                    Stanovuje krit√©ria pro:
                    - Klimatick√© zmƒõny - mitigace a adaptace
                    - Udr≈æiteln√© vyu≈æ√≠v√°n√≠ vodn√≠ch a mo≈ôsk√Ωch zdroj≈Ø
                    - P≈ôechod na obƒõhov√© hospod√°≈ôstv√≠
                    - Prevence a kontrola zneƒçi≈°tƒõn√≠
                    - Ochrana a obnova biodiverzity a ekosyst√©m≈Ø
                    
                    Prahov√© hodnoty:
                    - Energetick√° n√°roƒçnost budov: < 95 kWh/m¬≤/rok
                    - Emisn√≠ intenzita elekt≈ôiny: < 100 gCO2/kWh
                    - Pod√≠l obnoviteln√Ωch zdroj≈Ø: > 67%
                    """
                },
                {
                    'title': 'GHG Protocol Standards',
                    'content': """
                    Greenhouse Gas Protocol je glob√°ln√≠ standard pro mƒõ≈ôen√≠ a reporting emis√≠ sklen√≠kov√Ωch plyn≈Ø.
                    
                    Scope 1 - P≈ô√≠m√© emisje:
                    - Spalov√°n√≠ paliv ve vlastn√≠ch za≈ô√≠zen√≠ch
                    - Firemn√≠ vozidla
                    - Pr≈Ømyslov√© procesy
                    
                    Scope 2 - Nep≈ô√≠m√© emisje z energie:
                    - Nakupovan√° elekt≈ôina
                    - Nakupovan√© teplo a chlazen√≠
                    - Nakupovan√Ω plyn
                    
                    Scope 3 - Ostatn√≠ nep≈ô√≠m√© emisje:
                    - Dodavatelsk√Ω ≈ôetƒõzec
                    - Doprava a distribuce
                    - Likvidace odpadu
                    """
                },
                {
                    'title': 'ISO 14001 Environmental Management',
                    'content': """
                    ISO 14001 je mezin√°rodn√≠ standard pro syst√©my environment√°ln√≠ho managementu.
                    
                    Kl√≠ƒçov√© po≈æadavky:
                    - Environment√°ln√≠ politika a c√≠le
                    - Pl√°nov√°n√≠ a implementace
                    - Monitoring a mƒõ≈ôen√≠
                    - Kontinu√°ln√≠ zlep≈°ov√°n√≠
                    
                    Principy:
                    - Prevence zneƒçi≈°tƒõn√≠
                    - Dodr≈æov√°n√≠ pr√°vn√≠ch po≈æadavk≈Ø
                    - Kontinu√°ln√≠ zlep≈°ov√°n√≠ environment√°ln√≠ v√Ωkonnosti
                    - Zapojen√≠ zainteresovan√Ωch stran
                    """
                },
                {
                    'title': 'Carbon Footprint Calculation Methods',
                    'content': """
                    Metody v√Ωpoƒçtu uhl√≠kov√© stopy:
                    
                    1. Emisn√≠ faktory:
                    - Elekt≈ôina: 0.5 kg CO2/kWh (EU pr≈Ømƒõr)
                    - Nafta: 2.68 kg CO2/liter
                    - Zemn√≠ plyn: 2.0 kg CO2/m¬≥
                    - Skl√°dkov√°n√≠ odpadu: 0.5 kg CO2/kg
                    
                    2. V√Ωpoƒçet intenzity:
                    - Uhl√≠kov√° intenzita = Celkov√© emisje / Produkce
                    - Energetick√° intenzita = Spot≈ôeba energie / Produkce
                    
                    3. Zohlednƒõn√≠ obnoviteln√Ωch zdroj≈Ø:
                    - Grid emisje = Spot≈ôeba √ó (1 - Pod√≠l OZE) √ó Emisn√≠ faktor
                    """
                }
            ]
            
            # Vytvo≈ôen√≠ Document objekt≈Ø
            for doc_data in documents_data:
                doc = Document(
                    page_content=doc_data['content'],
                    metadata={'title': doc_data['title'], 'source': 'knowledge_base'}
                )
                self.documents.append(doc)
            
            # Rozdƒõlen√≠ dokument≈Ø na men≈°√≠ ƒç√°sti
            text_splitter = RecursiveCharacterTextSplitter(
                chunk_size=500,
                chunk_overlap=50
            )
            
            split_docs = text_splitter.split_documents(self.documents)
            
            # Vytvo≈ôen√≠ vector store
            self.vector_store = Chroma.from_documents(
                split_docs,
                self.embeddings,
                persist_directory="./chroma_db"
            )
            
            logger.info(f"Znalostn√≠ b√°ze inicializov√°na s {len(split_docs)} fragmenty")
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi inicializaci znalostn√≠ b√°ze: {e}")

class EnvironmentalRAGSystem:
    """RAG syst√©m pro environment√°ln√≠ anal√Ωzy"""
    
    def __init__(self):
        self.knowledge_base = KnowledgeBase()
        self.llm = OpenAI(
            temperature=0.1,
            openai_api_key=os.getenv('OPENAI_API_KEY')
        )
        self.qa_chain = self._setup_qa_chain()
        
    def _setup_qa_chain(self):
        """Nastaven√≠ QA ≈ôetƒõzce"""
        try:
            retriever = self.knowledge_base.vector_store.as_retriever(
                search_kwargs={"k": 3}
            )
            
            qa_chain = RetrievalQA.from_chain_type(
                llm=self.llm,
                chain_type="stuff",
                retriever=retriever,
                return_source_documents=True
            )
            
            return qa_chain
        except Exception as e:
            logger.error(f"Chyba p≈ôi nastaven√≠ QA ≈ôetƒõzce: {e}")
            return None
    
    def analyze_compliance(self, footprint_data: Dict[str, float], 
                          standard: str = 'eu_taxonomy') -> Dict[str, Any]:
        """Anal√Ωza souladu s regulaƒçn√≠mi standardy"""
        try:
            query = f"""
            Analyzuj n√°sleduj√≠c√≠ uhl√≠kovou stopu podle standardu {standard}:
            - Celkov√© emisje: {footprint_data['total']:.2f} kg CO2
            - Scope 1: {footprint_data['scope1']:.2f} kg CO2
            - Scope 2: {footprint_data['scope2']:.2f} kg CO2
            - Scope 3: {footprint_data['scope3']:.2f} kg CO2
            - Uhl√≠kov√° intenzita: {footprint_data['intensity']:.2f} kg CO2/kWh
            
            Poskytni hodnocen√≠ souladu a doporuƒçen√≠ pro zlep≈°en√≠.
            """
            
            if self.qa_chain:
                result = self.qa_chain({"query": query})
                
                return {
                    'compliance_analysis': result['result'],
                    'source_documents': [doc.page_content for doc in result['source_documents']],
                    'standard': standard,
                    'assessment_date': datetime.now().isoformat()
                }
            else:
                return {'error': 'QA ≈ôetƒõzec nen√≠ dostupn√Ω'}
                
        except Exception as e:
            logger.error(f"Chyba p≈ôi anal√Ωze souladu: {e}")
            return {'error': str(e)}
    
    def get_improvement_recommendations(self, env_data: EnvironmentalData) -> Dict[str, Any]:
        """Z√≠sk√°n√≠ doporuƒçen√≠ pro zlep≈°en√≠"""
        try:
            query = f"""
            Na z√°kladƒõ n√°sleduj√≠c√≠ch environment√°ln√≠ch dat:
            - Spot≈ôeba energie: {env_data.energy_consumption} kWh
            - Spot≈ôeba paliv: {env_data.fuel_consumption} l
            - Produkce odpadu: {env_data.waste_generated} kg
            - Spot≈ôeba vody: {env_data.water_usage} l
            - Pod√≠l obnoviteln√© energie: {env_data.renewable_energy_ratio*100:.1f}%
            - M√≠ra recyklace: {env_data.recycling_ratio*100:.1f}%
            
            Poskytni konkr√©tn√≠ doporuƒçen√≠ pro sn√≠≈æen√≠ environment√°ln√≠ch dopad≈Ø.
            """
            
            if self.qa_chain:
                result = self.qa_chain({"query": query})
                
                return {
                    'recommendations': result['result'],
                    'priority_areas': self._identify_priority_areas(env_data),
                    'potential_savings': self._estimate_savings(env_data)
                }
            else:
                return {'error': 'QA ≈ôetƒõzec nen√≠ dostupn√Ω'}
                
        except Exception as e:
            logger.error(f"Chyba p≈ôi z√≠sk√°v√°n√≠ doporuƒçen√≠: {e}")
            return {'error': str(e)}
    
    def _identify_priority_areas(self, env_data: EnvironmentalData) -> List[str]:
        """Identifikace prioritn√≠ch oblast√≠ pro zlep≈°en√≠"""
        priorities = []
        
        if env_data.renewable_energy_ratio < 0.5:
            priorities.append("Zv√Ω≈°en√≠ pod√≠lu obnoviteln√© energie")
        
        if env_data.recycling_ratio < 0.6:
            priorities.append("Zlep≈°en√≠ syst√©mu recyklace")
        
        if env_data.energy_consumption > 10000:  # kWh
            priorities.append("Energetick√° efektivnost")
        
        return priorities
    
    def _estimate_savings(self, env_data: EnvironmentalData) -> Dict[str, float]:
        """Odhad potenci√°ln√≠ch √∫spor"""
        return {
            'energy_efficiency_10%': env_data.energy_consumption * 0.1 * 0.5,  # kg CO2
            'renewable_energy_50%': env_data.energy_consumption * 0.5 * 0.5,
            'waste_reduction_20%': env_data.waste_generated * 0.2 * 0.5
        }

class EnvironmentalVisualizer:
    """Vizualizace environment√°ln√≠ch dat"""
    
    def __init__(self):
        plt.style.use('seaborn-v0_8')
        
    def create_carbon_footprint_chart(self, footprint_data: Dict[str, float]) -> go.Figure:
        """Graf uhl√≠kov√© stopy podle scope"""
        fig = go.Figure(data=[
            go.Bar(
                x=['Scope 1', 'Scope 2', 'Scope 3'],
                y=[footprint_data['scope1'], footprint_data['scope2'], footprint_data['scope3']],
                marker_color=['#FF6B6B', '#4ECDC4', '#45B7D1'],
                text=[f'{v:.1f} kg CO2' for v in [footprint_data['scope1'], 
                                                 footprint_data['scope2'], 
                                                 footprint_data['scope3']]],
                textposition='auto'
            )
        ])
        
        fig.update_layout(
            title='Uhl√≠kov√° Stopa podle Scope',
            xaxis_title='Kategorie emis√≠',
            yaxis_title='Emisje CO2 (kg)',
            template='plotly_white'
        )
        
        return fig
    
    def create_sustainability_dashboard(self, env_data: EnvironmentalData, 
                                     footprint_data: Dict[str, float]) -> go.Figure:
        """Komplexn√≠ dashboard udr≈æitelnosti"""
        fig = make_subplots(
            rows=2, cols=2,
            subplot_titles=('Uhl√≠kov√° Stopa', 'Energetick√Ω Mix', 
                          'Hospoda≈ôen√≠ s Odpady', 'Kl√≠ƒçov√© Ukazatele'),
            specs=[[{"type": "bar"}, {"type": "pie"}],
                   [{"type": "bar"}, {"type": "indicator"}]]
        )
        
        # Graf uhl√≠kov√© stopy
        fig.add_trace(
            go.Bar(x=['Scope 1', 'Scope 2', 'Scope 3'],
                   y=[footprint_data['scope1'], footprint_data['scope2'], footprint_data['scope3']],
                   marker_color=['#FF6B6B', '#4ECDC4', '#45B7D1'],
                   name='Emisje CO2'),
            row=1, col=1
        )
        
        # Energetick√Ω mix
        fig.add_trace(
            go.Pie(labels=['Obnoviteln√° energie', 'S√≠≈•ov√° energie'],
                   values=[env_data.renewable_energy_ratio, 1-env_data.renewable_energy_ratio],
                   marker_colors=['#2ECC71', '#E74C3C'],
                   name='Energetick√Ω mix'),
            row=1, col=2
        )
        
        # Hospoda≈ôen√≠ s odpady
        fig.add_trace(
            go.Bar(x=['Recyklace', 'Skl√°dka'],
                   y=[env_data.waste_generated * env_data.recycling_ratio,
                      env_data.waste_generated * (1-env_data.recycling_ratio)],
                   marker_color=['#27AE60', '#E67E22'],
                   name='Odpad'),
            row=2, col=1
        )
        
        # Kl√≠ƒçov√Ω ukazatel - uhl√≠kov√° intenzita
        fig.add_trace(
            go.Indicator(
                mode="gauge+number+delta",
                value=footprint_data['intensity'],
                title={'text': "Uhl√≠kov√° Intenzita<br>(kg CO2/kWh)"},
                gauge={'axis': {'range': [None, 1.0]},
                       'bar': {'color': "darkblue"},
                       'steps': [{'range': [0, 0.3], 'color': "lightgray"},
                                {'range': [0.3, 0.7], 'color': "gray"}],
                       'threshold': {'line': {'color': "red", 'width': 4},
                                   'thickness': 0.75, 'value': 0.5}}),
            row=2, col=2
        )
        
        fig.update_layout(height=800, showlegend=False, 
                         title_text="Dashboard Environment√°ln√≠ch Ukazatel≈Ø")
        
        return fig

class EnvironmentalImpactTool:
    """Hlavn√≠ t≈ô√≠da n√°stroje pro hodnocen√≠ environment√°ln√≠ch dopad≈Ø"""
    
    def __init__(self):
        self.data_manager = EnvironmentalDataManager()
        self.calculator = CarbonFootprintCalculator(self.data_manager)
        self.rag_system = EnvironmentalRAGSystem()
        self.visualizer = EnvironmentalVisualizer()
        
    def assess_environmental_impact(self, env_data: EnvironmentalData) -> Dict[str, Any]:
        """Komplexn√≠ hodnocen√≠ environment√°ln√≠ch dopad≈Ø"""
        try:
            # V√Ωpoƒçet uhl√≠kov√© stopy
            footprint = self.calculator.calculate_total_footprint(env_data)
            
            # Anal√Ωza souladu s p≈ôedpisy
            compliance = self.rag_system.analyze_compliance(footprint)
            
            # Doporuƒçen√≠ pro zlep≈°en√≠
            recommendations = self.rag_system.get_improvement_recommendations(env_data)
            
            # Vytvo≈ôen√≠ vizualizac√≠
            carbon_chart = self.visualizer.create_carbon_footprint_chart(footprint)
            dashboard = self.visualizer.create_sustainability_dashboard(env_data, footprint)
            
            return {
                'carbon_footprint': footprint,
                'compliance_analysis': compliance,
                'improvement_recommendations': recommendations,
                'visualizations': {
                    'carbon_chart': carbon_chart.to_json(),
                    'dashboard': dashboard.to_json()
                },
                'assessment_summary': self._create_summary(footprint, compliance),
                'assessment_date': datetime.now().isoformat()
            }
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi hodnocen√≠ dopad≈Ø: {e}")
            return {'error': str(e)}
    
    def _create_summary(self, footprint: Dict[str, float], 
                       compliance: Dict[str, Any]) -> Dict[str, Any]:
        """Vytvo≈ôen√≠ souhrnn√©ho hodnocen√≠"""
        total_emissions = footprint['total']
        intensity = footprint['intensity']
        
        # Hodnocen√≠ podle benchmark≈Ø
        if intensity < 0.3:
            performance_rating = "V√Ωborn√°"
        elif intensity < 0.5:
            performance_rating = "Dobr√°"
        elif intensity < 0.7:
            performance_rating = "Pr≈Ømƒõrn√°"
        else:
            performance_rating = "Podpr≈Ømƒõrn√°"
        
        return {
            'total_emissions_kg_co2': total_emissions,
            'carbon_intensity': intensity,
            'performance_rating': performance_rating,
            'main_emission_source': max(
                [('Scope 1', footprint['scope1']),
                 ('Scope 2', footprint['scope2']),
                 ('Scope 3', footprint['scope3'])],
                key=lambda x: x[1]
            )[0],
            'improvement_potential': "Vysok√Ω" if intensity > 0.5 else "St≈ôedn√≠" if intensity > 0.3 else "N√≠zk√Ω"
        }

# Demonstraƒçn√≠ pou≈æit√≠
def main():
    """Demonstrace funkcionality n√°stroje"""
    try:
        # Vytvo≈ôen√≠ instance n√°stroje
        tool = EnvironmentalImpactTool()
        
        # Testovac√≠ data
        test_data = EnvironmentalData(
            company_id="DEMO_COMPANY_001",
            period="2024-Q1",
            energy_consumption=15000,  # kWh
            fuel_consumption=2000,     # liters
            waste_generated=5000,      # kg
            water_usage=50000,         # liters
            renewable_energy_ratio=0.3,  # 30%
            recycling_ratio=0.6        # 60%
        )
        
        # Proveden√≠ hodnocen√≠
        print("üå± Spou≈°t√≠m hodnocen√≠ environment√°ln√≠ch dopad≈Ø...")
        assessment = tool.assess_environmental_impact(test_data)
        
        if 'error' not in assessment:
            print("\nüìä V√ùSLEDKY HODNOCEN√ç:")
            print("=" * 50)
            
            # Uhl√≠kov√° stopa
            footprint = assessment['carbon_footprint']
            print(f"üî∏ Celkov√© emisje: {footprint['total']:.2f} kg CO2")
            print(f"üî∏ Scope 1: {footprint['scope1']:.2f} kg CO2")
            print(f"üî∏ Scope 2: {footprint['scope2']:.2f} kg CO2")
            print(f"üî∏ Scope 3: {footprint['scope3']:.2f} kg CO2")
            print(f"üî∏ Uhl√≠kov√° intenzita: {footprint['intensity']:.3f} kg CO2/kWh")
            
            # Souhrnn√© hodnocen√≠
            summary = assessment['assessment_summary']
            print(f"\nüéØ HODNOCEN√ç V√ùKONNOSTI:")
            print(f"üî∏ Celkov√© hodnocen√≠: {summary['performance_rating']}")
            print(f"üî∏ Hlavn√≠ zdroj emis√≠: {summary['main_emission_source']}")
            print(f"üî∏ Potenci√°l zlep≈°en√≠: {summary['improvement_potential']}")
            
            # Doporuƒçen√≠
            recommendations = assessment['improvement_recommendations']
            if 'recommendations' in recommendations:
                print(f"\nüí° DOPORUƒåEN√ç:")
                print(recommendations['recommendations'][:200] + "...")
                
            print(f"\n‚úÖ Hodnocen√≠ dokonƒçeno: {assessment['assessment_date']}")
            
        else:
            print(f"‚ùå Chyba p≈ôi hodnocen√≠: {assessment['error']}")
            
    except Exception as e:
        logger.error(f"Chyba v main funkci: {e}")

if __name__ == "__main__":
    # Nastaven√≠ environment variables (v produkci pou≈æijte .env soubor)
    # os.environ['OPENAI_API_KEY'] = 'your-openai-api-key'
    
    main()
````

### Po≈æadovan√© z√°vislosti

````toml
# Core AI/ML libraries
langchain==0.0.350
openai==1.3.0
chromadb==0.4.18
sentence-transformers==2.2.2

# Data processing
pandas==2.1.3
numpy==1.24.4
scipy==1.11.4

# Visualization
matplotlib==3.8.2
seaborn==0.13.0
plotly==5.17.0

# Utilities
python-dotenv==1.0.0
requests==2.31.0
pydantic==2.5.0

# Optional: Advanced features
faiss-cpu==1.7.4
streamlit==1.28.2
````

### Nastaven√≠ prost≈ôed√≠

````bash
#!/bin/bash

# Vytvo≈ôen√≠ virtu√°ln√≠ho prost≈ôed√≠
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# Instalace z√°vislost√≠
pip install -r requirements.txt

# Vytvo≈ôen√≠ adres√°≈ô≈Ø
mkdir -p data/environmental
mkdir -p results/assessments
mkdir -p chroma_db

echo "Prost≈ôed√≠ √∫spƒõ≈°nƒõ nastaveno!"
echo "Nezapome≈àte nastavit OPENAI_API_KEY v .env souboru"
````

## 5. Shrnut√≠ Projektu

### Kl√≠ƒçov√° Hodnota
N√°stroj pro hodnocen√≠ environment√°ln√≠ch dopad≈Ø s RAG technologi√≠ poskytuje:

- **Automatizovan√© v√Ωpoƒçty**: P≈ôesn√© kalkulace uhl√≠kov√© stopy podle mezin√°rodn√≠ch standard≈Ø
- **Inteligentn√≠ anal√Ωzy**: RAG syst√©m pro kontextu√°ln√≠ hodnocen√≠ a doporuƒçen√≠
- **Regulaƒçn√≠ compliance**: Kontrola souladu s EU Taxonomy, GHG Protocol a ISO 14001
- **Vizualizace dat**: Interaktivn√≠ dashboardy pro lep≈°√≠ komunikaci v√Ωsledk≈Ø
- **Prediktivn√≠ schopnosti**: Odhady budouc√≠ch dopad≈Ø a potenci√°ln√≠ch √∫spor

### Technologick√© V√Ωhody
- **Modul√°rn√≠ architektura**: Snadn√° roz≈°i≈ôitelnost a √∫dr≈æba
- **RAG integrace**: Kombinace faktick√Ωch dat s generativn√≠ AI
- **≈†k√°lovatelnost**: Podpora pro velk√© objemy dat
- **Modern√≠ stack**: Vyu≈æit√≠ nejnovƒõj≈°√≠ch AI/ML knihoven

### Obchodn√≠ P≈ô√≠nosy
- **Sn√≠≈æen√≠ n√°klad≈Ø**: Automatizace manu√°ln√≠ch proces≈Ø hodnocen√≠
- **Compliance podpora**: Zjednodu≈°en√≠ regulaƒçn√≠ch report≈Ø
- **Konkurenƒçn√≠ v√Ωhoda**: Lep≈°√≠ ESG rating a investorsk√° d≈Øvƒõra
- **Rozhodovac√≠ podpora**: Data-driven environment√°ln√≠ strategie

Tento projekt p≈ôedstavuje pokroƒçil√© ≈ôe≈°en√≠ pro modern√≠ environment√°ln√≠ management, kombinuj√≠c√≠ p≈ôesn√© v√Ωpoƒçty s inteligentn√≠mi anal√Ωzami a u≈æivatelsky p≈ô√≠vƒõtivou vizualizac√≠.