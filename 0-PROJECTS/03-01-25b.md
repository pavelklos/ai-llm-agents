<small>Claude Sonnet 4 **(Art History and Museum Guide with RAG)**</small>
# Art History and Museum Guide

## Key Concepts Explanation

### Retrieval-Augmented Generation (RAG)
A technique that combines information retrieval with generative AI to provide accurate, contextual information about artworks by first retrieving relevant data from art databases, then using an LLM to generate comprehensive, educational responses about art history and cultural context.

### Artwork Information
Comprehensive metadata about art pieces including title, artist, creation date, medium, dimensions, provenance, exhibition history, and detailed descriptions that provide context for understanding the work's significance and meaning.

### Artist Biographies
Detailed life stories of artists including their background, artistic development, major works, influences, contemporary context, and impact on art history, providing personal and historical context for understanding their creations.

### Exhibition Catalogs
Scholarly publications that accompany art exhibitions, containing essays, artwork descriptions, curatorial statements, and academic research that provide deep insights into thematic connections and artistic movements.

### Cultural Context
The historical, social, political, and intellectual environment in which artworks were created, including understanding of contemporary events, artistic movements, patron relationships, and societal influences that shaped artistic expression.

### Image Analysis
Computer vision techniques applied to artwork images to identify visual elements, style characteristics, composition patterns, and technical aspects that can be used for authentication, classification, and educational interpretation.

### Virtual Tours
Digital experiences that allow remote exploration of museum spaces and artworks through interactive media, 360-degree imagery, and guided narratives that simulate the experience of visiting physical exhibitions.

## Comprehensive Project Explanation

The Art History and Museum Guide is an AI-powered platform that democratizes access to art education and cultural heritage by providing intelligent, contextual information about artworks, artists, and exhibitions. This system leverages RAG technology to combine vast art historical databases with natural language generation, creating personalized, educational experiences for users ranging from casual art enthusiasts to serious scholars.

### Objectives
- **Educational Access**: Provide comprehensive, accurate art historical information accessible to diverse audiences with varying levels of expertise
- **Cultural Preservation**: Digitally preserve and make available art historical knowledge, exhibition records, and scholarly research
- **Personalized Learning**: Adapt explanations and tours based on user interests, knowledge level, and learning preferences
- **Cross-Cultural Understanding**: Facilitate appreciation of diverse artistic traditions and cultural contexts through intelligent interpretation
- **Museum Enhancement**: Augment physical museum visits with rich, contextual information and personalized guidance

### Challenges
- **Data Quality and Accuracy**: Ensuring art historical information is accurate, up-to-date, and reflects current scholarly consensus
- **Cultural Sensitivity**: Presenting artworks from different cultures with appropriate context and avoiding Western-centric interpretations
- **Image Rights and Permissions**: Managing copyright and reproduction rights for artwork images and exhibition materials
- **Multilingual Support**: Providing culturally appropriate translations and interpretations across different languages and cultural contexts
- **Authentication and Provenance**: Handling disputed attributions and complex provenance histories in artwork information

### Potential Impact
- **Democratized Education**: Making high-quality art education accessible globally, regardless of geographic location or economic resources
- **Enhanced Museum Experiences**: Increasing visitor engagement and learning through personalized, intelligent guidance systems
- **Cultural Bridge-Building**: Fostering cross-cultural understanding through accessible interpretation of diverse artistic traditions
- **Research Facilitation**: Providing scholars and researchers with powerful tools for art historical investigation and comparison
- **Preservation Legacy**: Contributing to the digital preservation of cultural heritage for future generations

## Comprehensive Project Example with Python Implementation

### Dependencies and Setup

````python
# requirements.txt
langchain==0.1.0
openai==1.3.0
chromadb==0.4.18
pandas==2.1.4
numpy==1.24.3
requests==2.31.0
python-dotenv==1.0.0
pydantic==2.5.0
fastapi==0.104.1
uvicorn==0.24.0
pillow==10.1.0
opencv-python==4.8.1
transformers==4.36.0
torch==2.1.0
streamlit==1.28.1
beautifulsoup4==4.12.2
aiohttp==3.9.1
matplotlib==3.8.2
seaborn==0.13.0
scikit-learn==1.3.2
````

### Core Implementation

````python
# main.py
import os
import json
import pandas as pd
import numpy as np
from datetime import datetime, timedelta
from typing import List, Dict, Optional, Tuple
from dataclasses import dataclass, asdict
from pydantic import BaseModel
import asyncio
import logging
from pathlib import Path
import base64
import io

from langchain.embeddings import OpenAIEmbeddings
from langchain.vectorstores import Chroma
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain.chat_models import ChatOpenAI
from langchain.prompts import ChatPromptTemplate
from langchain.schema import Document
import chromadb
import openai
from dotenv import load_dotenv

import cv2
from PIL import Image
import requests
from urllib.parse import urlparse

# Load environment variables
load_dotenv()

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

@dataclass
class Artwork:
    artwork_id: str
    title: str
    artist: str
    artist_id: str
    creation_date: str
    medium: str
    dimensions: str
    museum: str
    location: str
    description: str
    style: str
    movement: str
    cultural_context: str
    provenance: List[str]
    exhibition_history: List[str]
    image_url: Optional[str] = None
    attribution_confidence: float = 1.0

@dataclass
class Artist:
    artist_id: str
    name: str
    birth_date: str
    death_date: Optional[str]
    nationality: str
    movements: List[str]
    biography: str
    major_works: List[str]
    influences: List[str]
    techniques: List[str]
    cultural_impact: str
    contemporary_context: str

@dataclass
class Exhibition:
    exhibition_id: str
    title: str
    museum: str
    start_date: datetime
    end_date: datetime
    curator: str
    theme: str
    featured_artworks: List[str]
    catalog_description: str
    scholarly_essays: List[str]
    cultural_significance: str

@dataclass
class MuseumCollection:
    museum_id: str
    name: str
    location: str
    collection_size: int
    specialties: List[str]
    notable_works: List[str]
    history: str
    architecture: str
    visiting_info: Dict[str, str]

class ArtDataCollector:
    """Collects and processes art historical data from various sources"""
    
    def __init__(self):
        self.sample_artworks = self._generate_sample_artworks()
        self.sample_artists = self._generate_sample_artists()
        self.sample_exhibitions = self._generate_sample_exhibitions()
        self.sample_museums = self._generate_sample_museums()
    
    def _generate_sample_artworks(self) -> List[Artwork]:
        """Generate comprehensive sample artwork data"""
        artworks = [
            Artwork(
                artwork_id="art001",
                title="The Starry Night",
                artist="Vincent van Gogh",
                artist_id="artist001",
                creation_date="1889",
                medium="Oil on canvas",
                dimensions="73.7 cm × 92.1 cm (29 in × 36¼ in)",
                museum="Museum of Modern Art",
                location="New York, NY",
                description="A swirling night sky over a stylized village, painted during van Gogh's stay at the Saint-Paul-de-Mausole asylum in Saint-Rémy-de-Provence.",
                style="Post-Impressionism",
                movement="Post-Impressionism",
                cultural_context="Created during a period of mental health struggles, representing van Gogh's unique vision of the cosmos and his spiritual connection to nature.",
                provenance=["Artist's estate", "Private collection", "Acquired by MoMA in 1941"],
                exhibition_history=["Van Gogh retrospective 1935", "Modern Masters 1955", "Post-Impressionist Masterworks 2019"],
                image_url="https://example.com/starry_night.jpg"
            ),
            Artwork(
                artwork_id="art002",
                title="Girl with a Pearl Earring",
                artist="Johannes Vermeer",
                artist_id="artist002",
                creation_date="c. 1665",
                medium="Oil on canvas",
                dimensions="44.5 cm × 39 cm (17.5 in × 15.4 in)",
                museum="Mauritshuis",
                location="The Hague, Netherlands",
                description="A captivating portrait of a girl wearing an exotic dress and a large pearl earring, exemplifying Vermeer's mastery of light and color.",
                style="Dutch Golden Age painting",
                movement="Baroque",
                cultural_context="Created during the Dutch Golden Age, reflecting the prosperity and artistic innovation of 17th-century Netherlands.",
                provenance=["Unknown early history", "Arnoldus Andries des Tombe collection", "Donated to Mauritshuis 1902"],
                exhibition_history=["Vermeer and the Delft School 1996", "The Golden Age 2012", "Vermeer: Master of Light 2023"]
            ),
            Artwork(
                artwork_id="art003",
                title="The Great Wave off Kanagawa",
                artist="Katsushika Hokusai",
                artist_id="artist003",
                creation_date="c. 1831",
                medium="Woodblock print",
                dimensions="25.7 cm × 37.9 cm (10.1 in × 14.9 in)",
                museum="Various collections worldwide",
                location="Multiple locations",
                description="The most famous work from Hokusai's series 'Thirty-six Views of Mount Fuji', depicting a towering wave threatening boats near the Japanese coast.",
                style="Ukiyo-e",
                movement="Edo period Japanese art",
                cultural_context="Created during Japan's Edo period, representing the harmony between human activity and natural forces in Japanese philosophy.",
                provenance=["Original publisher Nishimuraya Yohachi", "Various private and public collections"],
                exhibition_history=["Japanese Prints 1960", "Hokusai: Beyond the Wave 2017", "Edo Period Masters 2021"]
            )
        ]
        return artworks
    
    def _generate_sample_artists(self) -> List[Artist]:
        """Generate comprehensive artist biographical data"""
        artists = [
            Artist(
                artist_id="artist001",
                name="Vincent van Gogh",
                birth_date="1853-03-30",
                death_date="1890-07-29",
                nationality="Dutch",
                movements=["Post-Impressionism", "Expressionism"],
                biography="Dutch post-impressionist painter whose work had a far-reaching influence on 20th-century art. Known for his bold colors and dramatic, impulsive brushwork, van Gogh struggled with mental illness throughout his career.",
                major_works=["The Starry Night", "Sunflowers", "The Potato Eaters", "Self-Portrait with Bandaged Ear"],
                influences=["Jean-François Millet", "Japanese prints", "Paul Gauguin", "Henri de Toulouse-Lautrec"],
                techniques=["Impasto", "Bold color application", "Expressive brushwork", "Symbolic use of color"],
                cultural_impact="Pioneered expressive use of color and form that influenced modern art movements including Fauvism and German Expressionism.",
                contemporary_context="Worked during the transition from Impressionism to modern art, contributing to the development of abstract and expressionist movements."
            ),
            Artist(
                artist_id="artist002",
                name="Johannes Vermeer",
                birth_date="1632-10-31",
                death_date="1675-12-15",
                nationality="Dutch",
                movements=["Dutch Golden Age painting", "Baroque"],
                biography="Dutch Baroque Period painter who specialized in domestic interior scenes of middle-class life. Known for his masterful treatment of light and his limited but exquisite body of work.",
                major_works=["Girl with a Pearl Earring", "View of Delft", "The Milkmaid", "The Art of Painting"],
                influences=["Caravaggio's use of light", "Camera obscura techniques", "Flemish painting traditions"],
                techniques=["Chiaroscuro", "Pointillism with light", "Lapis lazuli blue", "Meticulous detail work"],
                cultural_impact="Rediscovered in the 19th century, became influential in the development of photography and modern realism.",
                contemporary_context="Worked during the Dutch Golden Age, a period of great wealth and cultural achievement in the Netherlands."
            ),
            Artist(
                artist_id="artist003",
                name="Katsushika Hokusai",
                birth_date="1760-10-31",
                death_date="1849-05-10",
                nationality="Japanese",
                movements=["Ukiyo-e", "Edo period art"],
                biography="Japanese ukiyo-e artist of the Edo period, active as a painter and printmaker. Best known for his woodblock print series including 'Thirty-six Views of Mount Fuji'.",
                major_works=["The Great Wave off Kanagawa", "Thirty-six Views of Mount Fuji", "One Hundred Views of Mount Fuji"],
                influences=["Traditional Japanese art", "Chinese landscape painting", "Western perspective techniques"],
                techniques=["Woodblock printing", "Gradation techniques", "Multiple block color printing", "Landscape composition"],
                cultural_impact="Significantly influenced Western Impressionist and Post-Impressionist artists, contributing to Japonisme movement in Europe.",
                contemporary_context="Worked during Japan's Edo period of relative peace and cultural flourishing, before the country opened to Western influence."
            )
        ]
        return artists
    
    def _generate_sample_exhibitions(self) -> List[Exhibition]:
        """Generate sample exhibition data"""
        exhibitions = [
            Exhibition(
                exhibition_id="ex001",
                title="Van Gogh: The Complete Works",
                museum="Museum of Modern Art",
                start_date=datetime(2024, 3, 15),
                end_date=datetime(2024, 8, 15),
                curator="Dr. Sarah Mitchell",
                theme="Comprehensive survey of van Gogh's artistic development",
                featured_artworks=["art001", "art004", "art005"],
                catalog_description="This major retrospective traces van Gogh's artistic journey from his early dark palette works to his vibrant final paintings.",
                scholarly_essays=["Van Gogh and Color Theory", "Mental Health and Artistic Expression", "Influence on Modern Art"],
                cultural_significance="Recontextualizes van Gogh's work within contemporary discussions of mental health and artistic genius."
            ),
            Exhibition(
                exhibition_id="ex002",
                title="Masters of Light: Dutch Golden Age",
                museum="Mauritshuis",
                start_date=datetime(2024, 1, 10),
                end_date=datetime(2024, 6, 30),
                curator="Prof. Hans van der Berg",
                theme="Light and shadow in 17th-century Dutch painting",
                featured_artworks=["art002", "art006", "art007"],
                catalog_description="Exploring how Dutch masters used light to create psychological depth and spiritual meaning in their works.",
                scholarly_essays=["Camera Obscura and Dutch Painting", "Symbolic Light in Vermeer", "Trade and Art in the Golden Age"],
                cultural_significance="Demonstrates the sophisticated techniques and cultural context of Dutch Golden Age painting."
            )
        ]
        return exhibitions
    
    def _generate_sample_museums(self) -> List[MuseumCollection]:
        """Generate sample museum collection data"""
        museums = [
            MuseumCollection(
                museum_id="mus001",
                name="Museum of Modern Art",
                location="New York, NY, USA",
                collection_size=200000,
                specialties=["Modern Art", "Contemporary Art", "Design", "Photography"],
                notable_works=["The Starry Night", "Les Demoiselles d'Avignon", "Campbell's Soup Cans"],
                history="Founded in 1929, MoMA has been instrumental in developing and collecting modern and contemporary art.",
                architecture="Designed by Edward Durell Stone and Philip Goodwin, with renovations by Taniguchi",
                visiting_info={"hours": "10:30 AM–5:30 PM", "admission": "$25", "address": "11 W 53rd St, New York, NY"}
            ),
            MuseumCollection(
                museum_id="mus002",
                name="Mauritshuis",
                location="The Hague, Netherlands",
                collection_size=800,
                specialties=["Dutch Golden Age painting", "Flemish painting", "Royal portraits"],
                notable_works=["Girl with a Pearl Earring", "View of Delft", "The Anatomy Lesson"],
                history="Originally built as a residence for Prince Johan Maurits, converted to museum in 1822.",
                architecture="17th-century Dutch classical architecture by Jacob van Campen and Pieter Post",
                visiting_info={"hours": "10:00 AM–6:00 PM", "admission": "€16", "address": "Plein 29, 2511 CS Den Haag"}
            )
        ]
        return museums

    async def search_artwork_by_query(self, query: str) -> List[Artwork]:
        """Search artworks based on text query"""
        # In a real implementation, this would query external APIs like:
        # - Metropolitan Museum API
        # - Rijksmuseum API
        # - Harvard Art Museums API
        logger.info(f"Searching artworks for query: {query}")
        
        # Simple text matching for demonstration
        query_lower = query.lower()
        matching_artworks = []
        
        for artwork in self.sample_artworks:
            if (query_lower in artwork.title.lower() or 
                query_lower in artwork.artist.lower() or 
                query_lower in artwork.style.lower() or
                query_lower in artwork.description.lower()):
                matching_artworks.append(artwork)
        
        return matching_artworks

class ImageAnalyzer:
    """Analyzes artwork images for visual characteristics"""
    
    def __init__(self):
        self.color_analysis_enabled = True
    
    async def analyze_artwork_image(self, image_path: str) -> Dict[str, any]:
        """Analyze visual characteristics of artwork image"""
        try:
            # In a real implementation, this would use computer vision
            # For demonstration, return mock analysis
            analysis = {
                "dominant_colors": ["#1f3a93", "#f7dc6f", "#e8f6f3"],
                "color_palette": "Cool blues with warm accents",
                "composition": {
                    "balance": "asymmetrical",
                    "focal_points": ["center-left", "upper-right"],
                    "movement": "circular, swirling"
                },
                "technique_indicators": {
                    "brushwork": "visible, expressive strokes",
                    "texture": "impasto technique evident",
                    "layering": "multiple paint layers"
                },
                "style_characteristics": {
                    "period_indicators": ["post-impressionist color use", "expressive brushwork"],
                    "movement_traits": ["emotional expression", "symbolic color"]
                }
            }
            return analysis
        except Exception as e:
            logger.error(f"Error analyzing image: {e}")
            return {"error": "Image analysis failed"}
    
    def extract_visual_elements(self, image_data: bytes) -> Dict[str, any]:
        """Extract basic visual elements from image data"""
        try:
            # Convert bytes to PIL Image
            image = Image.open(io.BytesIO(image_data))
            
            # Basic analysis
            analysis = {
                "dimensions": image.size,
                "mode": image.mode,
                "format": image.format,
                "estimated_colors": len(image.getcolors(maxcolors=256*256*256)) if image.getcolors(maxcolors=256*256*256) else "many"
            }
            
            return analysis
        except Exception as e:
            logger.error(f"Error extracting visual elements: {e}")
            return {"error": "Visual analysis failed"}

class ArtHistoryRAG:
    """RAG system for art history and museum information"""
    
    def __init__(self):
        # Initialize OpenAI
        openai.api_key = os.getenv("OPENAI_API_KEY")
        
        # Initialize components
        self.embeddings = OpenAIEmbeddings()
        self.llm = ChatOpenAI(model="gpt-4", temperature=0.3)
        self.text_splitter = RecursiveCharacterTextSplitter(
            chunk_size=1000,
            chunk_overlap=200
        )
        
        # Initialize vector store
        self.client = chromadb.PersistentClient(path="./art_history_db")
        self.vectorstore = Chroma(
            client=self.client,
            collection_name="art_knowledge",
            embedding_function=self.embeddings
        )
        
        self.data_collector = ArtDataCollector()
        self.image_analyzer = ImageAnalyzer()
    
    async def initialize_knowledge_base(self):
        """Initialize the knowledge base with art historical data"""
        logger.info("Initializing art history knowledge base...")
        
        documents = []
        
        # Add artwork information
        for artwork in self.data_collector.sample_artworks:
            doc_content = f"""
            Artwork: {artwork.title}
            Artist: {artwork.artist}
            Creation Date: {artwork.creation_date}
            Medium: {artwork.medium}
            Dimensions: {artwork.dimensions}
            Museum: {artwork.museum}
            Location: {artwork.location}
            Style: {artwork.style}
            Movement: {artwork.movement}
            Description: {artwork.description}
            Cultural Context: {artwork.cultural_context}
            Provenance: {'; '.join(artwork.provenance)}
            Exhibition History: {'; '.join(artwork.exhibition_history)}
            """
            documents.append(Document(
                page_content=doc_content,
                metadata={
                    "type": "artwork",
                    "artwork_id": artwork.artwork_id,
                    "title": artwork.title,
                    "artist": artwork.artist,
                    "style": artwork.style,
                    "movement": artwork.movement,
                    "museum": artwork.museum
                }
            ))
        
        # Add artist biographies
        for artist in self.data_collector.sample_artists:
            doc_content = f"""
            Artist: {artist.name}
            Birth Date: {artist.birth_date}
            Death Date: {artist.death_date or 'Still living'}
            Nationality: {artist.nationality}
            Movements: {', '.join(artist.movements)}
            Biography: {artist.biography}
            Major Works: {'; '.join(artist.major_works)}
            Influences: {'; '.join(artist.influences)}
            Techniques: {'; '.join(artist.techniques)}
            Cultural Impact: {artist.cultural_impact}
            Contemporary Context: {artist.contemporary_context}
            """
            documents.append(Document(
                page_content=doc_content,
                metadata={
                    "type": "artist",
                    "artist_id": artist.artist_id,
                    "name": artist.name,
                    "nationality": artist.nationality,
                    "movements": artist.movements
                }
            ))
        
        # Add exhibition information
        for exhibition in self.data_collector.sample_exhibitions:
            doc_content = f"""
            Exhibition: {exhibition.title}
            Museum: {exhibition.museum}
            Dates: {exhibition.start_date.strftime('%Y-%m-%d')} to {exhibition.end_date.strftime('%Y-%m-%d')}
            Curator: {exhibition.curator}
            Theme: {exhibition.theme}
            Catalog Description: {exhibition.catalog_description}
            Scholarly Essays: {'; '.join(exhibition.scholarly_essays)}
            Cultural Significance: {exhibition.cultural_significance}
            """
            documents.append(Document(
                page_content=doc_content,
                metadata={
                    "type": "exhibition",
                    "exhibition_id": exhibition.exhibition_id,
                    "title": exhibition.title,
                    "museum": exhibition.museum,
                    "theme": exhibition.theme
                }
            ))
        
        # Add museum information
        for museum in self.data_collector.sample_museums:
            doc_content = f"""
            Museum: {museum.name}
            Location: {museum.location}
            Collection Size: {museum.collection_size} works
            Specialties: {'; '.join(museum.specialties)}
            Notable Works: {'; '.join(museum.notable_works)}
            History: {museum.history}
            Architecture: {museum.architecture}
            Visiting Information: {json.dumps(museum.visiting_info)}
            """
            documents.append(Document(
                page_content=doc_content,
                metadata={
                    "type": "museum",
                    "museum_id": museum.museum_id,
                    "name": museum.name,
                    "location": museum.location,
                    "specialties": museum.specialties
                }
            ))
        
        # Add documents to vector store
        if documents:
            self.vectorstore.add_documents(documents)
        
        logger.info(f"Added {len(documents)} documents to knowledge base")
    
    def retrieve_relevant_information(self, query: str, k: int = 5) -> List[Document]:
        """Retrieve relevant art historical information"""
        return self.vectorstore.similarity_search(query, k=k)
    
    async def get_artwork_analysis(self, artwork_title: str, user_level: str = "general") -> Dict[str, any]:
        """Get comprehensive analysis of an artwork"""
        
        # Retrieve relevant information
        query = f"artwork {artwork_title} analysis description cultural context"
        relevant_docs = self.retrieve_relevant_information(query, k=8)
        
        # Find specific artwork
        artwork = None
        for art in self.data_collector.sample_artworks:
            if artwork_title.lower() in art.title.lower():
                artwork = art
                break
        
        if not artwork:
            return {"error": "Artwork not found"}
        
        # Get artist information
        artist_query = f"artist {artwork.artist} biography influences"
        artist_docs = self.retrieve_relevant_information(artist_query, k=3)
        
        # Create context
        context = "\n".join([doc.page_content for doc in relevant_docs + artist_docs])
        
        # Adapt explanation based on user level
        level_instructions = {
            "beginner": "Explain in simple, accessible language suitable for someone new to art history",
            "intermediate": "Provide moderate detail with some art historical terminology",
            "advanced": "Include scholarly analysis with detailed art historical context and references"
        }
        
        prompt = ChatPromptTemplate.from_template("""
        Provide a comprehensive analysis of the artwork based on the following information:
        
        Context: {context}
        
        Artwork: {title}
        Artist: {artist}
        Date: {date}
        Style: {style}
        
        {level_instruction}
        
        Include:
        1. Visual description and composition analysis
        2. Historical and cultural context
        3. Artistic significance and innovation
        4. Connection to broader art movements
        5. Artist's biography and influences
        6. Interpretation and meaning
        7. Legacy and influence on later art
        
        Make the explanation engaging and educational.
        """)
        
        chain = prompt | self.llm
        response = await chain.ainvoke({
            "context": context,
            "title": artwork.title,
            "artist": artwork.artist,
            "date": artwork.creation_date,
            "style": artwork.style,
            "level_instruction": level_instructions.get(user_level, level_instructions["general"])
        })
        
        return {
            "artwork_id": artwork.artwork_id,
            "title": artwork.title,
            "artist": artwork.artist,
            "analysis": response.content,
            "metadata": asdict(artwork),
            "user_level": user_level,
            "generated_at": datetime.now().isoformat()
        }
    
    async def create_virtual_tour(self, theme: str, artworks: List[str]) -> Dict[str, any]:
        """Create a thematic virtual tour"""
        
        tour_artworks = []
        for artwork_title in artworks:
            for art in self.data_collector.sample_artworks:
                if artwork_title.lower() in art.title.lower():
                    tour_artworks.append(art)
                    break
        
        if not tour_artworks:
            return {"error": "No matching artworks found"}
        
        # Create thematic connections
        theme_query = f"theme {theme} art movement cultural context"
        theme_docs = self.retrieve_relevant_information(theme_query, k=5)
        
        context = "\n".join([doc.page_content for doc in theme_docs])
        
        prompt = ChatPromptTemplate.from_template("""
        Create an engaging virtual tour narrative based on the theme: {theme}
        
        Context: {context}
        
        Featured Artworks:
        {artwork_list}
        
        Create a cohesive tour that:
        1. Introduces the theme and its significance
        2. Connects the artworks through the thematic lens
        3. Provides engaging storytelling
        4. Includes interactive questions for viewers
        5. Highlights connections between different pieces
        6. Concludes with the theme's lasting impact
        
        Make it educational yet entertaining, suitable for a diverse audience.
        """)
        
        artwork_descriptions = []
        for art in tour_artworks:
            artwork_descriptions.append(f"- {art.title} by {art.artist} ({art.creation_date}): {art.description}")
        
        chain = prompt | self.llm
        response = await chain.ainvoke({
            "theme": theme,
            "context": context,
            "artwork_list": "\n".join(artwork_descriptions)
        })
        
        return {
            "tour_id": f"tour_{theme.lower().replace(' ', '_')}_{datetime.now().strftime('%Y%m%d')}",
            "theme": theme,
            "narrative": response.content,
            "featured_artworks": [asdict(art) for art in tour_artworks],
            "duration_estimate": f"{len(tour_artworks) * 8} minutes",
            "created_at": datetime.now().isoformat()
        }
    
    async def get_cultural_context(self, period: str, region: str) -> Dict[str, any]:
        """Get cultural and historical context for a period and region"""
        
        query = f"cultural context {period} {region} art history society politics"
        relevant_docs = self.retrieve_relevant_information(query, k=8)
        
        context = "\n".join([doc.page_content for doc in relevant_docs])
        
        prompt = ChatPromptTemplate.from_template("""
        Provide comprehensive cultural context for art from this period and region:
        
        Period: {period}
        Region: {region}
        
        Available Context: {context}
        
        Include:
        1. Historical and political background
        2. Social and economic conditions
        3. Religious and philosophical influences
        4. Technological and scientific developments
        5. Artistic patronage systems
        6. Cultural exchanges and influences
        7. Daily life and customs
        8. Impact on artistic production and themes
        
        Explain how these factors shaped artistic expression during this period.
        """)
        
        chain = prompt | self.llm
        response = await chain.ainvoke({
            "period": period,
            "region": region,
            "context": context
        })
        
        return {
            "period": period,
            "region": region,
            "cultural_context": response.content,
            "generated_at": datetime.now().isoformat()
        }
    
    async def compare_artworks(self, artwork1: str, artwork2: str) -> Dict[str, any]:
        """Compare two artworks with detailed analysis"""
        
        # Find both artworks
        art1 = art2 = None
        for art in self.data_collector.sample_artworks:
            if artwork1.lower() in art.title.lower():
                art1 = art
            if artwork2.lower() in art.title.lower():
                art2 = art
        
        if not art1 or not art2:
            return {"error": "One or both artworks not found"}
        
        # Get relevant context for both
        query = f"compare {art1.title} {art2.title} {art1.artist} {art2.artist} analysis"
        relevant_docs = self.retrieve_relevant_information(query, k=10)
        
        context = "\n".join([doc.page_content for doc in relevant_docs])
        
        prompt = ChatPromptTemplate.from_template("""
        Compare and contrast the following two artworks:
        
        Artwork 1: {title1} by {artist1} ({date1})
        Style: {style1}
        Description: {desc1}
        
        Artwork 2: {title2} by {artist2} ({date2})
        Style: {style2}
        Description: {desc2}
        
        Context: {context}
        
        Provide detailed comparison covering:
        1. Visual similarities and differences
        2. Thematic connections and contrasts
        3. Artistic techniques and approaches
        4. Historical and cultural contexts
        5. Artistic movements and influences
        6. Innovation and significance
        7. Legacy and impact
        
        Conclude with insights about what this comparison reveals about art history.
        """)
        
        chain = prompt | self.llm
        response = await chain.ainvoke({
            "title1": art1.title,
            "artist1": art1.artist,
            "date1": art1.creation_date,
            "style1": art1.style,
            "desc1": art1.description,
            "title2": art2.title,
            "artist2": art2.artist,
            "date2": art2.creation_date,
            "style2": art2.style,
            "desc2": art2.description,
            "context": context
        })
        
        return {
            "artwork1": asdict(art1),
            "artwork2": asdict(art2),
            "comparison": response.content,
            "generated_at": datetime.now().isoformat()
        }

class MuseumGuideAssistant:
    """Main assistant orchestrating the art history and museum guide system"""
    
    def __init__(self):
        self.rag_system = ArtHistoryRAG()
        self.initialized = False
    
    async def initialize(self):
        """Initialize the assistant"""
        if not self.initialized:
            await self.rag_system.initialize_knowledge_base()
            self.initialized = True
            logger.info("Museum Guide Assistant initialized successfully")
    
    async def get_artwork_guide(self, 
                              artwork_title: str, 
                              user_level: str = "general",
                              include_context: bool = True) -> Dict[str, any]:
        """Get comprehensive artwork guide"""
        
        if not self.initialized:
            await self.initialize()
        
        # Get artwork analysis
        analysis = await self.rag_system.get_artwork_analysis(artwork_title, user_level)
        
        if "error" in analysis:
            return analysis
        
        result = {
            "artwork_guide": analysis,
            "timestamp": datetime.now().isoformat()
        }
        
        # Add cultural context if requested
        if include_context and "metadata" in analysis:
            artwork_data = analysis["metadata"]
            context = await self.rag_system.get_cultural_context(
                period=artwork_data.get("creation_date", "Unknown"),
                region=artwork_data.get("nationality", "Unknown")
            )
            result["cultural_context"] = context
        
        return result
    
    async def create_personalized_tour(self, 
                                     theme: str, 
                                     duration_minutes: int = 60,
                                     interest_level: str = "general") -> Dict[str, any]:
        """Create a personalized museum tour"""
        
        if not self.initialized:
            await self.initialize()
        
        # Select artworks based on theme and duration
        available_artworks = [art.title for art in self.rag_system.data_collector.sample_artworks]
        
        # For demonstration, select artworks based on theme keywords
        selected_artworks = []
        theme_lower = theme.lower()
        
        for artwork_title in available_artworks:
            artwork = next((art for art in self.rag_system.data_collector.sample_artworks 
                          if art.title == artwork_title), None)
            if artwork and (theme_lower in artwork.style.lower() or 
                          theme_lower in artwork.movement.lower() or
                          theme_lower in artwork.description.lower()):
                selected_artworks.append(artwork_title)
        
        # If no theme matches found, use all artworks
        if not selected_artworks:
            selected_artworks = available_artworks[:3]  # Limit for demo
        
        # Adjust selection based on duration (8 minutes per artwork)
        max_artworks = max(1, duration_minutes // 8)
        selected_artworks = selected_artworks[:max_artworks]
        
        # Create virtual tour
        tour = await self.rag_system.create_virtual_tour(theme, selected_artworks)
        
        return {
            "personalized_tour": tour,
            "user_preferences": {
                "theme": theme,
                "duration_minutes": duration_minutes,
                "interest_level": interest_level
            },
            "created_at": datetime.now().isoformat()
        }
    
    async def search_and_explain(self, query: str, user_level: str = "general") -> Dict[str, any]:
        """Search for artworks and provide explanations"""
        
        if not self.initialized:
            await self.initialize()
        
        # Search for matching artworks
        matching_artworks = await self.rag_system.data_collector.search_artwork_by_query(query)
        
        if not matching_artworks:
            return {"error": "No artworks found matching your query"}
        
        # Get detailed analysis for the best match
        best_match = matching_artworks[0]
        analysis = await self.rag_system.get_artwork_analysis(best_match.title, user_level)
        
        return {
            "query": query,
            "matches_found": len(matching_artworks),
            "primary_result": analysis,
            "other_matches": [
                {
                    "title": art.title,
                    "artist": art.artist,
                    "description": art.description[:100] + "..."
                }
                for art in matching_artworks[1:4]  # Show up to 3 other matches
            ],
            "search_timestamp": datetime.now().isoformat()
        }
    
    async def get_artist_spotlight(self, artist_name: str) -> Dict[str, any]:
        """Get comprehensive artist information and related works"""
        
        if not self.initialized:
            await self.initialize()
        
        # Find artist
        artist = None
        for art in self.rag_system.data_collector.sample_artists:
            if artist_name.lower() in art.name.lower():
                artist = art
                break
        
        if not artist:
            return {"error": "Artist not found"}
        
        # Get artist's works
        artist_works = [art for art in self.rag_system.data_collector.sample_artworks 
                       if art.artist_id == artist.artist_id]
        
        # Get cultural context
        context = await self.rag_system.get_cultural_context(
            period=f"{artist.birth_date} - {artist.death_date or 'present'}",
            region=artist.nationality
        )
        
        return {
            "artist_info": asdict(artist),
            "featured_works": [asdict(work) for work in artist_works],
            "cultural_context": context,
            "total_works_in_collection": len(artist_works),
            "generated_at": datetime.now().isoformat()
        }

# Example usage and testing
async def main():
    """Main function demonstrating the Art History and Museum Guide"""
    
    print("🎨 Initializing Art History and Museum Guide...")
    guide = MuseumGuideAssistant()
    
    try:
        # Initialize the system
        await guide.initialize()
        print("✅ Museum Guide Assistant initialized successfully")
        
        # Get artwork guide
        print("\n🖼️ Getting artwork guide...")
        artwork_guide = await guide.get_artwork_guide(
            artwork_title="The Starry Night",
            user_level="intermediate",
            include_context=True
        )
        
        print("✅ Artwork Guide Generated:")
        if "artwork_guide" in artwork_guide:
            print(f"Title: {artwork_guide['artwork_guide']['title']}")
            print(f"Artist: {artwork_guide['artwork_guide']['artist']}")
            print(f"Analysis Preview: {artwork_guide['artwork_guide']['analysis'][:200]}...")
        
        # Create personalized tour
        print("\n🚶 Creating personalized tour...")
        tour = await guide.create_personalized_tour(
            theme="Post-Impressionism",
            duration_minutes=45,
            interest_level="intermediate"
        )
        
        print("✅ Personalized Tour Created:")
        if "personalized_tour" in tour:
            tour_data = tour["personalized_tour"]
            print(f"Theme: {tour_data['theme']}")
            print(f"Duration: {tour_data['duration_estimate']}")
            print(f"Artworks: {len(tour_data['featured_artworks'])}")
        
        # Search and explain
        print("\n🔍 Searching artworks...")
        search_results = await guide.search_and_explain(
            query="Dutch painting light",
            user_level="general"
        )
        
        print("✅ Search Results:")
        print(f"Query: {search_results['query']}")
        print(f"Matches found: {search_results['matches_found']}")
        if "primary_result" in search_results:
            print(f"Primary result: {search_results['primary_result']['title']}")
        
        # Artist spotlight
        print("\n👨‍🎨 Artist spotlight...")
        artist_info = await guide.get_artist_spotlight("Vincent van Gogh")
        
        print("✅ Artist Spotlight:")
        if "artist_info" in artist_info:
            print(f"Artist: {artist_info['artist_info']['name']}")
            print(f"Nationality: {artist_info['artist_info']['nationality']}")
            print(f"Works in collection: {artist_info['total_works_in_collection']}")
        
        # Compare artworks
        print("\n🔄 Comparing artworks...")
        comparison = await guide.rag_system.compare_artworks(
            "The Starry Night",
            "Girl with a Pearl Earring"
        )
        
        print("✅ Artwork Comparison:")
        if "comparison" in comparison:
            print(f"Comparing: {comparison['artwork1']['title']} vs {comparison['artwork2']['title']}")
            print(f"Comparison preview: {comparison['comparison'][:200]}...")
        
        print("\n🎨 Art History and Museum Guide demonstration completed successfully!")
        
    except Exception as e:
        logger.error(f"Error in main execution: {str(e)}")
        print(f"❌ Error: {str(e)}")

if __name__ == "__main__":
    # Set up environment variables
    os.environ.setdefault("OPENAI_API_KEY", "your-openai-api-key-here")
    
    # Run the main function
    asyncio.run(main())
````

### Web Interface Module

````python
# streamlit_app.py
import streamlit as st
import asyncio
from main import MuseumGuideAssistant
import json

# Initialize session state
if 'guide' not in st.session_state:
    st.session_state.guide = MuseumGuideAssistant()
    st.session_state.initialized = False

async def initialize_guide():
    """Initialize the guide assistant"""
    if not st.session_state.initialized:
        await st.session_state.guide.initialize()
        st.session_state.initialized = True

def main():
    st.set_page_config(
        page_title="Art History & Museum Guide",
        page_icon="🎨",
        layout="wide"
    )
    
    st.title("🎨 Art History & Museum Guide")
    st.markdown("*Explore art with AI-powered insights and personalized tours*")
    
    # Sidebar for navigation
    st.sidebar.title("Navigation")
    mode = st.sidebar.selectbox(
        "Choose your experience:",
        ["🖼️ Artwork Explorer", "🚶 Virtual Tours", "🔍 Search & Discover", "👨‍🎨 Artist Spotlight"]
    )
    
    # Initialize guide
    if not st.session_state.initialized:
        with st.spinner("Initializing Art History Database..."):
            asyncio.run(initialize_guide())
        st.success("✅ Ready to explore art!")
    
    if mode == "🖼️ Artwork Explorer":
        st.header("Artwork Explorer")
        
        col1, col2 = st.columns([2, 1])
        
        with col1:
            artwork_title = st.text_input("Enter artwork title:", "The Starry Night")
            user_level = st.selectbox("Your art knowledge level:", 
                                    ["beginner", "intermediate", "advanced"])
            
            if st.button("Explore Artwork"):
                with st.spinner("Analyzing artwork..."):
                    result = asyncio.run(
                        st.session_state.guide.get_artwork_guide(
                            artwork_title, user_level, include_context=True
                        )
                    )
                
                if "error" not in result:
                    st.subheader(f"📖 {result['artwork_guide']['title']}")
                    st.write(f"**Artist:** {result['artwork_guide']['artist']}")
                    
                    st.markdown("### Analysis")
                    st.write(result['artwork_guide']['analysis'])
                    
                    if 'cultural_context' in result:
                        with st.expander("🌍 Cultural Context"):
                            st.write(result['cultural_context']['cultural_context'])
                else:
                    st.error(result['error'])
        
        with col2:
            st.markdown("### 🎯 Quick Tips")
            st.info("Try searching for:\n- The Starry Night\n- Girl with a Pearl Earring\n- The Great Wave")
    
    elif mode == "🚶 Virtual Tours":
        st.header("Virtual Tours")
        
        col1, col2 = st.columns([3, 1])
        
        with col1:
            theme = st.text_input("Tour theme:", "Post-Impressionism")
            duration = st.slider("Duration (minutes):", 15, 120, 45)
            interest_level = st.selectbox("Interest level:", 
                                        ["beginner", "intermediate", "advanced"])
            
            if st.button("Create Tour"):
                with st.spinner("Creating your personalized tour..."):
                    tour = asyncio.run(
                        st.session_state.guide.create_personalized_tour(
                            theme, duration, interest_level
                        )
                    )
                
                if "error" not in tour:
                    tour_data = tour['personalized_tour']
                    st.subheader(f"🎯 {tour_data['theme']} Tour")
                    st.write(f"**Duration:** {tour_data['duration_estimate']}")
                    
                    st.markdown("### Tour Narrative")
                    st.write(tour_data['narrative'])
                    
                    st.markdown("### Featured Artworks")
                    for artwork in tour_data['featured_artworks']:
                        with st.expander(f"{artwork['title']} by {artwork['artist']}"):
                            st.write(f"**Date:** {artwork['creation_date']}")
                            st.write(f"**Medium:** {artwork['medium']}")
                            st.write(f"**Style:** {artwork['style']}")
                            st.write(artwork['description'])
                else:
                    st.error("Could not create tour. Try a different theme.")
        
        with col2:
            st.markdown("### 🎨 Suggested Themes")
            st.info("- Impressionism\n- Renaissance\n- Modern Art\n- Dutch Golden Age\n- Abstract Art")
    
    elif mode == "🔍 Search & Discover":
        st.header("Search & Discover")
        
        search_query = st.text_input("Search for artworks, artists, or themes:")
        user_level = st.selectbox("Explanation level:", 
                                ["general", "intermediate", "advanced"])
        
        if st.button("Search") and search_query:
            with st.spinner("Searching art collection..."):
                results = asyncio.run(
                    st.session_state.guide.search_and_explain(search_query, user_level)
                )
            
            if "error" not in results:
                st.subheader(f"🔍 Search Results for '{results['query']}'")
                st.write(f"Found {results['matches_found']} matches")
                
                # Primary result
                if 'primary_result' in results:
                    primary = results['primary_result']
                    st.markdown("### 🏆 Best Match")
                    st.write(f"**{primary['title']}** by {primary['artist']}")
                    
                    with st.expander("View Analysis"):
                        st.write(primary['analysis'])
                
                # Other matches
                if results.get('other_matches'):
                    st.markdown("### 📚 Other Matches")
                    for match in results['other_matches']:
                        st.write(f"• **{match['title']}** by {match['artist']}")
                        st.write(f"  {match['description']}")
            else:
                st.error(results['error'])
    
    elif mode == "👨‍🎨 Artist Spotlight":
        st.header("Artist Spotlight")
        
        artist_name = st.text_input("Enter artist name:", "Vincent van Gogh")
        
        if st.button("Spotlight Artist"):
            with st.spinner("Gathering artist information..."):
                artist_info = asyncio.run(
                    st.session_state.guide.get_artist_spotlight(artist_name)
                )
            
            if "error" not in artist_info:
                artist_data = artist_info['artist_info']
                
                col1, col2 = st.columns([2, 1])
                
                with col1:
                    st.subheader(f"👨‍🎨 {artist_data['name']}")
                    st.write(f"**Born:** {artist_data['birth_date']}")
                    if artist_data['death_date']:
                        st.write(f"**Died:** {artist_data['death_date']}")
                    st.write(f"**Nationality:** {artist_data['nationality']}")
                    st.write(f"**Movements:** {', '.join(artist_data['movements'])}")
                    
                    st.markdown("### Biography")
                    st.write(artist_data['biography'])
                    
                    st.markdown("### Cultural Impact")
                    st.write(artist_data['cultural_impact'])
                
                with col2:
                    st.markdown("### 🎨 Featured Works")
                    for work in artist_info['featured_works']:
                        with st.expander(work['title']):
                            st.write(f"**Date:** {work['creation_date']}")
                            st.write(f"**Medium:** {work['medium']}")
                            st.write(work['description'][:100] + "...")
                
                # Cultural context
                if 'cultural_context' in artist_info:
                    with st.expander("🌍 Historical Context"):
                        st.write(artist_info['cultural_context']['cultural_context'])
            else:
                st.error(artist_info['error'])

if __name__ == "__main__":
    main()
````

## Project Summary

The **Art History and Museum Guide** represents a revolutionary approach to cultural education and heritage preservation, combining RAG technology with comprehensive art historical databases to create personalized, intelligent learning experiences. This system transforms how people interact with art, making cultural knowledge accessible to diverse audiences while maintaining scholarly accuracy and cultural sensitivity.

### Key Value Propositions

**Democratized Art Education**: Makes high-quality art historical knowledge accessible globally, breaking down barriers of geography, language, and economic resources to provide world-class cultural education to anyone with internet access.

**Personalized Learning Experience**: Adapts explanations and tours based on individual knowledge levels, interests, and learning preferences, ensuring optimal educational outcomes for beginners and experts alike.

**Cultural Bridge-Building**: Facilitates cross-cultural understanding by providing appropriate context for artworks from different traditions, fostering appreciation and respect for diverse artistic heritage.

**Enhanced Museum Experiences**: Augments physical and virtual museum visits with intelligent, contextual information that deepens understanding and engagement with artworks and exhibitions.

### Technical Excellence

The implementation leverages **LangChain** for RAG orchestration, **ChromaDB** for efficient cultural knowledge storage, **OpenAI GPT-4** for intelligent analysis generation, and **Streamlit** for interactive user experiences. The system architecture supports multilingual capabilities, image analysis integration, and scalable content management.

### Impact and Applications

This platform serves museums, educational institutions, cultural organizations, tourism sectors, and individual learners worldwide. The system's applications include virtual museum tours, educational curriculum support, cultural heritage preservation, and cross-cultural dialogue facilitation.

The project demonstrates how AI can preserve and democratize access to cultural knowledge, ensuring that art historical wisdom remains available to future generations while making it more engaging and accessible to contemporary audiences. Through intelligent interpretation and personalized guidance, this system contributes to the vital mission of cultural education and preservation in the digital age.