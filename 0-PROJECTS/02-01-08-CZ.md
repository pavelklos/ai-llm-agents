<small>Claude Sonnet 4 **(AI-LLM Multi-Agent Systém pro Analýzu Realitního Trhu a Doporučovací Engine)**</small>
# Real Estate Market Analysis and Recommendation Engine

## 1. Název Projektu

**Inteligentní Multi-Agent Systém pro Komplexní Analýzu Realitního Trhu**

## 2. Vysvětlení Klíčových Konceptů

### Property Valuation (Ocenění Nemovitostí)
Automatizované hodnocení tržní hodnoty nemovitostí na základě lokace, velikosti, stavu, tržních trendů a srovnatelných prodejů. Využívá regresní modely a data z realitního trhu.

### Market Trend Analysis (Analýza Tržních Trendů)
Sledování a predikce vývoje cen nemovitostí v čase. Zahrnuje analýzu historických dat, ekonomických indikátorů a externích faktorů ovlivňujících trh.

### Investment Advisory (Investiční Poradenství)
Poskytování personalizovaných doporučení pro investice do nemovitostí na základě rizikového profilu klienta, rozpočtu a investičních cílů.

### Neighborhood Assessment (Hodnocení Lokalit)
Komplexní analýza kvality a atraktivity konkrétních čtvrtí včetně infrastruktury, bezpečnosti, dostupnosti služeb a budoucího potenciálu.

### Client Matching (Párování Klientů)
Inteligentní spojování kupujících s vhodnými nemovitostmi nebo prodávajících s potenciálními kupci na základě preferencí a požadavků.

## 3. Komplexní Vysvětlení Projektu

### Cíle Projektu
Vytvoření sofistikovaného AI systému, který revolucionizuje realitní trh prostřednictvím:
- Automatického oceňování nemovitostí s vysokou přesností
- Prediktivní analýzy tržních trendů
- Personalizovaného investičního poradenství
- Inteligentního párování klientů s nemovitostmi

### Výzvy
- **Komplexita dat**: Integrace heterogenních datových zdrojů (ceny, lokace, demografie)
- **Tržní volatilita**: Zachycení rychlých změn na realitním trhu
- **Regionální specifika**: Přizpůsobení místním tržním podmínkám
- **Přesnost ocenění**: Minimalizace chyb v hodnocení nemovitostí

### Potenciální Dopad
- Demokratizace přístupu k profesionálním realitním analýzám
- Zvýšení transparentnosti realitního trhu
- Optimalizace investičních rozhodnutí
- Snížení transakčních nákladů a času

## 4. Komplexní Implementace v Pythonu

### Instalace Závislostí

````bash
pip install langchain openai pandas numpy scikit-learn plotly streamlit chromadb python-dotenv requests beautifulsoup4 folium geopy
````

### Hlavní Implementace

````python
import os
import pandas as pd
import numpy as np
from typing import Dict, List, Optional, Tuple
from dataclasses import dataclass
from datetime import datetime, timedelta
import json

from langchain.agents import AgentExecutor, create_openai_tools_agent
from langchain.tools import Tool
from langchain_openai import ChatOpenAI
from langchain.prompts import ChatPromptTemplate
from langchain.memory import ConversationBufferMemory
from langchain.schema import HumanMessage, SystemMessage

from sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import mean_absolute_error, r2_score

import chromadb
from chromadb.config import Settings
import plotly.graph_objects as go
import plotly.express as px

@dataclass
class Property:
    """Datová struktura pro nemovitost"""
    id: str
    address: str
    price: float
    size: int  # m²
    rooms: int
    year_built: int
    property_type: str
    neighborhood: str
    lat: float
    lon: float
    features: List[str]

@dataclass
class Client:
    """Datová struktura pro klienta"""
    id: str
    name: str
    budget_min: float
    budget_max: float
    preferred_areas: List[str]
    property_type: str
    min_rooms: int
    investment_type: str  # "buy_to_live", "investment", "flip"
    risk_tolerance: str  # "low", "medium", "high"

class PropertyDataGenerator:
    """Generátor testovacích dat pro nemovitosti"""
    
    def __init__(self):
        self.neighborhoods = [
            "Vinohrady", "Karlín", "Smíchov", "Vršovice", "Nové Město",
            "Holešovice", "Dejvice", "Břevnov", "Anděl", "Wenceslas Square"
        ]
        
        self.property_types = ["apartment", "house", "studio", "penthouse"]
        
    def generate_properties(self, count: int = 1000) -> List[Property]:
        """Generuje testovací data nemovitostí"""
        properties = []
        
        for i in range(count):
            neighborhood = np.random.choice(self.neighborhoods)
            property_type = np.random.choice(self.property_types)
            
            # Simulace cen podle lokality a typu
            base_price = self._get_base_price(neighborhood, property_type)
            size = np.random.randint(30, 200)
            rooms = max(1, size // 25)
            year_built = np.random.randint(1950, 2024)
            
            # Cenová kalkulace
            price = base_price * size * self._get_year_multiplier(year_built)
            price += np.random.normal(0, price * 0.1)  # Variabilita
            
            property_obj = Property(
                id=f"prop_{i:05d}",
                address=f"{neighborhood} {i+1}",
                price=max(price, 1000000),  # Min 1M CZK
                size=size,
                rooms=rooms,
                year_built=year_built,
                property_type=property_type,
                neighborhood=neighborhood,
                lat=50.0755 + np.random.normal(0, 0.05),
                lon=14.4378 + np.random.normal(0, 0.05),
                features=self._generate_features()
            )
            properties.append(property_obj)
            
        return properties
    
    def _get_base_price(self, neighborhood: str, property_type: str) -> float:
        """Základní cena podle lokality a typu"""
        neighborhood_multipliers = {
            "Vinohrady": 120000, "Karlín": 110000, "Smíchov": 95000,
            "Vršovice": 85000, "Nové Město": 115000, "Holešovice": 90000,
            "Dejvice": 105000, "Břevnov": 80000, "Anděl": 100000,
            "Wenceslas Square": 130000
        }
        
        type_multipliers = {
            "apartment": 1.0, "house": 1.2, "studio": 0.8, "penthouse": 1.5
        }
        
        return neighborhood_multipliers.get(neighborhood, 90000) * type_multipliers.get(property_type, 1.0)
    
    def _get_year_multiplier(self, year: int) -> float:
        """Multiplikátor podle roku výstavby"""
        if year >= 2010:
            return 1.2
        elif year >= 2000:
            return 1.1
        elif year >= 1990:
            return 1.0
        else:
            return 0.9
    
    def _generate_features(self) -> List[str]:
        """Generuje náhodné vlastnosti nemovitosti"""
        all_features = [
            "parking", "balcony", "terrace", "garden", "elevator",
            "air_conditioning", "fireplace", "swimming_pool", "gym",
            "security", "storage", "furnished"
        ]
        return np.random.choice(all_features, size=np.random.randint(1, 6), replace=False).tolist()

class PropertyValuationAgent:
    """Agent pro oceňování nemovitostí"""
    
    def __init__(self, llm: ChatOpenAI, properties: List[Property]):
        self.llm = llm
        self.properties = properties
        self.scaler = StandardScaler()
        self.model = None
        self._train_model()
        
    def _train_model(self):
        """Trénování modelu pro oceňování"""
        if not self.properties:
            return
            
        # Příprava dat
        features = []
        prices = []
        
        for prop in self.properties:
            feature_vector = [
                prop.size,
                prop.rooms,
                2024 - prop.year_built,  # věk
                len(prop.features),
                hash(prop.neighborhood) % 1000,  # kódování lokality
                hash(prop.property_type) % 100   # kódování typu
            ]
            features.append(feature_vector)
            prices.append(prop.price)
        
        X = np.array(features)
        y = np.array(prices)
        
        # Normalizace a trénování
        X_scaled = self.scaler.fit_transform(X)
        X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2, random_state=42)
        
        self.model = GradientBoostingRegressor(n_estimators=100, random_state=42)
        self.model.fit(X_train, y_train)
        
        # Evaluace
        y_pred = self.model.predict(X_test)
        mae = mean_absolute_error(y_test, y_pred)
        r2 = r2_score(y_test, y_pred)
        
        print(f"Model trénován - MAE: {mae:,.0f} CZK, R²: {r2:.3f}")
    
    def valuate_property(self, property_details: Dict) -> Dict:
        """Oceňuje nemovitost"""
        try:
            if not self.model:
                return {"error": "Model není natrénován"}
            
            # Příprava features
            feature_vector = np.array([[
                property_details.get('size', 70),
                property_details.get('rooms', 2),
                2024 - property_details.get('year_built', 2000),
                len(property_details.get('features', [])),
                hash(property_details.get('neighborhood', 'Unknown')) % 1000,
                hash(property_details.get('property_type', 'apartment')) % 100
            ]])
            
            feature_vector_scaled = self.scaler.transform(feature_vector)
            predicted_price = self.model.predict(feature_vector_scaled)[0]
            
            # Získání dodatečné analýzy od LLM
            prompt = f"""
            Analyzuj oceňování nemovitosti s následujícími parametry:
            - Velikost: {property_details.get('size')} m²
            - Pokoje: {property_details.get('rooms')}
            - Rok výstavby: {property_details.get('year_built')}
            - Lokalita: {property_details.get('neighborhood')}
            - Typ: {property_details.get('property_type')}
            - Vlastnosti: {property_details.get('features', [])}
            
            Predikovaná cena: {predicted_price:,.0f} CZK
            
            Poskytni analýzu faktorů ovlivňujících cenu a doporučení.
            """
            
            response = self.llm.invoke([HumanMessage(content=prompt)])
            
            return {
                "predicted_price": predicted_price,
                "price_per_sqm": predicted_price / property_details.get('size', 1),
                "analysis": response.content,
                "confidence": "vysoká" if self.model else "nízká"
            }
            
        except Exception as e:
            return {"error": f"Chyba při oceňování: {str(e)}"}

class MarketTrendAgent:
    """Agent pro analýzu tržních trendů"""
    
    def __init__(self, llm: ChatOpenAI, properties: List[Property]):
        self.llm = llm
        self.properties = properties
        
    def analyze_trends(self, neighborhood: Optional[str] = None) -> Dict:
        """Analyzuje tržní trendy"""
        try:
            # Simulace historických dat
            trends_data = self._generate_trend_data(neighborhood)
            
            prompt = f"""
            Analyzuj tržní trendy na základě následujících dat:
            
            Lokalita: {neighborhood or 'Celá Praha'}
            Průměrná cena za m²: {trends_data['avg_price_per_sqm']:,.0f} CZK
            Růst YoY: {trends_data['yoy_growth']:.1f}%
            Počet transakcí: {trends_data['transaction_count']}
            Průměrná doba prodeje: {trends_data['avg_days_on_market']} dnů
            
            Poskytni komprehensivní analýzu trendů a predikci vývoje.
            """
            
            response = self.llm.invoke([HumanMessage(content=prompt)])
            
            return {
                "trend_data": trends_data,
                "analysis": response.content,
                "prediction": self._generate_prediction(trends_data)
            }
            
        except Exception as e:
            return {"error": f"Chyba při analýze trendů: {str(e)}"}
    
    def _generate_trend_data(self, neighborhood: str = None) -> Dict:
        """Generuje trendová data"""
        filtered_props = self.properties
        if neighborhood:
            filtered_props = [p for p in self.properties if p.neighborhood == neighborhood]
        
        if not filtered_props:
            return {"error": "Žádná data pro lokalitu"}
        
        prices_per_sqm = [p.price / p.size for p in filtered_props]
        
        return {
            "avg_price_per_sqm": np.mean(prices_per_sqm),
            "median_price_per_sqm": np.median(prices_per_sqm),
            "yoy_growth": np.random.normal(5, 3),  # Simulace růstu
            "transaction_count": len(filtered_props),
            "avg_days_on_market": np.random.randint(30, 90),
            "price_range": (min(prices_per_sqm), max(prices_per_sqm))
        }
    
    def _generate_prediction(self, trends_data: Dict) -> Dict:
        """Generuje predikci vývoje"""
        current_growth = trends_data.get('yoy_growth', 0)
        
        return {
            "short_term_outlook": "pozitivní" if current_growth > 3 else "stabilní",
            "predicted_growth_6m": max(-5, min(15, current_growth + np.random.normal(0, 2))),
            "predicted_growth_1y": max(-10, min(20, current_growth + np.random.normal(0, 4))),
            "risk_factors": ["úrokové sazby", "ekonomická situace", "regulace"]
        }

class InvestmentAdvisoryAgent:
    """Agent pro investiční poradenství"""
    
    def __init__(self, llm: ChatOpenAI, properties: List[Property]):
        self.llm = llm
        self.properties = properties
        
    def get_investment_advice(self, client: Client, target_properties: List[Property] = None) -> Dict:
        """Poskytuje investiční poradenství"""
        try:
            if not target_properties:
                target_properties = self._find_suitable_properties(client)
            
            # Analýza investičních příležitostí
            analysis = self._analyze_investment_opportunities(client, target_properties)
            
            prompt = f"""
            Poskytni investiční poradenství pro klienta s profilem:
            - Rozpočet: {client.budget_min:,.0f} - {client.budget_max:,.0f} CZK
            - Typ investice: {client.investment_type}
            - Riziková tolerance: {client.risk_tolerance}
            - Preferované lokality: {client.preferred_areas}
            
            Analýza nalezených příležitostí:
            {json.dumps(analysis, indent=2, ensure_ascii=False)}
            
            Poskytni personalizované doporučení a strategii.
            """
            
            response = self.llm.invoke([HumanMessage(content=prompt)])
            
            return {
                "suitable_properties": target_properties[:5],  # Top 5
                "investment_analysis": analysis,
                "recommendations": response.content,
                "risk_assessment": self._assess_risk(client, target_properties)
            }
            
        except Exception as e:
            return {"error": f"Chyba při poskytování poradenství: {str(e)}"}
    
    def _find_suitable_properties(self, client: Client) -> List[Property]:
        """Najde vhodné nemovitosti pro klienta"""
        suitable = []
        
        for prop in self.properties:
            if (client.budget_min <= prop.price <= client.budget_max and
                prop.rooms >= client.min_rooms and
                (not client.preferred_areas or prop.neighborhood in client.preferred_areas) and
                prop.property_type == client.property_type):
                suitable.append(prop)
        
        # Seřazení podle ROI potenciálu
        return sorted(suitable, key=lambda p: self._calculate_roi_score(p), reverse=True)
    
    def _calculate_roi_score(self, property: Property) -> float:
        """Kalkuluje ROI skóre nemovitosti"""
        # Zjednodušená kalkulace ROI
        base_score = 100
        
        # Bonus za nové nemovitosti
        if property.year_built >= 2010:
            base_score += 20
        
        # Bonus za lokality s potenciálem
        high_potential_areas = ["Karlín", "Holešovice", "Smíchov"]
        if property.neighborhood in high_potential_areas:
            base_score += 30
        
        # Bonus za vlastnosti
        premium_features = ["parking", "balcony", "elevator"]
        feature_bonus = sum(10 for f in premium_features if f in property.features)
        
        return base_score + feature_bonus + np.random.normal(0, 10)
    
    def _analyze_investment_opportunities(self, client: Client, properties: List[Property]) -> Dict:
        """Analyzuje investiční příležitosti"""
        if not properties:
            return {"message": "Žádné vhodné nemovitosti nenalezeny"}
        
        analysis = {
            "total_opportunities": len(properties),
            "avg_price": np.mean([p.price for p in properties]),
            "price_range": (min(p.price for p in properties), max(p.price for p in properties)),
            "neighborhoods": list(set(p.neighborhood for p in properties)),
            "avg_roi_score": np.mean([self._calculate_roi_score(p) for p in properties])
        }
        
        return analysis
    
    def _assess_risk(self, client: Client, properties: List[Property]) -> Dict:
        """Hodnotí riziko investice"""
        risk_level = "nízké"
        
        if client.risk_tolerance == "high":
            risk_level = "vysoké"
        elif client.risk_tolerance == "medium":
            risk_level = "střední"
        
        return {
            "overall_risk": risk_level,
            "market_risk": "střední",
            "liquidity_risk": "nízké",
            "diversification_score": min(10, len(set(p.neighborhood for p in properties))),
            "recommendations": [
                "Zvažte diverzifikaci portfolia",
                "Sledujte tržní trendy",
                "Konzultujte s finančním poradcem"
            ]
        }

class NeighborhoodAssessmentAgent:
    """Agent pro hodnocení lokalit"""
    
    def __init__(self, llm: ChatOpenAI):
        self.llm = llm
        
    def assess_neighborhood(self, neighborhood: str) -> Dict:
        """Hodnotí kvalitu lokality"""
        try:
            # Simulace dat o lokalitě
            assessment_data = self._generate_assessment_data(neighborhood)
            
            prompt = f"""
            Proveď komplexní hodnocení lokality {neighborhood} na základě dat:
            
            Skóre infrastruktury: {assessment_data['infrastructure_score']}/10
            Bezpečnostní skóre: {assessment_data['safety_score']}/10
            Dopravní dostupnost: {assessment_data['transport_score']}/10
            Školy a vzdělání: {assessment_data['education_score']}/10
            Obchody a služby: {assessment_data['services_score']}/10
            Zelené plochy: {assessment_data['green_spaces_score']}/10
            Kulturní vyžití: {assessment_data['culture_score']}/10
            
            Poskytni podrobné hodnocení a doporučení pro různé typy obyvatel.
            """
            
            response = self.llm.invoke([HumanMessage(content=prompt)])
            
            return {
                "neighborhood": neighborhood,
                "assessment_data": assessment_data,
                "overall_score": np.mean(list(assessment_data.values())),
                "detailed_analysis": response.content,
                "suitable_for": self._determine_suitability(assessment_data)
            }
            
        except Exception as e:
            return {"error": f"Chyba při hodnocení lokality: {str(e)}"}
    
    def _generate_assessment_data(self, neighborhood: str) -> Dict:
        """Generuje data pro hodnocení lokality"""
        # Simulace skóre pro různé aspekty
        base_scores = {
            "Vinohrady": {"infrastructure": 9, "safety": 8, "transport": 9},
            "Karlín": {"infrastructure": 8, "safety": 7, "transport": 8},
            "Smíchov": {"infrastructure": 7, "safety": 6, "transport": 9},
            "Vršovice": {"infrastructure": 6, "safety": 7, "transport": 7},
        }
        
        base = base_scores.get(neighborhood, {"infrastructure": 6, "safety": 6, "transport": 6})
        
        return {
            "infrastructure_score": base["infrastructure"] + np.random.randint(-1, 2),
            "safety_score": base["safety"] + np.random.randint(-1, 2),
            "transport_score": base["transport"] + np.random.randint(-1, 2),
            "education_score": np.random.randint(5, 10),
            "services_score": np.random.randint(5, 10),
            "green_spaces_score": np.random.randint(4, 9),
            "culture_score": np.random.randint(4, 10)
        }
    
    def _determine_suitability(self, data: Dict) -> List[str]:
        """Určuje vhodnost lokality pro různé typy obyvatel"""
        suitable_for = []
        
        if data["education_score"] >= 8:
            suitable_for.append("rodiny s dětmi")
        
        if data["culture_score"] >= 7:
            suitable_for.append("mladé profesionály")
        
        if data["safety_score"] >= 8:
            suitable_for.append("seniory")
        
        if data["transport_score"] >= 8:
            suitable_for.append("dojíždějící")
        
        return suitable_for if suitable_for else ["obecné bydlení"]

class ClientMatchingAgent:
    """Agent pro párování klientů"""
    
    def __init__(self, llm: ChatOpenAI, properties: List[Property]):
        self.llm = llm
        self.properties = properties
        self.vector_db = self._setup_vector_db()
        
    def _setup_vector_db(self):
        """Nastavuje vektorovou databázi"""
        try:
            client = chromadb.Client()
            collection = client.create_collection(name="properties")
            return collection
        except:
            return None
    
    def match_client_to_properties(self, client: Client) -> Dict:
        """Páruje klienta s vhodnými nemovitostmi"""
        try:
            # Nalezení vhodných nemovitostí
            matches = self._find_matches(client)
            
            # Skórování shody
            scored_matches = [(prop, self._calculate_match_score(client, prop)) for prop in matches]
            scored_matches.sort(key=lambda x: x[1], reverse=True)
            
            # LLM analýza
            prompt = f"""
            Analyzuj párování klienta s nemovitostmi:
            
            Profil klienta:
            - Rozpočet: {client.budget_min:,.0f} - {client.budget_max:,.0f} CZK
            - Preferované oblasti: {client.preferred_areas}
            - Typ nemovitosti: {client.property_type}
            - Minimálně pokojů: {client.min_rooms}
            
            Nejlepší shody (top 3):
            {self._format_matches(scored_matches[:3])}
            
            Poskytni analýzu a doporučení pro klienta.
            """
            
            response = self.llm.invoke([HumanMessage(content=prompt)])
            
            return {
                "total_matches": len(matches),
                "top_matches": [match[0] for match in scored_matches[:10]],
                "match_scores": [match[1] for match in scored_matches[:10]],
                "analysis": response.content,
                "recommendations": self._generate_recommendations(client, scored_matches)
            }
            
        except Exception as e:
            return {"error": f"Chyba při párování: {str(e)}"}
    
    def _find_matches(self, client: Client) -> List[Property]:
        """Najde potenciální shody"""
        matches = []
        
        for prop in self.properties:
            # Základní filtry
            if (client.budget_min <= prop.price <= client.budget_max and
                prop.rooms >= client.min_rooms and
                prop.property_type == client.property_type):
                
                # Kontrola preferovaných oblastí
                if not client.preferred_areas or prop.neighborhood in client.preferred_areas:
                    matches.append(prop)
        
        return matches
    
    def _calculate_match_score(self, client: Client, property: Property) -> float:
        """Kalkuluje skóre shody"""
        score = 0
        
        # Cenové skóre (čím blíže k ideálu, tím lépe)
        price_ideal = (client.budget_min + client.budget_max) / 2
        price_diff = abs(property.price - price_ideal) / price_ideal
        price_score = max(0, 100 - price_diff * 100)
        score += price_score * 0.4
        
        # Lokalita
        if property.neighborhood in client.preferred_areas:
            score += 30
        
        # Počet pokojů
        room_bonus = min(20, (property.rooms - client.min_rooms) * 5)
        score += room_bonus
        
        # Typ investice
        if client.investment_type == "investment":
            # Bonus za nové nemovitosti pro investory
            if property.year_built >= 2010:
                score += 15
        
        # Náhodná variabilita
        score += np.random.normal(0, 5)
        
        return max(0, min(100, score))
    
    def _format_matches(self, matches: List[Tuple[Property, float]]) -> str:
        """Formátuje shody pro LLM"""
        formatted = []
        for prop, score in matches:
            formatted.append(
                f"- {prop.address}: {prop.price:,.0f} CZK, "
                f"{prop.size}m², {prop.rooms} pokojů, "
                f"skóre shody: {score:.1f}/100"
            )
        return "\n".join(formatted)
    
    def _generate_recommendations(self, client: Client, matches: List[Tuple[Property, float]]) -> List[str]:
        """Generuje doporučení"""
        recommendations = []
        
        if not matches:
            recommendations.append("Zvažte rozšíření kritérií vyhledávání")
            return recommendations
        
        avg_score = np.mean([score for _, score in matches[:10]])
        
        if avg_score < 60:
            recommendations.append("Navrhujeme úpravu požadavků pro lepší výsledky")
        
        if client.investment_type == "investment":
            recommendations.append("Zaměřte se na lokality s růstovým potenciálem")
        
        recommendations.append("Doporučujeme osobní prohlídku top kandidátů")
        
        return recommendations

class RealEstateMultiAgentSystem:
    """Hlavní koordinátor multi-agent systému"""
    
    def __init__(self, openai_api_key: str):
        self.llm = ChatOpenAI(
            model="gpt-4",
            temperature=0.1,
            openai_api_key=openai_api_key
        )
        
        # Generace testovacích dat
        self.data_generator = PropertyDataGenerator()
        self.properties = self.data_generator.generate_properties(1000)
        
        # Inicializace agentů
        self.valuation_agent = PropertyValuationAgent(self.llm, self.properties)
        self.trend_agent = MarketTrendAgent(self.llm, self.properties)
        self.advisory_agent = InvestmentAdvisoryAgent(self.llm, self.properties)
        self.neighborhood_agent = NeighborhoodAssessmentAgent(self.llm)
        self.matching_agent = ClientMatchingAgent(self.llm, self.properties)
        
        print(f"Multi-Agent systém inicializován s {len(self.properties)} nemovitostmi")
    
    def comprehensive_analysis(self, property_details: Dict, client: Client = None) -> Dict:
        """Komprehensivní analýza nemovitosti a trhu"""
        results = {}
        
        try:
            # 1. Ocenění nemovitosti
            print("Provádím ocenění nemovitosti...")
            results['valuation'] = self.valuation_agent.valuate_property(property_details)
            
            # 2. Analýza trendů
            print("Analyzuji tržní trendy...")
            neighborhood = property_details.get('neighborhood')
            results['trends'] = self.trend_agent.analyze_trends(neighborhood)
            
            # 3. Hodnocení lokality
            print("Hodnotím lokalitu...")
            if neighborhood:
                results['neighborhood'] = self.neighborhood_agent.assess_neighborhood(neighborhood)
            
            # 4. Investiční poradenství (pokud je klient)
            if client:
                print("Poskytuju investiční poradenství...")
                results['investment_advice'] = self.advisory_agent.get_investment_advice(client)
                
                print("Hledám podobné nemovitosti...")
                results['matching'] = self.matching_agent.match_client_to_properties(client)
            
            # 5. Souhrnné doporučení
            results['summary'] = self._generate_summary(results)
            
            return results
            
        except Exception as e:
            return {"error": f"Chyba při analýze: {str(e)}"}
    
    def _generate_summary(self, results: Dict) -> Dict:
        """Generuje souhrnné doporučení"""
        summary_prompt = f"""
        Na základě kompletní analýzy poskytni souhrnné doporučení:
        
        Ocenění: {results.get('valuation', {}).get('predicted_price', 'N/A')}
        Tržní trendy: {results.get('trends', {}).get('trend_data', {})}
        Hodnocení lokality: {results.get('neighborhood', {}).get('overall_score', 'N/A')}
        
        Poskytni stručné, ale komplexní shrnutí a hlavní doporučení.
        """
        
        try:
            response = self.llm.invoke([HumanMessage(content=summary_prompt)])
            return {
                "recommendation": response.content,
                "confidence_level": "vysoká",
                "key_factors": ["cena", "lokalita", "tržní trendy", "investiční potenciál"]
            }
        except:
            return {"recommendation": "Analýza dokončena", "confidence_level": "střední"}

def demo_system():
    """Demonstrace systému"""
    # Nastavení API klíče (v produkci použijte environment variable)
    api_key = os.getenv("OPENAI_API_KEY", "your-api-key-here")
    
    if api_key == "your-api-key-here":
        print("⚠️  Nastavte OPENAI_API_KEY pro plnou funkcionalnost")
        return
    
    # Inicializace systému
    print("🚀 Inicializuji Real Estate Multi-Agent systém...")
    system = RealEstateMultiAgentSystem(api_key)
    
    # Testovací nemovitost
    test_property = {
        "size": 85,
        "rooms": 3,
        "year_built": 2015,
        "neighborhood": "Vinohrady",
        "property_type": "apartment",
        "features": ["parking", "balcony", "elevator"]
    }
    
    # Testovací klient
    test_client = Client(
        id="client_001",
        name="Jan Novák",
        budget_min=4000000,
        budget_max=6000000,
        preferred_areas=["Vinohrady", "Karlín"],
        property_type="apartment",
        min_rooms=2,
        investment_type="buy_to_live",
        risk_tolerance="medium"
    )
    
    print("\n🏠 Provádím komprehensivní analýzu...")
    
    # Spuštění analýzy
    analysis = system.comprehensive_analysis(test_property, test_client)
    
    # Výpis výsledků
    print("\n📊 VÝSLEDKY ANALÝZY")
    print("=" * 50)
    
    if "valuation" in analysis:
        val = analysis["valuation"]
        print(f"\n💰 OCENĚNÍ NEMOVITOSTI:")
        print(f"Predikovaná cena: {val.get('predicted_price', 0):,.0f} CZK")
        print(f"Cena za m²: {val.get('price_per_sqm', 0):,.0f} CZK/m²")
    
    if "trends" in analysis and "trend_data" in analysis["trends"]:
        trends = analysis["trends"]["trend_data"]
        print(f"\n📈 TRŽNÍ TRENDY:")
        print(f"Průměrná cena za m²: {trends.get('avg_price_per_sqm', 0):,.0f} CZK")
        print(f"Růst YoY: {trends.get('yoy_growth', 0):.1f}%")
    
    if "neighborhood" in analysis:
        neighborhood = analysis["neighborhood"]
        print(f"\n🏘️  HODNOCENÍ LOKALITY:")
        print(f"Celkové skóre: {neighborhood.get('overall_score', 0):.1f}/10")
    
    if "matching" in analysis:
        matching = analysis["matching"]
        print(f"\n🎯 PÁROVÁNÍ KLIENTA:")
        print(f"Nalezeno {matching.get('total_matches', 0)} vhodných nemovitostí")
        
        top_matches = matching.get('top_matches', [])
        if top_matches:
            print("Top 3 doporučení:")
            for i, prop in enumerate(top_matches[:3], 1):
                print(f"  {i}. {prop.address} - {prop.price:,.0f} CZK")
    
    print(f"\n✅ Analýza dokončena úspěšně!")

if __name__ == "__main__":
    demo_system()
````

### Streamlit Webové Rozhraní

````python
import streamlit as st
import plotly.express as px
import plotly.graph_objects as go
from real_estate_agents import RealEstateMultiAgentSystem, Client
import os

st.set_page_config(
    page_title="AI Real Estate Analyzer",
    page_icon="🏠",
    layout="wide"
)

def main():
    st.title("🏠 AI Multi-Agent Realitní Analyzátor")
    st.markdown("Komplexní analýza nemovitostí pomocí umělé inteligence")
    
    # Sidebar pro nastavení
    with st.sidebar:
        st.header("⚙️ Nastavení")
        
        # API klíč
        api_key = st.text_input("OpenAI API Key", type="password")
        
        if not api_key:
            st.warning("Zadejte OpenAI API klíč pro plnou funkcionalnost")
            return
    
    # Inicializace systému
    if 'system' not in st.session_state:
        with st.spinner("Inicializuji AI systém..."):
            st.session_state.system = RealEstateMultiAgentSystem(api_key)
    
    # Hlavní rozhraní
    tab1, tab2, tab3 = st.tabs(["🏠 Analýza Nemovitosti", "👤 Profil Klienta", "📊 Dashboard"])
    
    with tab1:
        st.header("Analýza Nemovitosti")
        
        col1, col2 = st.columns(2)
        
        with col1:
            st.subheader("Parametry nemovitosti")
            size = st.number_input("Velikost (m²)", min_value=20, max_value=500, value=85)
            rooms = st.number_input("Počet pokojů", min_value=1, max_value=10, value=3)
            year_built = st.number_input("Rok výstavby", min_value=1900, max_value=2024, value=2015)
            
        with col2:
            neighborhood = st.selectbox("Lokalita", [
                "Vinohrady", "Karlín", "Smíchov", "Vršovice", "Nové Město",
                "Holešovice", "Dejvice", "Břevnov", "Anděl", "Wenceslas Square"
            ])
            property_type = st.selectbox("Typ nemovitosti", 
                ["apartment", "house", "studio", "penthouse"])
            features = st.multiselect("Vlastnosti", [
                "parking", "balcony", "terrace", "garden", "elevator",
                "air_conditioning", "fireplace", "swimming_pool"
            ])
        
        if st.button("🔍 Analyzovat Nemovitost", type="primary"):
            property_details = {
                "size": size,
                "rooms": rooms,
                "year_built": year_built,
                "neighborhood": neighborhood,
                "property_type": property_type,
                "features": features
            }
            
            with st.spinner("Provádím analýzu..."):
                results = st.session_state.system.comprehensive_analysis(property_details)
            
            # Zobrazení výsledků
            if "valuation" in results:
                st.success("✅ Analýza dokončena!")
                
                val = results["valuation"]
                col1, col2, col3 = st.columns(3)
                
                with col1:
                    st.metric("Predikovaná cena", f"{val.get('predicted_price', 0):,.0f} CZK")
                
                with col2:
                    st.metric("Cena za m²", f"{val.get('price_per_sqm', 0):,.0f} CZK/m²")
                
                with col3:
                    st.metric("Spolehlivost", val.get('confidence', 'N/A'))
    
    with tab2:
        st.header("Profil Klienta")
        
        col1, col2 = st.columns(2)
        
        with col1:
            client_name = st.text_input("Jméno klienta", "Jan Novák")
            budget_min = st.number_input("Min. rozpočet (CZK)", min_value=1000000, value=4000000, step=100000)
            budget_max = st.number_input("Max. rozpočet (CZK)", min_value=budget_min, value=6000000, step=100000)
            
        with col2:
            preferred_areas = st.multiselect("Preferované lokality", [
                "Vinohrady", "Karlín", "Smíchov", "Vršovice", "Nové Město",
                "Holešovice", "Dejvice", "Břevnov", "Anděl", "Wenceslas Square"
            ], default=["Vinohrady", "Karlín"])
            
            investment_type = st.selectbox("Typ koupě", 
                ["buy_to_live", "investment", "flip"])
            risk_tolerance = st.selectbox("Riziková tolerance", 
                ["low", "medium", "high"])
        
        if st.button("🎯 Najít Vhodné Nemovitosti", type="primary"):
            client = Client(
                id="web_client",
                name=client_name,
                budget_min=budget_min,
                budget_max=budget_max,
                preferred_areas=preferred_areas,
                property_type="apartment",
                min_rooms=2,
                investment_type=investment_type,
                risk_tolerance=risk_tolerance
            )
            
            with st.spinner("Hledám vhodné nemovitosti..."):
                matching = st.session_state.system.matching_agent.match_client_to_properties(client)
            
            if "top_matches" in matching:
                st.success(f"✅ Nalezeno {matching['total_matches']} vhodných nemovitostí")
                
                # Zobrazení top doporučení
                for i, prop in enumerate(matching['top_matches'][:5], 1):
                    with st.expander(f"#{i} {prop.address} - {prop.price:,.0f} CZK"):
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.write(f"**Velikost:** {prop.size} m²")
                            st.write(f"**Pokoje:** {prop.rooms}")
                        with col2:
                            st.write(f"**Rok:** {prop.year_built}")
                            st.write(f"**Typ:** {prop.property_type}")
                        with col3:
                            st.write(f"**Lokalita:** {prop.neighborhood}")
                            st.write(f"**Vlastnosti:** {', '.join(prop.features[:3])}")
    
    with tab3:
        st.header("📊 Tržní Dashboard")
        
        # Grafy a statistiky
        properties = st.session_state.system.properties
        
        col1, col2 = st.columns(2)
        
        with col1:
            # Graf cen podle lokalit
            neighborhood_prices = {}
            for prop in properties:
                if prop.neighborhood not in neighborhood_prices:
                    neighborhood_prices[prop.neighborhood] = []
                neighborhood_prices[prop.neighborhood].append(prop.price / prop.size)
            
            avg_prices = {k: sum(v)/len(v) for k, v in neighborhood_prices.items()}
            
            fig = px.bar(
                x=list(avg_prices.keys()),
                y=list(avg_prices.values()),
                title="Průměrná cena za m² podle lokalit"
            )
            st.plotly_chart(fig, use_container_width=True)
        
        with col2:
            # Graf distribuce cen
            prices = [prop.price for prop in properties]
            fig = px.histogram(x=prices, title="Distribuce cen nemovitostí", nbins=50)
            st.plotly_chart(fig, use_container_width=True)

if __name__ == "__main__":
    main()
````

## 5. Shrnutí Projektu

### Klíčové Výhody

**Technologická Inovace**
- Využití pokročilých LLM modelů pro analýzu trhu
- Multi-agent architektura pro specializované úlohy
- Integrace ML algoritmů pro predikci cen

**Obchodní Hodnota**
- Automatizace složitých realitních analýz
- Personalizované investiční poradenství
- Zvýšení efektivity realitních transakcí
- Demokratizace přístupu k profesionálním analýzám

**Technické Vlastnosti**
- Škálovatelná architektura s modulárními agenty
- Robustní error handling a validace dat
- Moderní technologický stack (LangChain, Streamlit, scikit-learn)
- Připravenost pro produkční nasazení

### Budoucí Rozšíření
- Integrace s reálnými realitními API
- Pokročilé geolokační analýzy
- Integrace s finančními službami
- Mobilní aplikace pro klienty
- Blockchain integrace pro transparentní transakce

Tento systém představuje komplexní řešení pro moderní realitní trh, kombinující sílu umělé inteligence s praktickými potřebami realitních profesionálů a investorů.