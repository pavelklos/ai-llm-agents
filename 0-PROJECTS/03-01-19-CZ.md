<small>Claude Sonnet 4 **(SystÃ©m pro pÃ©Äi o zvÃ­Å™ata a veterinÃ¡rnÃ­ informace s RAG)**</small>
# Pet Care and Veterinary Information System

## KlÃ­ÄovÃ© koncepty projektu

### Retrieval-Augmented Generation (RAG)
ArchitektonickÃ½ vzor kombinujÃ­cÃ­ vyhledÃ¡vÃ¡nÃ­ relevantnÃ­ch informacÃ­ z databÃ¡ze znalostÃ­ s generativnÃ­mi schopnostmi velkÃ½ch jazykovÃ½ch modelÅ¯. UmoÅ¾Åˆuje poskytovat aktuÃ¡lnÃ­ a pÅ™esnÃ© odpovÄ›di na zÃ¡kladÄ› specifickÃ½ch dat.

### ZdravotnÃ­ zÃ¡znamy zvÃ­Å™at
DigitÃ¡lnÃ­ dokumentace zdravotnÃ­ho stavu, historie lÃ©Äby, preventivnÃ­ch opatÅ™enÃ­ a lÃ©kaÅ™skÃ½ch zÃ¡krokÅ¯ pro jednotlivÃ¡ zvÃ­Å™ata s moÅ¾nostÃ­ sledovÃ¡nÃ­ vÃ½voje v Äase.

### Informace o plemenech
StrukturovanÃ¡ databÃ¡ze obsahujÃ­cÃ­ charakteristiky, zdravotnÃ­ predispozice, vÃ½Å¾ivovÃ© poÅ¾adavky a specifickÃ© potÅ™eby rÅ¯znÃ½ch plemen domÃ¡cÃ­ch zvÃ­Å™at.

### OÄkovacÃ­ kalendÃ¡Å™e
SystematickÃ© plÃ¡ny vakcinacÃ­ zaloÅ¾enÃ© na vÄ›ku zvÃ­Å™ete, plemeni, geografickÃ© poloze a aktuÃ¡lnÃ­ch veterinÃ¡rnÃ­ch doporuÄenÃ­ch.

### UrgentnÃ­ pÃ©Äe
SystÃ©m pro rychlou identifikaci zdravotnÃ­ch problÃ©mÅ¯ vyÅ¾adujÃ­cÃ­ch okamÅ¾itou veterinÃ¡rnÃ­ch zÃ¡sah s doporuÄenÃ­mi prvnÃ­ pomoci.

### VeterinÃ¡rnÃ­ literatura
RozsÃ¡hlÃ¡ kolekce odbornÃ½ch ÄlÃ¡nkÅ¯, studiÃ­, diagnostickÃ½ch postupÅ¯ a terapeutickÃ½ch protokolÅ¯ dostupnÃ½ch pro vyhledÃ¡vÃ¡nÃ­ a analÃ½zu.

### PojiÅ¡tÄ›nÃ­ domÃ¡cÃ­ch zvÃ­Å™at
InformaÄnÃ­ systÃ©m o dostupnÃ½ch pojistnÃ½ch produktech, jejich podmÃ­nkÃ¡ch, vÃ½lukÃ¡ch a procesu uplatÅˆovÃ¡nÃ­ nÃ¡rokÅ¯.

### BehaviorÃ¡lnÃ­ analÃ½za
SystÃ©m pro vyhodnocovÃ¡nÃ­ a interpretaci chovÃ¡nÃ­ zvÃ­Å™at s cÃ­lem identifikace behaviorÃ¡lnÃ­ch problÃ©mÅ¯ nebo zdravotnÃ­ch potÃ­Å¾Ã­.

## KomplexnÃ­ vysvÄ›tlenÃ­ projektu

SystÃ©m pro pÃ©Äi o zvÃ­Å™ata a veterinÃ¡rnÃ­ informace pÅ™edstavuje pokroÄilou AI platformu vyuÅ¾Ã­vajÃ­cÃ­ RAG architekturu pro poskytovÃ¡nÃ­ personalizovanÃ½ch rad v oblasti veterinÃ¡rnÃ­ pÃ©Äe. Projekt Å™eÅ¡Ã­ zÃ¡sadnÃ­ problÃ©my v oblasti pÅ™Ã­stupu k veterinÃ¡rnÃ­m informacÃ­m, sprÃ¡vy zdravotnÃ­ch zÃ¡znamÅ¯ a podpory rozhodovÃ¡nÃ­ majitelÅ¯ domÃ¡cÃ­ch zvÃ­Å™at.

### HlavnÃ­ cÃ­le projektu

**Centralizace veterinÃ¡rnÃ­ch informacÃ­**: VytvoÅ™enÃ­ jednotnÃ© platformy obsahujÃ­cÃ­ aktuÃ¡lnÃ­ veterinÃ¡rnÃ­ poznatky, doporuÄenÃ­ a best practices pÅ™Ã­stupnÃ© majitelÅ¯m zvÃ­Å™at i veterinÃ¡rnÃ­m profesionÃ¡lÅ¯m.

**PersonalizovanÃ¡ doporuÄenÃ­**: PoskytovÃ¡nÃ­ specifickÃ½ch rad zaloÅ¾enÃ½ch na plemeni, vÄ›ku, zdravotnÃ­m stavu a historii konkrÃ©tnÃ­ho zvÃ­Å™ete.

**Podpora preventivnÃ­ pÃ©Äe**: AutomatizovanÃ© pÅ™ipomÃ­nky oÄkovÃ¡nÃ­, preventivnÃ­ch prohlÃ­dek a zdravotnÃ­ch kontrol.

**RychlÃ¡ diagnostickÃ¡ podpora**: MoÅ¾nost pÅ™edbÄ›Å¾nÃ©ho vyhodnocenÃ­ symptomÅ¯ a doporuÄenÃ­ vhodnÃ½ch krokÅ¯ vÄetnÄ› urgentnosti veterinÃ¡rnÃ­ pÃ©Äe.

### TechnickÃ© vÃ½zvy

**Integrace heterogennÃ­ch dat**: Kombinace strukturovanÃ½ch dat (zdravotnÃ­ zÃ¡znamy) s nestrukturovanÃ½mi texty (veterinÃ¡rnÃ­ literatura).

**PÅ™esnost a spolehlivost**: ZajiÅ¡tÄ›nÃ­ vysokÃ© kvality odpovÄ›dÃ­ v oblasti, kde nepÅ™esnÃ© informace mohou ohrozit zdravÃ­ zvÃ­Å™at.

**Scalabilita**: NavrÅ¾enÃ­ architektury schopnÃ© zpracovat rostoucÃ­ objem dat a uÅ¾ivatelÅ¯.

**MultimodÃ¡lnÃ­ zpracovÃ¡nÃ­**: Podpora analÃ½zy textÅ¯, obrÃ¡zkÅ¯ (rentgeny, fotografie) a ÄasovÃ½ch Å™ad (monitoring zdravÃ­).

### PotenciÃ¡lnÃ­ dopad

Projekt mÅ¯Å¾e vÃ½raznÄ› zlepÅ¡it kvalitu pÃ©Äe o domÃ¡cÃ­ zvÃ­Å™ata snÃ­Å¾enÃ­m bariÃ©r pÅ™Ã­stupu k odbornÃ½m informacÃ­m, podporou preventivnÃ­ pÃ©Äe a zlepÅ¡enÃ­m komunikace mezi majiteli a veterinÃ¡Å™i.

## KomplexnÃ­ pÅ™Ã­klad s implementacÃ­ v Pythonu

````python
langchain==0.1.0
openai==1.0.0
chromadb==0.4.0
pandas==2.0.0
numpy==1.24.0
pydantic==2.0.0
fastapi==0.100.0
uvicorn==0.23.0
python-multipart==0.0.6
pillow==10.0.0
````

````python
from pydantic import BaseModel, Field
from typing import List, Optional, Dict, Any
from datetime import datetime, date
from enum import Enum

class PetType(str, Enum):
    DOG = "dog"
    CAT = "cat"
    BIRD = "bird"
    RABBIT = "rabbit"
    HAMSTER = "hamster"
    OTHER = "other"

class UrgencyLevel(str, Enum):
    LOW = "low"
    MEDIUM = "medium"
    HIGH = "high"
    CRITICAL = "critical"

class Pet(BaseModel):
    id: str
    name: str
    pet_type: PetType
    breed: str
    birth_date: date
    weight: float = Field(gt=0, description="Weight in kg")
    microchip_id: Optional[str] = None
    owner_id: str

class VaccinationRecord(BaseModel):
    id: str
    pet_id: str
    vaccine_name: str
    administration_date: date
    next_due_date: date
    veterinarian: str
    batch_number: Optional[str] = None

class HealthRecord(BaseModel):
    id: str
    pet_id: str
    visit_date: datetime
    symptoms: List[str]
    diagnosis: str
    treatment: str
    veterinarian: str
    follow_up_required: bool = False
    follow_up_date: Optional[date] = None

class EmergencyQuery(BaseModel):
    pet_id: str
    symptoms: List[str]
    duration: str
    severity: int = Field(ge=1, le=10)
    additional_info: Optional[str] = None
````

````python
from datetime import date, datetime, timedelta
from src.models.pet_models import Pet, VaccinationRecord, HealthRecord, PetType
import json

# VzorovÃ¡ data pro demonstraci
SAMPLE_PETS = [
    Pet(
        id="pet_001",
        name="Rex",
        pet_type=PetType.DOG,
        breed="NÄ›meckÃ½ ovÄÃ¡k",
        birth_date=date(2020, 5, 15),
        weight=25.5,
        microchip_id="203456789012345",
        owner_id="owner_001"
    ),
    Pet(
        id="pet_002",
        name="Miska",
        pet_type=PetType.CAT,
        breed="PerskÃ¡ koÄka",
        birth_date=date(2019, 8, 22),
        weight=4.2,
        owner_id="owner_002"
    )
]

SAMPLE_VACCINATIONS = [
    VaccinationRecord(
        id="vacc_001",
        pet_id="pet_001",
        vaccine_name="VakcÃ­na proti vzteklinÄ›",
        administration_date=date(2023, 6, 1),
        next_due_date=date(2024, 6, 1),
        veterinarian="MVDr. NovÃ¡k"
    ),
    VaccinationRecord(
        id="vacc_002",
        pet_id="pet_002",
        vaccine_name="KombinovanÃ¡ vakcÃ­na koÄek",
        administration_date=date(2023, 7, 15),
        next_due_date=date(2024, 7, 15),
        veterinarian="MVDr. SvobodovÃ¡"
    )
]

VETERINARY_KNOWLEDGE_BASE = [
    {
        "id": "kb_001",
        "title": "PrÃ­znaky gastritÃ­dy u psÅ¯",
        "content": "GastritÃ­da u psÅ¯ se projevuje zvracenÃ­m, prÅ¯jmem, Ãºbytkem chuti k jÃ­dlu a apatiÃ­. AkutnÃ­ forma vyÅ¾aduje rychlou intervenci.",
        "category": "digestive_system",
        "species": ["dog"],
        "urgency": "medium"
    },
    {
        "id": "kb_002", 
        "title": "OÄkovÃ¡nÃ­ koÄek - zÃ¡kladnÃ­ schÃ©ma",
        "content": "ZÃ¡kladnÃ­ oÄkovÃ¡nÃ­ koÄek zahrnuje vakcÃ­nu proti panleukopenii, kalicivirÃ³ze, rinotracheitidÄ› a vzteklinÄ›. PrvnÃ­ oÄkovÃ¡nÃ­ ve 8-9 tÃ½dnech vÄ›ku.",
        "category": "vaccination",
        "species": ["cat"],
        "urgency": "low"
    },
    {
        "id": "kb_003",
        "title": "AkutnÃ­ otravy u domÃ¡cÃ­ch zvÃ­Å™at",
        "content": "PÅ™Ã­znaky otravy: zvracenÃ­, prÅ¯jem, tÅ™es, dezorientace, kÅ™eÄe. OKAMÅ½ITÄš kontaktujte veterinÃ¡Å™e! Nenavozujte zvracenÃ­ bez instrukcÃ­.",
        "category": "emergency",
        "species": ["dog", "cat"],
        "urgency": "critical"
    }
]

BREED_INFORMATION = {
    "NÄ›meckÃ½ ovÄÃ¡k": {
        "zdravotnÃ­_predispozice": ["dysplazie kyÄlÃ­", "dilatace Å¾aludku", "degenerativnÃ­ myelopatie"],
        "vÃ¡ha_dospÄ›lÃ½": "22-40 kg",
        "dÃ©lka_Å¾ivota": "9-13 let",
        "aktivita": "vysokÃ¡",
        "pÃ©Äe_srst": "pravidelnÃ© kartÃ¡ÄovÃ¡nÃ­"
    },
    "PerskÃ¡ koÄka": {
        "zdravotnÃ­_predispozice": ["polycystickÃ¡ nemoc ledvin", "problÃ©my s dÃ½chÃ¡nÃ­m", "oÄnÃ­ problÃ©my"],
        "vÃ¡ha_dospÄ›lÃ½": "3-5.5 kg", 
        "dÃ©lka_Å¾ivota": "12-17 let",
        "aktivita": "nÃ­zkÃ¡ aÅ¾ stÅ™ednÃ­",
        "pÃ©Äe_srst": "dennÃ­ kartÃ¡ÄovÃ¡nÃ­ nutnÃ©"
    }
}
````

````python
import chromadb
from langchain.embeddings import OpenAIEmbeddings
from langchain.vectorstores import Chroma
from langchain.text_splitter import RecursiveCharacterTextSplitter
from typing import List, Dict, Any
import json

class VeterinaryVectorStore:
    def __init__(self, persist_directory: str = "./chroma_db"):
        self.embeddings = OpenAIEmbeddings()
        self.persist_directory = persist_directory
        self.vector_store = None
        self.text_splitter = RecursiveCharacterTextSplitter(
            chunk_size=500,
            chunk_overlap=50,
            separators=["\n\n", "\n", ".", "!", "?", ",", " ", ""]
        )
        
    def initialize_store(self, knowledge_base: List[Dict[str, Any]]):
        """Inicializace vektorovÃ©ho ÃºloÅ¾iÅ¡tÄ› s veterinÃ¡rnÃ­ znalostnÃ­ bÃ¡zÃ­"""
        documents = []
        metadatas = []
        
        for item in knowledge_base:
            # VytvoÅ™enÃ­ dokumentu pro vektorovÃ© ÃºloÅ¾iÅ¡tÄ›
            content = f"NÃ¡zev: {item['title']}\nObsah: {item['content']}"
            
            # RozdÄ›lenÃ­ dlouhÃ½ch dokumentÅ¯
            chunks = self.text_splitter.split_text(content)
            
            for chunk in chunks:
                documents.append(chunk)
                metadatas.append({
                    "id": item["id"],
                    "title": item["title"],
                    "category": item["category"],
                    "species": ",".join(item["species"]),
                    "urgency": item["urgency"]
                })
        
        # VytvoÅ™enÃ­ vektorovÃ©ho ÃºloÅ¾iÅ¡tÄ›
        self.vector_store = Chroma.from_texts(
            texts=documents,
            embedding=self.embeddings,
            metadatas=metadatas,
            persist_directory=self.persist_directory
        )
        
        self.vector_store.persist()
        
    def search_similar(self, query: str, k: int = 5, species_filter: str = None) -> List[Dict[str, Any]]:
        """VyhledÃ¡nÃ­ podobnÃ½ch dokumentÅ¯"""
        if not self.vector_store:
            raise ValueError("VektorovÃ© ÃºloÅ¾iÅ¡tÄ› nenÃ­ inicializovÃ¡no")
            
        # PÅ™Ã­prava filtru podle druhu zvÃ­Å™ete
        filter_dict = {}
        if species_filter:
            filter_dict = {"species": {"$contains": species_filter}}
            
        results = self.vector_store.similarity_search_with_score(
            query=query,
            k=k,
            filter=filter_dict if filter_dict else None
        )
        
        return [
            {
                "content": doc.page_content,
                "metadata": doc.metadata,
                "score": score
            }
            for doc, score in results
        ]
        
    def load_existing_store(self):
        """NaÄtenÃ­ existujÃ­cÃ­ho vektorovÃ©ho ÃºloÅ¾iÅ¡tÄ›"""
        try:
            self.vector_store = Chroma(
                persist_directory=self.persist_directory,
                embedding_function=self.embeddings
            )
        except Exception as e:
            print(f"NepodaÅ™ilo se naÄÃ­st existujÃ­cÃ­ ÃºloÅ¾iÅ¡tÄ›: {e}")
            return False
        return True
````

````python
from langchain.llms import OpenAI
from langchain.chains import RetrievalQA
from langchain.prompts import PromptTemplate
from src.rag.vector_store import VeterinaryVectorStore
from src.models.pet_models import Pet, EmergencyQuery, UrgencyLevel
from src.data.sample_data import BREED_INFORMATION
from typing import Dict, Any, List
import json

class VeterinaryRAGSystem:
    def __init__(self, openai_api_key: str):
        self.llm = OpenAI(
            temperature=0.2,
            openai_api_key=openai_api_key,
            max_tokens=1000
        )
        self.vector_store = VeterinaryVectorStore()
        self.qa_chain = None
        
        # PromptovÃ© Å¡ablony
        self.general_prompt = PromptTemplate(
            input_variables=["context", "question", "pet_info"],
            template="""
            Jsi odbornÃ½ veterinÃ¡rnÃ­ asistent poskytujÃ­cÃ­ informace o pÃ©Äi o zvÃ­Å™ata.
            
            Informace o zvÃ­Å™eti:
            {pet_info}
            
            Kontext z databÃ¡ze znalostÃ­:
            {context}
            
            OtÃ¡zka: {question}
            
            Poskytni pÅ™esnou, faktickou odpovÄ›Ä zaloÅ¾enou na veterinÃ¡rnÃ­ch poznatcÃ­ch.
            Pokud situace vyÅ¾aduje nÃ¡vÅ¡tÄ›vu veterinÃ¡Å™e, jasnÄ› to doporuÄuj.
            Nikdy neposkytuj diagnÃ³zu - pouze informativnÃ­ rady.
            
            OdpovÄ›Ä:
            """
        )
        
        self.emergency_prompt = PromptTemplate(
            input_variables=["symptoms", "pet_info", "context", "severity"],
            template="""
            URGENTNÃ VETERINÃRNÃ KONZULTACE
            
            Informace o zvÃ­Å™eti:
            {pet_info}
            
            PÅ™Ã­znaky: {symptoms}
            ZÃ¡vaÅ¾nost (1-10): {severity}
            
            RelevantnÃ­ informace:
            {context}
            
            Poskytni:
            1. OkamÅ¾itou radu (co dÄ›lat TEÄ)
            2. ÃšroveÅˆ urgentnosti (LOW/MEDIUM/HIGH/CRITICAL)
            3. DoporuÄenÃ­ dalÅ¡Ã­ch krokÅ¯
            4. VarovnÃ© signÃ¡ly vyÅ¾adujÃ­cÃ­ okamÅ¾itou veterinÃ¡rnÃ­ pÃ©Äi
            
            DÅ®LEÅ½ITÃ‰: PÅ™i jakÃ½chkoli pochybnostech doporuÄuj okamÅ¾itou veterinÃ¡rnÃ­ pÃ©Äi!
            
            OdpovÄ›Ä:
            """
        )
    
    def initialize_system(self, knowledge_base: List[Dict[str, Any]]):
        """Inicializace RAG systÃ©mu"""
        # Inicializace vektorovÃ©ho ÃºloÅ¾iÅ¡tÄ›
        if not self.vector_store.load_existing_store():
            print("VytvÃ¡Å™enÃ­ novÃ©ho vektorovÃ©ho ÃºloÅ¾iÅ¡tÄ›...")
            self.vector_store.initialize_store(knowledge_base)
        
        # VytvoÅ™enÃ­ QA Å™etÄ›zce
        self.qa_chain = RetrievalQA.from_chain_type(
            llm=self.llm,
            chain_type="stuff",
            retriever=self.vector_store.vector_store.as_retriever(search_kwargs={"k": 3}),
            chain_type_kwargs={"prompt": self.general_prompt}
        )
    
    def get_pet_context(self, pet: Pet) -> str:
        """VytvoÅ™enÃ­ kontextu o zvÃ­Å™eti"""
        age_years = (datetime.now().date() - pet.birth_date).days // 365
        
        breed_info = BREED_INFORMATION.get(pet.breed, {})
        breed_context = ""
        if breed_info:
            breed_context = f"""
            Informace o plemeni {pet.breed}:
            - ZdravotnÃ­ predispozice: {', '.join(breed_info.get('zdravotnÃ­_predispozice', []))}
            - TypickÃ¡ vÃ¡ha: {breed_info.get('vÃ¡ha_dospÄ›lÃ½', 'neznÃ¡mÃ¡')}
            - DÃ©lka Å¾ivota: {breed_info.get('dÃ©lka_Å¾ivota', 'neznÃ¡mÃ¡')}
            - Aktivita: {breed_info.get('aktivita', 'neznÃ¡mÃ¡')}
            """
        
        return f"""
        JmÃ©no: {pet.name}
        Druh: {pet.pet_type.value}
        Plemeno: {pet.breed}
        VÄ›k: {age_years} let
        VÃ¡ha: {pet.weight} kg
        {breed_context}
        """
    
    def ask_question(self, question: str, pet: Pet) -> Dict[str, Any]:
        """ZodpovÄ›zenÃ­ obecnÃ© otÃ¡zky o zvÃ­Å™eti"""
        try:
            pet_context = self.get_pet_context(pet)
            
            # VyhledÃ¡nÃ­ relevantnÃ­ch dokumentÅ¯
            relevant_docs = self.vector_store.search_similar(
                query=question,
                species_filter=pet.pet_type.value,
                k=3
            )
            
            context = "\n".join([doc["content"] for doc in relevant_docs])
            
            # VytvoÅ™enÃ­ odpovÄ›di
            response = self.llm(self.general_prompt.format(
                context=context,
                question=question,
                pet_info=pet_context
            ))
            
            return {
                "answer": response.strip(),
                "sources": [doc["metadata"] for doc in relevant_docs],
                "confidence": self._calculate_confidence(relevant_docs)
            }
            
        except Exception as e:
            return {
                "answer": f"OmlouvÃ¡m se, doÅ¡lo k chybÄ› pÅ™i zpracovÃ¡nÃ­ dotazu: {str(e)}",
                "sources": [],
                "confidence": 0.0
            }
    
    def handle_emergency(self, emergency: EmergencyQuery, pet: Pet) -> Dict[str, Any]:
        """ZpracovÃ¡nÃ­ urgentnÃ­ho dotazu"""
        try:
            pet_context = self.get_pet_context(pet)
            symptoms_text = ", ".join(emergency.symptoms)
            
            # VyhledÃ¡nÃ­ informacÃ­ o pÅ™Ã­znacÃ­ch
            search_query = f"pÅ™Ã­znaky urgentnÃ­ {symptoms_text}"
            relevant_docs = self.vector_store.search_similar(
                query=search_query,
                species_filter=pet.pet_type.value,
                k=5
            )
            
            context = "\n".join([doc["content"] for doc in relevant_docs])
            
            # GenerovÃ¡nÃ­ urgentnÃ­ odpovÄ›di
            response = self.llm(self.emergency_prompt.format(
                symptoms=symptoms_text,
                pet_info=pet_context,
                context=context,
                severity=emergency.severity
            ))
            
            # UrÄenÃ­ ÃºrovnÄ› urgentnosti
            urgency = self._determine_urgency(emergency, relevant_docs)
            
            return {
                "response": response.strip(),
                "urgency_level": urgency,
                "immediate_action_required": urgency in [UrgencyLevel.HIGH, UrgencyLevel.CRITICAL],
                "sources": [doc["metadata"] for doc in relevant_docs]
            }
            
        except Exception as e:
            return {
                "response": "CHYBA: Kontaktujte okamÅ¾itÄ› veterinÃ¡Å™e!",
                "urgency_level": UrgencyLevel.HIGH,
                "immediate_action_required": True,
                "sources": [],
                "error": str(e)
            }
    
    def _calculate_confidence(self, docs: List[Dict[str, Any]]) -> float:
        """VÃ½poÄet mÃ­ry spolehlivosti odpovÄ›di"""
        if not docs:
            return 0.0
        
        # JednoduchÃ½ vÃ½poÄet na zÃ¡kladÄ› skÃ³re podobnosti
        avg_score = sum(doc.get("score", 0) for doc in docs) / len(docs)
        return min(1.0, max(0.0, 1.0 - avg_score))  # PÅ™evod distance na confidence
    
    def _determine_urgency(self, emergency: EmergencyQuery, docs: List[Dict[str, Any]]) -> UrgencyLevel:
        """UrÄenÃ­ ÃºrovnÄ› urgentnosti"""
        # Kontrola kritickÃ½ch pÅ™Ã­znakÅ¯
        critical_symptoms = ["kÅ™eÄe", "bezvÄ›domÃ­", "tÄ›Å¾kÃ© dÃ½chÃ¡nÃ­", "krvÃ¡cenÃ­", "otravy"]
        high_symptoms = ["zvracenÃ­", "prÅ¯jem", "vysokÃ¡ teplota", "apatÃ­a"]
        
        symptoms_lower = [s.lower() for s in emergency.symptoms]
        
        # KritickÃ© pÅ™Ã­znaky
        if any(symptom in " ".join(symptoms_lower) for symptom in critical_symptoms):
            return UrgencyLevel.CRITICAL
        
        # VysokÃ¡ zÃ¡vaÅ¾nost podle uÅ¾ivatele
        if emergency.severity >= 8:
            return UrgencyLevel.HIGH
        
        # Kontrola v databÃ¡zi znalostÃ­
        for doc in docs:
            if doc.get("metadata", {}).get("urgency") == "critical":
                return UrgencyLevel.CRITICAL
            elif doc.get("metadata", {}).get("urgency") == "high":
                return UrgencyLevel.HIGH
        
        # StÅ™ednÃ­ urgentnost
        if emergency.severity >= 5 or any(symptom in " ".join(symptoms_lower) for symptom in high_symptoms):
            return UrgencyLevel.MEDIUM
        
        return UrgencyLevel.LOW
````

````python
from fastapi import FastAPI, HTTPException, Depends
from fastapi.middleware.cors import CORSMiddleware
from src.rag.rag_system import VeterinaryRAGSystem
from src.models.pet_models import Pet, EmergencyQuery, VaccinationRecord
from src.data.sample_data import SAMPLE_PETS, VETERINARY_KNOWLEDGE_BASE
from typing import Dict, Any, List
import os
from datetime import datetime, date

app = FastAPI(
    title="VeterinÃ¡rnÃ­ informaÄnÃ­ systÃ©m",
    description="AI-powered systÃ©m pro podporu pÃ©Äe o domÃ¡cÃ­ zvÃ­Å™ata",
    version="1.0.0"
)

app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# GlobÃ¡lnÃ­ instance RAG systÃ©mu
rag_system = None

@app.on_event("startup")
async def startup_event():
    """Inicializace aplikace"""
    global rag_system
    
    # Kontrola API klÃ­Äe
    openai_api_key = os.getenv("OPENAI_API_KEY")
    if not openai_api_key:
        print("VAROVÃNÃ: OPENAI_API_KEY nenÃ­ nastaven!")
        openai_api_key = "demo_key"  # Pro demo ÃºÄely
    
    # Inicializace RAG systÃ©mu
    rag_system = VeterinaryRAGSystem(openai_api_key)
    rag_system.initialize_system(VETERINARY_KNOWLEDGE_BASE)
    
    print("VeterinÃ¡rnÃ­ RAG systÃ©m byl ÃºspÄ›Å¡nÄ› inicializovÃ¡n!")

def get_rag_system() -> VeterinaryRAGSystem:
    """Dependency injection pro RAG systÃ©m"""
    if rag_system is None:
        raise HTTPException(status_code=500, detail="RAG systÃ©m nenÃ­ inicializovÃ¡n")
    return rag_system

@app.get("/")
async def root():
    """ZÃ¡kladnÃ­ endpoint"""
    return {
        "message": "VeterinÃ¡rnÃ­ informaÄnÃ­ systÃ©m", 
        "version": "1.0.0",
        "status": "running"
    }

@app.get("/pets", response_model=List[Pet])
async def get_pets():
    """ZÃ­skÃ¡nÃ­ seznamu vÅ¡ech zvÃ­Å™at"""
    return SAMPLE_PETS

@app.get("/pets/{pet_id}", response_model=Pet)
async def get_pet(pet_id: str):
    """ZÃ­skÃ¡nÃ­ konkrÃ©tnÃ­ho zvÃ­Å™ete"""
    pet = next((p for p in SAMPLE_PETS if p.id == pet_id), None)
    if not pet:
        raise HTTPException(status_code=404, detail="ZvÃ­Å™e nenalezeno")
    return pet

@app.post("/ask")
async def ask_question(
    pet_id: str,
    question: str,
    rag: VeterinaryRAGSystem = Depends(get_rag_system)
) -> Dict[str, Any]:
    """ZodpovÄ›zenÃ­ otÃ¡zky o zvÃ­Å™eti"""
    
    # NajitÃ­ zvÃ­Å™ete
    pet = next((p for p in SAMPLE_PETS if p.id == pet_id), None)
    if not pet:
        raise HTTPException(status_code=404, detail="ZvÃ­Å™e nenalezeno")
    
    # ZpracovÃ¡nÃ­ dotazu
    result = rag.ask_question(question, pet)
    
    return {
        "pet_id": pet_id,
        "question": question,
        "timestamp": datetime.now().isoformat(),
        **result
    }

@app.post("/emergency")
async def handle_emergency(
    emergency: EmergencyQuery,
    rag: VeterinaryRAGSystem = Depends(get_rag_system)
) -> Dict[str, Any]:
    """ZpracovÃ¡nÃ­ urgentnÃ­ho dotazu"""
    
    # NajitÃ­ zvÃ­Å™ete
    pet = next((p for p in SAMPLE_PETS if p.id == emergency.pet_id), None)
    if not pet:
        raise HTTPException(status_code=404, detail="ZvÃ­Å™e nenalezeno")
    
    # ZpracovÃ¡nÃ­ urgence
    result = rag.handle_emergency(emergency, pet)
    
    return {
        "timestamp": datetime.now().isoformat(),
        "pet_id": emergency.pet_id,
        "symptoms": emergency.symptoms,
        **result
    }

@app.get("/vaccination-schedule/{pet_id}")
async def get_vaccination_schedule(pet_id: str):
    """ZÃ­skÃ¡nÃ­ oÄkovacÃ­ho kalendÃ¡Å™e"""
    pet = next((p for p in SAMPLE_PETS if p.id == pet_id), None)
    if not pet:
        raise HTTPException(status_code=404, detail="ZvÃ­Å™e nenalezeno")
    
    # Simulace oÄkovacÃ­ho kalendÃ¡Å™e
    today = date.today()
    
    schedule = {
        "pet_id": pet_id,
        "upcoming_vaccinations": [
            {
                "vaccine": "RoÄnÃ­ pÅ™eoÄkovÃ¡nÃ­",
                "due_date": date(today.year + 1, today.month, today.day).isoformat(),
                "priority": "high"
            }
        ],
        "overdue_vaccinations": [],
        "completed_vaccinations": [
            {
                "vaccine": "ZÃ¡kladnÃ­ imunizace",
                "date": "2023-06-01",
                "veterinarian": "MVDr. NovÃ¡k"
            }
        ]
    }
    
    return schedule

@app.get("/health-insights/{pet_id}")
async def get_health_insights(
    pet_id: str,
    rag: VeterinaryRAGSystem = Depends(get_rag_system)
):
    """ZÃ­skÃ¡nÃ­ zdravotnÃ­ch doporuÄenÃ­ pro zvÃ­Å™e"""
    pet = next((p for p in SAMPLE_PETS if p.id == pet_id), None)
    if not pet:
        raise HTTPException(status_code=404, detail="ZvÃ­Å™e nenalezeno")
    
    # GenerovÃ¡nÃ­ personalizovanÃ½ch doporuÄenÃ­
    age_years = (datetime.now().date() - pet.birth_date).days // 365
    
    question = f"JakÃ¡ jsou doporuÄenÃ­ pro pÃ©Äi o {age_years} letÃ©ho {pet.breed.lower()}a?"
    insights = rag.ask_question(question, pet)
    
    return {
        "pet_id": pet_id,
        "age_years": age_years,
        "breed_specific_care": insights["answer"],
        "confidence": insights["confidence"],
        "generated_at": datetime.now().isoformat()
    }

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)
````

````python
"""
Demo skript pro testovÃ¡nÃ­ veterinÃ¡rnÃ­ho RAG systÃ©mu
"""
import asyncio
import os
from src.rag.rag_system import VeterinaryRAGSystem
from src.models.pet_models import Pet, EmergencyQuery, PetType, UrgencyLevel
from src.data.sample_data import SAMPLE_PETS, VETERINARY_KNOWLEDGE_BASE
from datetime import date

async def run_demo():
    print("ğŸ• DEMO: VeterinÃ¡rnÃ­ RAG systÃ©m ğŸ±")
    print("=" * 50)
    
    # NastavenÃ­ API klÃ­Äe (pro demo pouÅ¾ijte vÃ¡Å¡ vlastnÃ­ klÃ­Ä)
    openai_api_key = os.getenv("OPENAI_API_KEY", "demo_key")
    
    # Inicializace systÃ©mu
    print("ğŸ“š Inicializace RAG systÃ©mu...")
    rag_system = VeterinaryRAGSystem(openai_api_key)
    rag_system.initialize_system(VETERINARY_KNOWLEDGE_BASE)
    
    # Test obecnÃ©ho dotazu
    print("\nğŸ” Test obecnÃ©ho dotazu:")
    print("-" * 30)
    rex = SAMPLE_PETS[0]  # NÄ›meckÃ½ ovÄÃ¡k Rex
    
    question = "Jak Äasto bych mÄ›l krmit dospÄ›lÃ©ho nÄ›meckÃ©ho ovÄÃ¡ka?"
    result = rag_system.ask_question(question, rex)
    
    print(f"OtÃ¡zka: {question}")
    print(f"OdpovÄ›Ä: {result['answer']}")
    print(f"Spolehlivost: {result['confidence']:.2f}")
    
    # Test urgentnÃ­ho dotazu
    print("\nğŸš¨ Test urgentnÃ­ho dotazu:")
    print("-" * 30)
    
    emergency = EmergencyQuery(
        pet_id="pet_001",
        symptoms=["zvracenÃ­", "apatia", "nechuÅ¥ k jÃ­dlu"],
        duration="2 hodiny",
        severity=6
    )
    
    emergency_result = rag_system.handle_emergency(emergency, rex)
    
    print(f"PÅ™Ã­znaky: {', '.join(emergency.symptoms)}")
    print(f"ZÃ¡vaÅ¾nost: {emergency.severity}/10")
    print(f"Urgentnost: {emergency_result['urgency_level']}")
    print(f"OkamÅ¾itÃ¡ akce potÅ™eba: {emergency_result['immediate_action_required']}")
    print(f"DoporuÄenÃ­: {emergency_result['response'][:200]}...")
    
    # Test vyhledÃ¡vÃ¡nÃ­ podle plemene
    print("\nğŸ” Test vyhledÃ¡vÃ¡nÃ­ podle plemene:")
    print("-" * 30)
    
    breed_question = "JakÃ© jsou typickÃ© zdravotnÃ­ problÃ©my nÄ›meckÃ½ch ovÄÃ¡kÅ¯?"
    breed_result = rag_system.ask_question(breed_question, rex)
    
    print(f"OtÃ¡zka: {breed_question}")
    print(f"OdpovÄ›Ä: {breed_result['answer'][:200]}...")
    
    print("\nâœ… Demo dokonÄeno!")
    print("\nPro spuÅ¡tÄ›nÃ­ webovÃ©ho API pouÅ¾ijte:")
    print("python -m uvicorn src.api.main:app --reload")

if __name__ == "__main__":
    asyncio.run(run_demo())
````

````python
from setuptools import setup, find_packages

setup(
    name="veterinary-rag-system",
    version="1.0.0",
    description="AI-powered veterinÃ¡rnÃ­ informaÄnÃ­ systÃ©m s RAG architekturou",
    author="AI Assistant",
    packages=find_packages(),
    install_requires=[
        "langchain==0.1.0",
        "openai==1.0.0", 
        "chromadb==0.4.0",
        "pandas==2.0.0",
        "numpy==1.24.0",
        "pydantic==2.0.0",
        "fastapi==0.100.0",
        "uvicorn==0.23.0",
        "python-multipart==0.0.6",
        "pillow==10.0.0"
    ],
    python_requires=">=3.8",
    classifiers=[
        "Development Status :: 4 - Beta",
        "Intended Audience :: Healthcare Industry",
        "Topic :: Scientific/Engineering :: Artificial Intelligence",
        "Programming Language :: Python :: 3.8+",
    ]
)
````

## ShrnutÃ­ projektu

VeterinÃ¡rnÃ­ informaÄnÃ­ systÃ©m s RAG architekturou pÅ™edstavuje pokroÄilÃ© Å™eÅ¡enÃ­ kombinujÃ­cÃ­ umÄ›lou inteligenci s odbornou veterinÃ¡rnÃ­ pÃ©ÄÃ­. SystÃ©m poskytuje personalizovanÃ© rady zaloÅ¾enÃ© na konkrÃ©tnÃ­ch charakteristikÃ¡ch zvÃ­Å™at, jejich zdravotnÃ­ historii a aktuÃ¡lnÃ­ch veterinÃ¡rnÃ­ch poznatcÃ­ch.

### KlÃ­ÄovÃ© vÃ½hody

**PÅ™esnÃ© personalizovanÃ© rady**: Kombinace informacÃ­ o konkrÃ©tnÃ­m zvÃ­Å™eti s rozsÃ¡hlou databÃ¡zÃ­ veterinÃ¡rnÃ­ch znalostÃ­ umoÅ¾Åˆuje poskytovat specifickÃ© a relevantnÃ­ doporuÄenÃ­.

**RychlÃ¡ urgentnÃ­ podpora**: SystÃ©m dokÃ¡Å¾e vyhodnotit zÃ¡vaÅ¾nost symptomÅ¯ a poskytnout okamÅ¾itÃ¡ doporuÄenÃ­ vÄetnÄ› urÄenÃ­ potÅ™eby veterinÃ¡rnÃ­ pÃ©Äe.

**KontinuÃ¡lnÃ­ uÄenÃ­**: RAG architektura umoÅ¾Åˆuje snadnÃ© aktualizace znalostnÃ­ bÃ¡ze novÃ½mi veterinÃ¡rnÃ­mi poznatky bez nutnosti pÅ™etrÃ©novÃ¡nÃ­ modelu.

**ScalabilnÃ­ design**: ModulÃ¡rnÃ­ architektura podporuje rÅ¯st systÃ©mu a integraci dalÅ¡Ã­ch funkcÃ­ jako je analÃ½za obrazu nebo IoT monitoring.

### TechnickÃ© inovace

Projekt vyuÅ¾Ã­vÃ¡ nejmodernÄ›jÅ¡Ã­ technologie vÄetnÄ› vektorovÃ½ch databÃ¡zÃ­ pro efektivnÃ­ vyhledÃ¡vÃ¡nÃ­, velkÃ½ch jazykovÃ½ch modelÅ¯ pro generovÃ¡nÃ­ odpovÄ›dÃ­ a robustnÃ­ API architektury pro integraci s externÃ­mi systÃ©my. DÅ¯raz na error handling a validaci dat zajiÅ¡Å¥uje spolehlivost v kritickÃ½ch situacÃ­ch.

SystÃ©m mÃ¡ potenciÃ¡l vÃ½raznÄ› zlepÅ¡it kvalitu pÃ©Äe o domÃ¡cÃ­ zvÃ­Å™ata a podporovat preventivnÃ­ pÅ™Ã­stup k veterinÃ¡rnÃ­ medicÃ­nÄ›.