<small>Claude Sonnet 4 **(Sportovn√≠ Analytika a Sledov√°n√≠ V√Ωkonnosti s RAG)**</small>
# Sports Analytics and Performance Tracker

## 1. N√°zev Projektu

**Sports Analytics and Performance Tracker** - Inteligentn√≠ syst√©m pro komplexn√≠ anal√Ωzu sportovn√≠ v√Ωkonnosti vyu≈æ√≠vaj√≠c√≠ RAG (Retrieval-Augmented Generation) pro sledov√°n√≠ statistik hr√°ƒç≈Ø, anal√Ωzu hern√≠ho materi√°lu, optimalizaci tr√©ninkov√Ωch re≈æim≈Ø a prevenci zranƒõn√≠.

## 2. Kl√≠ƒçov√© Koncepty

### RAG (Retrieval-Augmented Generation)
Pokroƒçil√° AI architektura kombinuj√≠c√≠ vyhled√°v√°n√≠ relevantn√≠ch sportovn√≠ch dat s generativn√≠mi schopnostmi pro vytv√°≈ôen√≠ personalizovan√Ωch anal√Ωz a doporuƒçen√≠.

### Statistiky Hr√°ƒç≈Ø (Player Statistics)
Kvantitativn√≠ mƒõ≈ô√≠tka v√Ωkonnosti zahrnuj√≠c√≠ sk√≥re, asistence, p≈ôesnost st≈ôelby, rychlost, vzd√°lenost, srdeƒçn√≠ frekvenci a dal≈°√≠ biometrick√© √∫daje.

### Hern√≠ Z√°znamy (Game Footage)
Video materi√°l ze z√°pas≈Ø a tr√©nink≈Ø analyzovan√Ω pomoc√≠ computer vision pro extrakci pohybov√Ωch vzorc≈Ø a taktick√Ωch informac√≠.

### Tr√©ninkov√© Re≈æimy (Training Regimens)
Strukturovan√© tr√©ninkov√© pl√°ny p≈ôizp≈Øsoben√© individu√°ln√≠m pot≈ôeb√°m hr√°ƒç≈Ø na z√°kladƒõ anal√Ωzy v√Ωkonnostn√≠ch dat.

### Prevence Zranƒõn√≠ (Injury Prevention)
Prediktivn√≠ modely identifikuj√≠c√≠ rizikov√© faktory a navrhuj√≠c√≠ preventivn√≠ opat≈ôen√≠ na z√°kladƒõ biomechanick√Ωch dat.

### ESPN API
Rozhran√≠ pro p≈ô√≠stup k ofici√°ln√≠m sportovn√≠m statistik√°m, v√Ωsledk≈Øm z√°pas≈Ø a historick√Ωm dat≈Øm.

### Biomechanick√° Anal√Ωza
Vƒõdeck√© studium pohybu tƒõla bƒõhem sportovn√≠ch aktivit pro optimalizaci techniky a prevenci zranƒõn√≠.

### T√Ωmov√° Strategie (Team Strategy)
Taktick√© pl√°nov√°n√≠ zalo≈æen√© na anal√Ωze dat o v√Ωkonnosti t√Ωmu, soupe≈ô√≠ch a hern√≠ch situac√≠ch.

## 3. Komplexn√≠ Vysvƒõtlen√≠ Projektu

### C√≠le Projektu
Syst√©m vytv√°≈ô√≠ komplexn√≠ platformu pro sportovn√≠ anal√Ωzu zamƒõ≈ôenou na:

- **V√Ωkonnostn√≠ optimalizace**: Identifikace siln√Ωch a slab√Ωch str√°nek jednotliv√Ωch hr√°ƒç≈Ø
- **Prediktivn√≠ anal√Ωza**: P≈ôedpovƒõdi v√Ωkonnosti a rizik zranƒõn√≠
- **Personalizovan√© tr√©ninkov√© pl√°ny**: AI-generovan√© doporuƒçen√≠ pro zlep≈°en√≠
- **Taktick√° anal√Ωza**: Strategick√© poznatky pro tren√©ry a analytiky
- **Real-time monitoring**: Okam≈æit√© sledov√°n√≠ v√Ωkonnosti bƒõhem tr√©nink≈Ø a z√°pas≈Ø

### Technick√© V√Ωzvy
- **Multimod√°ln√≠ data**: Integrace video, audio, senzorov√Ωch a textov√Ωch dat
- **Real-time processing**: Zpracov√°n√≠ dat v re√°ln√©m ƒçase bƒõhem z√°pas≈Ø
- **P≈ôesnost anal√Ωzy**: Vysok√° p≈ôesnost p≈ôi rozpozn√°v√°n√≠ pohyb≈Ø a vzorc≈Ø
- **≈†k√°lovatelnost**: Podpora v√≠ce sport≈Ø a tis√≠c≈Ø hr√°ƒç≈Ø souƒçasnƒõ
- **Privacy a bezpeƒçnost**: Ochrana citliv√Ωch zdravotn√≠ch a v√Ωkonnostn√≠ch dat

### Potenci√°ln√≠ Dopad
- **Profesion√°ln√≠ sport**: Konkurenƒçn√≠ v√Ωhoda pro t√Ωmy a jednotlivce
- **Zdrav√≠ atlet≈Ø**: Sn√≠≈æen√≠ rizika zranƒõn√≠ a rychlej≈°√≠ rehabilitace
- **Tr√©ninkov√© metody**: Revoluce v p≈ô√≠pravƒõ a rozvoji talent≈Ø
- **Fanou≈°kovsk√Ω z√°≈æitek**: Obohacen√≠ sledov√°n√≠ sportu o pokroƒçil√© anal√Ωzy
- **Ml√°de≈ænick√Ω sport**: Demokratizace p≈ô√≠stupu k profesion√°ln√≠m analytick√Ωm n√°stroj≈Øm

## 4. Komplexn√≠ P≈ô√≠klad s Python Implementac√≠

````python
import os
import json
import numpy as np
import pandas as pd
import cv2
import requests
from datetime import datetime, timedelta
from typing import List, Dict, Any, Optional, Tuple
import logging
from dataclasses import dataclass, asdict
import asyncio
import sqlite3

# AI/ML knihovny
from langchain.embeddings import OpenAIEmbeddings
from langchain.vectorstores import Chroma
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain.llms import OpenAI
from langchain.chains import RetrievalQA
from langchain.schema import Document
from langchain.prompts import PromptTemplate

# Computer Vision a ML
import mediapipe as mp
from sklearn.ensemble import RandomForestClassifier, IsolationForest
from sklearn.preprocessing import StandardScaler
from sklearn.model_selection import train_test_split

# Vizualizace a anal√Ωza
import matplotlib.pyplot as plt
import seaborn as sns
import plotly.graph_objects as go
import plotly.express as px
from plotly.subplots import make_subplots

# Konfigurace logov√°n√≠
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

@dataclass
class PlayerProfile:
    """Profil hr√°ƒçe"""
    player_id: str
    name: str
    position: str
    age: int
    height: float  # cm
    weight: float  # kg
    team: str
    sport: str
    preferred_foot: str = "right"
    experience_years: int = 0

@dataclass
class GameStatistics:
    """Statistiky ze z√°pasu"""
    game_id: str
    player_id: str
    date: str
    minutes_played: int
    goals: int = 0
    assists: int = 0
    shots: int = 0
    shots_on_target: int = 0
    passes: int = 0
    pass_accuracy: float = 0.0
    distance_covered: float = 0.0  # km
    max_speed: float = 0.0  # km/h
    avg_heart_rate: int = 0
    max_heart_rate: int = 0
    tackles: int = 0
    fouls: int = 0

@dataclass
class BiomechanicalData:
    """Biomechanick√° data"""
    timestamp: str
    player_id: str
    joint_angles: Dict[str, float]
    force_distribution: Dict[str, float]
    acceleration: Dict[str, float]
    activity_type: str
    injury_risk_score: float = 0.0

@dataclass
class TrainingSession:
    """Tr√©ninkov√° jednotka"""
    session_id: str
    player_id: str
    date: str
    duration: int  # minutes
    training_type: str
    intensity: str  # low, medium, high
    exercises: List[str]
    performance_metrics: Dict[str, float]
    coach_notes: str = ""

class SportDataManager:
    """Spr√°vce sportovn√≠ch dat"""
    
    def __init__(self, db_path: str = "sports_analytics.db"):
        self.db_path = db_path
        self.mp_pose = mp.solutions.pose.Pose()
        self.mp_drawing = mp.solutions.drawing_utils
        self._initialize_database()
        
    def _initialize_database(self):
        """Inicializace SQLite datab√°ze"""
        try:
            conn = sqlite3.connect(self.db_path)
            cursor = conn.cursor()
            
            # Tabulka hr√°ƒç≈Ø
            cursor.execute('''
                CREATE TABLE IF NOT EXISTS players (
                    player_id TEXT PRIMARY KEY,
                    name TEXT NOT NULL,
                    position TEXT,
                    age INTEGER,
                    height REAL,
                    weight REAL,
                    team TEXT,
                    sport TEXT,
                    preferred_foot TEXT,
                    experience_years INTEGER
                )
            ''')
            
            # Tabulka statistik
            cursor.execute('''
                CREATE TABLE IF NOT EXISTS game_stats (
                    game_id TEXT,
                    player_id TEXT,
                    date TEXT,
                    minutes_played INTEGER,
                    goals INTEGER,
                    assists INTEGER,
                    shots INTEGER,
                    shots_on_target INTEGER,
                    passes INTEGER,
                    pass_accuracy REAL,
                    distance_covered REAL,
                    max_speed REAL,
                    avg_heart_rate INTEGER,
                    max_heart_rate INTEGER,
                    tackles INTEGER,
                    fouls INTEGER,
                    PRIMARY KEY (game_id, player_id)
                )
            ''')
            
            conn.commit()
            conn.close()
            logger.info("Datab√°ze √∫spƒõ≈°nƒõ inicializov√°na")
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi inicializaci datab√°ze: {e}")
    
    def save_player_profile(self, player: PlayerProfile):
        """Ulo≈æen√≠ profilu hr√°ƒçe"""
        try:
            conn = sqlite3.connect(self.db_path)
            cursor = conn.cursor()
            
            cursor.execute('''
                INSERT OR REPLACE INTO players VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
            ''', (
                player.player_id, player.name, player.position, player.age,
                player.height, player.weight, player.team, player.sport,
                player.preferred_foot, player.experience_years
            ))
            
            conn.commit()
            conn.close()
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi ukl√°d√°n√≠ hr√°ƒçe: {e}")
    
    def save_game_statistics(self, stats: GameStatistics):
        """Ulo≈æen√≠ hern√≠ch statistik"""
        try:
            conn = sqlite3.connect(self.db_path)
            cursor = conn.cursor()
            
            cursor.execute('''
                INSERT OR REPLACE INTO game_stats VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
            ''', (
                stats.game_id, stats.player_id, stats.date, stats.minutes_played,
                stats.goals, stats.assists, stats.shots, stats.shots_on_target,
                stats.passes, stats.pass_accuracy, stats.distance_covered,
                stats.max_speed, stats.avg_heart_rate, stats.max_heart_rate,
                stats.tackles, stats.fouls
            ))
            
            conn.commit()
            conn.close()
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi ukl√°d√°n√≠ statistik: {e}")
    
    def get_player_statistics(self, player_id: str, days: int = 30) -> List[GameStatistics]:
        """Z√≠sk√°n√≠ statistik hr√°ƒçe za posledn√≠ch N dn√≠"""
        try:
            conn = sqlite3.connect(self.db_path)
            
            end_date = datetime.now()
            start_date = end_date - timedelta(days=days)
            
            query = '''
                SELECT * FROM game_stats 
                WHERE player_id = ? AND date >= ? 
                ORDER BY date DESC
            '''
            
            df = pd.read_sql_query(query, conn, params=(player_id, start_date.isoformat()))
            conn.close()
            
            stats_list = []
            for _, row in df.iterrows():
                stats = GameStatistics(
                    game_id=row['game_id'],
                    player_id=row['player_id'],
                    date=row['date'],
                    minutes_played=row['minutes_played'],
                    goals=row['goals'],
                    assists=row['assists'],
                    shots=row['shots'],
                    shots_on_target=row['shots_on_target'],
                    passes=row['passes'],
                    pass_accuracy=row['pass_accuracy'],
                    distance_covered=row['distance_covered'],
                    max_speed=row['max_speed'],
                    avg_heart_rate=row['avg_heart_rate'],
                    max_heart_rate=row['max_heart_rate'],
                    tackles=row['tackles'],
                    fouls=row['fouls']
                )
                stats_list.append(stats)
            
            return stats_list
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi naƒç√≠t√°n√≠ statistik: {e}")
            return []
    
    def create_sample_data(self):
        """Vytvo≈ôen√≠ uk√°zkov√Ωch dat"""
        try:
            # Uk√°zkov√≠ hr√°ƒçi
            players = [
                PlayerProfile("P001", "Jan Nov√°k", "Forward", 25, 180, 75, "FC Praha", "Football"),
                PlayerProfile("P002", "Petr Svoboda", "Midfielder", 23, 175, 70, "FC Praha", "Football"),
                PlayerProfile("P003", "Tom√°≈° Dvo≈ô√°k", "Defender", 28, 185, 80, "FC Praha", "Football"),
                PlayerProfile("P004", "Martin ƒåern√Ω", "Goalkeeper", 30, 190, 85, "FC Praha", "Football")
            ]
            
            for player in players:
                self.save_player_profile(player)
            
            # Uk√°zkov√© statistiky
            for i, player in enumerate(players):
                for day in range(10):  # Posledn√≠ch 10 z√°pas≈Ø
                    date = (datetime.now() - timedelta(days=day*7)).isoformat()
                    stats = GameStatistics(
                        game_id=f"G{day+1:03d}",
                        player_id=player.player_id,
                        date=date,
                        minutes_played=90 - np.random.randint(0, 20),
                        goals=np.random.poisson(0.3 if player.position != "Forward" else 0.8),
                        assists=np.random.poisson(0.2),
                        shots=np.random.poisson(2 if player.position == "Forward" else 1),
                        shots_on_target=np.random.randint(0, 4),
                        passes=np.random.randint(30, 80),
                        pass_accuracy=np.random.uniform(0.75, 0.95),
                        distance_covered=np.random.uniform(8.0, 12.0),
                        max_speed=np.random.uniform(25.0, 35.0),
                        avg_heart_rate=np.random.randint(140, 170),
                        max_heart_rate=np.random.randint(180, 200),
                        tackles=np.random.poisson(3 if player.position == "Defender" else 1),
                        fouls=np.random.poisson(1)
                    )
                    self.save_game_statistics(stats)
            
            logger.info("Uk√°zkov√° data √∫spƒõ≈°nƒõ vytvo≈ôena")
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi vytv√°≈ôen√≠ uk√°zkov√Ωch dat: {e}")

class BiomechanicalAnalyzer:
    """Analyz√°tor biomechanick√Ωch dat"""
    
    def __init__(self):
        self.pose = mp.solutions.pose.Pose(
            static_image_mode=False,
            model_complexity=2,
            enable_segmentation=True,
            min_detection_confidence=0.5
        )
        self.injury_risk_model = None
        self._train_injury_risk_model()
    
    def _train_injury_risk_model(self):
        """Tr√©nov√°n√≠ modelu pro predikci rizika zranƒõn√≠"""
        try:
            # Syntetick√° data pro tr√©nov√°n√≠
            n_samples = 1000
            
            # Features: √∫hly kloub≈Ø, s√≠ly, akcelerace
            features = np.random.rand(n_samples, 15)  # 15 biomechanick√Ωch features
            
            # Simulace label≈Ø (riziko zranƒõn√≠)
            # Vysok√© hodnoty nƒõkter√Ωch features = vy≈°≈°√≠ riziko
            risk_scores = (
                features[:, 0] * 0.3 +  # √∫hel kolena
                features[:, 1] * 0.25 + # s√≠la na kotn√≠k
                features[:, 2] * 0.2 +  # later√°ln√≠ akcelerace
                np.random.normal(0, 0.1, n_samples)
            )
            
            labels = (risk_scores > np.percentile(risk_scores, 80)).astype(int)
            
            # Tr√©nov√°n√≠ modelu
            self.scaler = StandardScaler()
            features_scaled = self.scaler.fit_transform(features)
            
            self.injury_risk_model = RandomForestClassifier(n_estimators=100, random_state=42)
            self.injury_risk_model.fit(features_scaled, labels)
            
            logger.info("Model pro predikci rizika zranƒõn√≠ natr√©nov√°n")
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi tr√©nov√°n√≠ modelu: {e}")
    
    def analyze_movement_video(self, video_path: str) -> List[BiomechanicalData]:
        """Anal√Ωza pohybu z videa"""
        try:
            cap = cv2.VideoCapture(video_path)
            biomech_data = []
            frame_count = 0
            
            while cap.isOpened():
                ret, frame = cap.read()
                if not ret:
                    break
                
                # Konverze do RGB
                rgb_frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
                
                # Detekce p√≥zy
                results = self.pose.process(rgb_frame)
                
                if results.pose_landmarks:
                    # Extrakce √∫hl≈Ø kloub≈Ø
                    joint_angles = self._extract_joint_angles(results.pose_landmarks)
                    
                    # Simulace dal≈°√≠ch biomechanick√Ωch dat
                    force_dist = {
                        'left_foot': np.random.uniform(0.3, 0.7),
                        'right_foot': np.random.uniform(0.3, 0.7)
                    }
                    
                    acceleration = {
                        'x': np.random.uniform(-5, 5),
                        'y': np.random.uniform(-5, 5),
                        'z': np.random.uniform(-2, 2)
                    }
                    
                    # Predikce rizika zranƒõn√≠
                    features = list(joint_angles.values()) + list(force_dist.values()) + list(acceleration.values())
                    if len(features) >= 15:
                        features_scaled = self.scaler.transform([features[:15]])
                        injury_risk = self.injury_risk_model.predict_proba(features_scaled)[0][1]
                    else:
                        injury_risk = 0.0
                    
                    biomech_data.append(BiomechanicalData(
                        timestamp=datetime.now().isoformat(),
                        player_id="P001",  # V√Ωchoz√≠ hr√°ƒç
                        joint_angles=joint_angles,
                        force_distribution=force_dist,
                        acceleration=acceleration,
                        activity_type="running",
                        injury_risk_score=injury_risk
                    ))
                
                frame_count += 1
                if frame_count > 100:  # Limit pro demo
                    break
            
            cap.release()
            return biomech_data
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi anal√Ωze videa: {e}")
            return []
    
    def _extract_joint_angles(self, landmarks) -> Dict[str, float]:
        """Extrakce √∫hl≈Ø kloub≈Ø z landmark dat"""
        try:
            # Simulace v√Ωpoƒçtu √∫hl≈Ø kloub≈Ø
            angles = {}
            
            # Z√°kladn√≠ √∫hly (simulovan√©)
            angles['knee_left'] = np.random.uniform(10, 170)
            angles['knee_right'] = np.random.uniform(10, 170)
            angles['ankle_left'] = np.random.uniform(70, 110)
            angles['ankle_right'] = np.random.uniform(70, 110)
            angles['hip_left'] = np.random.uniform(10, 180)
            angles['hip_right'] = np.random.uniform(10, 180)
            angles['shoulder_left'] = np.random.uniform(0, 180)
            angles['shoulder_right'] = np.random.uniform(0, 180)
            angles['elbow_left'] = np.random.uniform(0, 180)
            angles['elbow_right'] = np.random.uniform(0, 180)
            
            return angles
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi extrakci √∫hl≈Ø: {e}")
            return {}

class PerformanceKnowledgeBase:
    """Znalostn√≠ b√°ze pro sportovn√≠ v√Ωkonnost"""
    
    def __init__(self):
        self.documents = []
        self.vector_store = None
        self.embeddings = OpenAIEmbeddings(openai_api_key=os.getenv('OPENAI_API_KEY'))
        self._initialize_knowledge_base()
    
    def _initialize_knowledge_base(self):
        """Inicializace znalostn√≠ b√°ze se sportovn√≠mi poznatky"""
        try:
            # Vytvo≈ôen√≠ sportovn√≠ch dokument≈Ø
            sports_documents = [
                {
                    'title': 'Fotbalov√° V√Ωkonnost a Statistiky',
                    'content': """
                    Kl√≠ƒçov√© ukazatele v√Ωkonnosti ve fotbale:
                    
                    √ötoƒçn√≠ci:
                    - G√≥ly na z√°pas: Svƒõtov√° ≈°piƒçka 0.5-1.0 g√≥lu/z√°pas
                    - St≈ôeleck√° p≈ôesnost: 35-50% st≈ôel na branku
                    - P≈ôihr√°vky v posledn√≠m p√°smu: 15-25 za z√°pas
                    - Rychlost: ≈†printy nad 25 km/h, celkem 2-4 km za z√°pas
                    
                    Z√°lo≈æn√≠ci:
                    - P≈ôesnost p≈ôihr√°vek: 85-95%
                    - Asistence: 0.2-0.4 za z√°pas
                    - Bƒõ≈æeck√° v√Ωkonnost: 10-12 km za z√°pas
                    - Souboje: 60-70% √∫spƒõ≈°nost
                    
                    Obr√°nci:
                    - √öspƒõ≈°nost skluz≈Ø: 70-80%
                    - Vzdu≈°n√© souboje: 65-75% √∫spƒõ≈°nost
                    - P≈ôesnost dlouh√Ωch p≈ôihr√°vek: 60-75%
                    - Intercepty: 5-8 za z√°pas
                    
                    Brank√°≈ôi:
                    - √öspƒõ≈°nost z√°krok≈Ø: 65-80%
                    - Rozehr√°vka: 75-85% p≈ôesnost
                    - Vysok√© m√≠ƒçe: 90%+ √∫spƒõ≈°nost
                    """
                },
                {
                    'title': 'Prevence Zranƒõn√≠ ve Sportu',
                    'content': """
                    Rizikov√© faktory zranƒõn√≠:
                    
                    Biomechanick√©:
                    - Nespr√°vn√° technika bƒõhu/skoku
                    - Asymetrie v s√≠le nebo flexibility
                    - Nevyv√°≈æen√° z√°tƒõ≈æ na klouby
                    - √önavov√© vzorce pohybu
                    
                    Fyziologick√©:
                    - Vysok√° srdeƒçn√≠ frekvence v klidu
                    - Sn√≠≈æen√° variabilita srdeƒçn√≠ frekvence
                    - Vysok√© hladiny kortizolu
                    - Nedostateƒçn√© zotaven√≠
                    
                    Tr√©ninkov√©:
                    - N√°hl√© zv√Ω≈°en√≠ intenzity
                    - Nedostateƒçn√© rozeh≈ô√°t√≠
                    - Monot√≥nn√≠ zat√≠≈æen√≠
                    - P≈ôetr√©nov√°n√≠
                    
                    Preventivn√≠ opat≈ôen√≠:
                    - Individualizovan√© rozcviƒçky
                    - Silov√© tr√©ninky na stabilitu
                    - Monitoring √∫navy
                    - Postupn√° progrese zat√≠≈æen√≠
                    """
                },
                {
                    'title': 'Optimalizace Tr√©ninkov√Ωch Pl√°n≈Ø',
                    'content': """
                    Periodizace tr√©ninku:
                    
                    Mikrocyklus (t√Ωden):
                    - 2-3 vysokointenzivn√≠ jednotky
                    - 2-3 st≈ôedn√≠ intenzity
                    - 1-2 regeneraƒçn√≠ dny
                    - Pomƒõr zat√≠≈æen√≠/odpoƒçinek 3:1
                    
                    Mezocyklus (mƒõs√≠c):
                    - Postupn√© zvy≈°ov√°n√≠ zat√≠≈æen√≠
                    - Ka≈æd√Ω 4. t√Ωden regeneraƒçn√≠
                    - Specifick√° p≈ô√≠prava na soutƒõ≈æ
                    - Monitoring √∫navy a adaptace
                    
                    Makrocyklus (sez√≥na):
                    - P≈ô√≠pravn√© obdob√≠: objem p≈ôed intenzitou
                    - Soutƒõ≈æn√≠ obdob√≠: udr≈æen√≠ formy
                    - P≈ôechodn√© obdob√≠: aktivn√≠ odpoƒçinek
                    
                    Individualizace:
                    - Vƒõk a zku≈°enosti
                    - Pozice a hern√≠ styl
                    - Historie zranƒõn√≠
                    - Genetick√© predispozice
                    - Psychologick√Ω profil
                    """
                },
                {
                    'title': 'T√Ωmov√° Strategie a Taktika',
                    'content': """
                    Anal√Ωza hern√≠ch situac√≠:
                    
                    √ötoƒçn√° f√°ze:
                    - Dr≈æen√≠ m√≠ƒçe vs. p≈ô√≠moƒçarost
                    - Postaven√≠ v pokutov√©m √∫zem√≠
                    - Standardn√≠ situace
                    - P≈ôechod do √∫toku
                    
                    Obrann√° f√°ze:
                    - Pressing vs. blok
                    - Kompaktnost formace
                    - Pokr√Ωv√°n√≠ prostoru
                    - P≈ôechod do obrany
                    
                    Kl√≠ƒçov√© metriky:
                    - xG (expected goals): 1.5-2.5 pro v√≠tƒõzstv√≠
                    - Dr≈æen√≠ m√≠ƒçe: 45-65% optimum
                    - P≈ôesnost p≈ôihr√°vek: min. 80%
                    - PPDA (passes per defensive action): 8-15
                    
                    Adaptace na soupe≈ôe:
                    - Anal√Ωza slab√Ωch m√≠st
                    - Individu√°ln√≠ pokr√Ωv√°n√≠ hr√°ƒç≈Ø
                    - Vyu≈æit√≠ standardn√≠ch situac√≠
                    - Tempo hry a intenzita
                    """
                }
            ]
            
            # Vytvo≈ôen√≠ Document objekt≈Ø
            for doc_data in sports_documents:
                doc = Document(
                    page_content=doc_data['content'],
                    metadata={'title': doc_data['title'], 'source': 'sports_knowledge'}
                )
                self.documents.append(doc)
            
            # Rozdƒõlen√≠ dokument≈Ø
            text_splitter = RecursiveCharacterTextSplitter(
                chunk_size=600,
                chunk_overlap=50
            )
            
            split_docs = text_splitter.split_documents(self.documents)
            
            # Vytvo≈ôen√≠ vector store
            self.vector_store = Chroma.from_documents(
                split_docs,
                self.embeddings,
                persist_directory="./sports_chroma_db"
            )
            
            logger.info(f"Sportovn√≠ znalostn√≠ b√°ze inicializov√°na s {len(split_docs)} fragmenty")
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi inicializaci znalostn√≠ b√°ze: {e}")

class SportsAnalyticsRAG:
    """RAG syst√©m pro sportovn√≠ anal√Ωzy"""
    
    def __init__(self):
        self.knowledge_base = PerformanceKnowledgeBase()
        self.llm = OpenAI(
            temperature=0.2,
            openai_api_key=os.getenv('OPENAI_API_KEY')
        )
        self.qa_chain = self._setup_qa_chain()
        
        # Specializovan√© prompty
        self.performance_prompt = PromptTemplate(
            input_variables=["player_stats", "context"],
            template="""
            Jako sportovn√≠ analytik analyzuj n√°sleduj√≠c√≠ statistiky hr√°ƒçe a poskytni detailn√≠ hodnocen√≠:
            
            Statistiky hr√°ƒçe: {player_stats}
            
            Kontext z datab√°ze znalost√≠: {context}
            
            Poskytni:
            1. Hodnocen√≠ souƒçasn√© v√Ωkonnosti
            2. Identifikaci siln√Ωch a slab√Ωch str√°nek
            3. Srovn√°n√≠ s benchmarky
            4. Konkr√©tn√≠ doporuƒçen√≠ pro zlep≈°en√≠
            5. Rizikov√© faktory a prevenci
            
            Odpovƒõƒè form√°tuj jasnƒõ a strukturovanƒõ.
            """
        )
    
    def _setup_qa_chain(self):
        """Nastaven√≠ QA ≈ôetƒõzce"""
        try:
            if self.knowledge_base.vector_store:
                retriever = self.knowledge_base.vector_store.as_retriever(
                    search_kwargs={"k": 4}
                )
                
                qa_chain = RetrievalQA.from_chain_type(
                    llm=self.llm,
                    chain_type="stuff",
                    retriever=retriever,
                    return_source_documents=True
                )
                
                return qa_chain
            return None
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi nastaven√≠ QA ≈ôetƒõzce: {e}")
            return None
    
    def analyze_player_performance(self, player_id: str, 
                                 game_stats: List[GameStatistics]) -> Dict[str, Any]:
        """Anal√Ωza v√Ωkonnosti hr√°ƒçe"""
        try:
            if not game_stats:
                return {'error': '≈Ω√°dn√© statistiky k anal√Ωze'}
            
            # V√Ωpoƒçet agregovan√Ωch statistik
            total_games = len(game_stats)
            avg_stats = {
                'goals_per_game': sum(s.goals for s in game_stats) / total_games,
                'assists_per_game': sum(s.assists for s in game_stats) / total_games,
                'pass_accuracy': sum(s.pass_accuracy for s in game_stats) / total_games,
                'avg_distance': sum(s.distance_covered for s in game_stats) / total_games,
                'avg_max_speed': sum(s.max_speed for s in game_stats) / total_games,
                'avg_heart_rate': sum(s.avg_heart_rate for s in game_stats) / total_games
            }
            
            # Trend anal√Ωza
            recent_games = game_stats[:5]  # Posledn√≠ch 5 z√°pas≈Ø
            if len(recent_games) >= 3:
                recent_avg_goals = sum(s.goals for s in recent_games) / len(recent_games)
                form_trend = "stoupaj√≠c√≠" if recent_avg_goals > avg_stats['goals_per_game'] else "klesaj√≠c√≠"
            else:
                form_trend = "nedostatek dat"
            
            # P≈ô√≠prava dat pro AI anal√Ωzu
            stats_summary = f"""
            Hr√°ƒç ID: {player_id}
            Analyzovan√Ωch z√°pas≈Ø: {total_games}
            
            Pr≈Ømƒõrn√© statistiky:
            - G√≥ly na z√°pas: {avg_stats['goals_per_game']:.2f}
            - Asistence na z√°pas: {avg_stats['assists_per_game']:.2f}
            - P≈ôesnost p≈ôihr√°vek: {avg_stats['pass_accuracy']:.1%}
            - Pr≈Øbƒõhnut√° vzd√°lenost: {avg_stats['avg_distance']:.1f} km
            - Maxim√°ln√≠ rychlost: {avg_stats['avg_max_speed']:.1f} km/h
            - Pr≈Ømƒõrn√° srdeƒçn√≠ frekvence: {avg_stats['avg_heart_rate']:.0f} bpm
            
            Forma: {form_trend}
            """
            
            # AI anal√Ωza
            if self.qa_chain:
                query = f"Analyzuj v√Ωkonnost hr√°ƒçe na z√°kladƒõ tƒõchto statistik: {stats_summary}"
                result = self.qa_chain({"query": query})
                
                ai_analysis = result['result']
                source_docs = [doc.page_content[:200] + "..." for doc in result['source_documents']]
            else:
                ai_analysis = "AI anal√Ωza nen√≠ dostupn√°"
                source_docs = []
            
            return {
                'player_id': player_id,
                'analysis_period': f"{game_stats[-1].date} - {game_stats[0].date}",
                'aggregate_stats': avg_stats,
                'form_trend': form_trend,
                'ai_analysis': ai_analysis,
                'source_knowledge': source_docs,
                'detailed_recommendations': self._generate_recommendations(avg_stats),
                'analysis_timestamp': datetime.now().isoformat()
            }
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi anal√Ωze v√Ωkonnosti: {e}")
            return {'error': str(e)}
    
    def _generate_recommendations(self, stats: Dict[str, float]) -> List[str]:
        """Generov√°n√≠ konkr√©tn√≠ch doporuƒçen√≠"""
        recommendations = []
        
        if stats['goals_per_game'] < 0.3:
            recommendations.append("Zamƒõ≈ôit se na dokonƒçov√°n√≠ akc√≠ a st≈ôeleckou p≈ô√≠pravu")
        
        if stats['pass_accuracy'] < 0.8:
            recommendations.append("Zlep≈°it techniku p≈ôihr√°vek a rozhodov√°n√≠ pod tlakem")
        
        if stats['avg_distance'] < 9.0:
            recommendations.append("Zv√Ω≈°it bƒõ≈æeckou aktivitu a zapojen√≠ do hry")
        
        if stats['avg_max_speed'] < 28.0:
            recommendations.append("Pracovat na explozivn√≠ rychlosti a sprintech")
        
        if not recommendations:
            recommendations.append("Udr≈æet souƒçasnou √∫rove≈à v√Ωkonnosti a pracovat na konzistenci")
        
        return recommendations
    
    def predict_injury_risk(self, biomech_data: List[BiomechanicalData]) -> Dict[str, Any]:
        """Predikce rizika zranƒõn√≠"""
        try:
            if not biomech_data:
                return {'error': '≈Ω√°dn√° biomechanick√° data'}
            
            # Anal√Ωza trend≈Ø v riziku zranƒõn√≠
            risk_scores = [data.injury_risk_score for data in biomech_data]
            avg_risk = np.mean(risk_scores)
            max_risk = np.max(risk_scores)
            trend = np.polyfit(range(len(risk_scores)), risk_scores, 1)[0]
            
            # Kategorizace rizika
            if avg_risk < 0.3:
                risk_level = "N√≠zk√©"
                color = "green"
            elif avg_risk < 0.6:
                risk_level = "St≈ôedn√≠"
                color = "yellow"
            else:
                risk_level = "Vysok√©"
                color = "red"
            
            # AI doporuƒçen√≠ pro prevenci
            query = f"""
            Analyzuj riziko zranƒõn√≠ s tƒõmito parametry:
            - Pr≈Ømƒõrn√© riziko: {avg_risk:.3f}
            - Maxim√°ln√≠ riziko: {max_risk:.3f}
            - Trend: {'rostouc√≠' if trend > 0 else 'klesaj√≠c√≠'}
            - √örove≈à rizika: {risk_level}
            
            Poskytni preventivn√≠ doporuƒçen√≠.
            """
            
            if self.qa_chain:
                result = self.qa_chain({"query": query})
                prevention_advice = result['result']
            else:
                prevention_advice = "AI poradenstv√≠ nen√≠ dostupn√©"
            
            return {
                'risk_assessment': {
                    'average_risk': avg_risk,
                    'maximum_risk': max_risk,
                    'risk_level': risk_level,
                    'trend': 'rostouc√≠' if trend > 0 else 'klesaj√≠c√≠',
                    'color_indicator': color
                },
                'prevention_recommendations': prevention_advice,
                'data_points_analyzed': len(biomech_data),
                'assessment_timestamp': datetime.now().isoformat()
            }
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi predikci rizika zranƒõn√≠: {e}")
            return {'error': str(e)}

class SportsVisualizer:
    """Vizualizace sportovn√≠ch dat"""
    
    def __init__(self):
        plt.style.use('seaborn-v0_8')
        
    def create_performance_dashboard(self, player_analysis: Dict[str, Any]) -> go.Figure:
        """Vytvo≈ôen√≠ dashboardu v√Ωkonnosti"""
        try:
            stats = player_analysis['aggregate_stats']
            
            fig = make_subplots(
                rows=2, cols=3,
                subplot_titles=(
                    'G√≥lov√° Produktivita', 'Fyzick√° V√Ωkonnost', 'Srdeƒçn√≠ Frekvence',
                    'P≈ôesnost P≈ôihr√°vek', 'Trend Formy', 'Celkov√© Hodnocen√≠'
                ),
                specs=[
                    [{"type": "bar"}, {"type": "scatter"}, {"type": "indicator"}],
                    [{"type": "pie"}, {"type": "scatter"}, {"type": "indicator"}]
                ]
            )
            
            # 1. G√≥lov√° produktivita
            fig.add_trace(
                go.Bar(
                    x=['G√≥ly', 'Asistence'],
                    y=[stats['goals_per_game'], stats['assists_per_game']],
                    marker_color=['#FF6B6B', '#4ECDC4'],
                    name='Produktivita'
                ),
                row=1, col=1
            )
            
            # 2. Fyzick√° v√Ωkonnost
            fig.add_trace(
                go.Scatter(
                    x=[stats['avg_distance']],
                    y=[stats['avg_max_speed']],
                    mode='markers',
                    marker=dict(size=20, color='#45B7D1'),
                    name='Fyzick√° v√Ωkonnost'
                ),
                row=1, col=2
            )
            
            # 3. Srdeƒçn√≠ frekvence - gauge
            fig.add_trace(
                go.Indicator(
                    mode="gauge+number",
                    value=stats['avg_heart_rate'],
                    title={'text': "Avg HR (bpm)"},
                    gauge={'axis': {'range': [120, 200]},
                           'bar': {'color': "red"},
                           'steps': [{'range': [120, 150], 'color': "lightgray"},
                                    {'range': [150, 180], 'color': "gray"}]}
                ),
                row=1, col=3
            )
            
            # 4. P≈ôesnost p≈ôihr√°vek
            pass_acc = stats['pass_accuracy']
            fig.add_trace(
                go.Pie(
                    labels=['√öspƒõ≈°n√©', 'Ne√∫spƒõ≈°n√©'],
                    values=[pass_acc, 1-pass_acc],
                    marker_colors=['#2ECC71', '#E74C3C']
                ),
                row=2, col=1
            )
            
            # 5. Simulovan√Ω trend formy
            games = list(range(1, 11))
            form_trend = np.random.normal(stats['goals_per_game'], 0.2, 10)
            fig.add_trace(
                go.Scatter(
                    x=games,
                    y=form_trend,
                    mode='lines+markers',
                    line=dict(color='#9B59B6'),
                    name='Forma'
                ),
                row=2, col=2
            )
            
            # 6. Celkov√© hodnocen√≠
            overall_score = (
                stats['goals_per_game'] * 30 +
                stats['assists_per_game'] * 20 +
                stats['pass_accuracy'] * 40 +
                (stats['avg_distance'] / 12) * 10
            )
            
            fig.add_trace(
                go.Indicator(
                    mode="gauge+number",
                    value=overall_score,
                    title={'text': "Celkov√© Hodnocen√≠"},
                    gauge={'axis': {'range': [0, 100]},
                           'bar': {'color': "gold"},
                           'steps': [{'range': [0, 50], 'color': "lightgray"},
                                    {'range': [50, 75], 'color': "gray"},
                                    {'range': [75, 100], 'color': "lightgreen"}]}
                ),
                row=2, col=3
            )
            
            fig.update_layout(
                height=800,
                title_text=f"Dashboard V√Ωkonnosti - Hr√°ƒç {player_analysis.get('player_id', 'N/A')}",
                showlegend=False
            )
            
            return fig
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi vytv√°≈ôen√≠ dashboardu: {e}")
            return go.Figure()
    
    def create_injury_risk_chart(self, risk_data: Dict[str, Any]) -> go.Figure:
        """Graf rizika zranƒõn√≠"""
        try:
            risk_assessment = risk_data['risk_assessment']
            
            # Simulace historick√Ωch dat
            days = pd.date_range(start='2024-01-01', periods=30, freq='D')
            risk_history = np.random.beta(2, 5, 30) * 0.8 + 0.1
            
            fig = go.Figure()
            
            # Historick√Ω trend
            fig.add_trace(
                go.Scatter(
                    x=days,
                    y=risk_history,
                    mode='lines+markers',
                    name='Historick√© riziko',
                    line=dict(color='blue', width=2)
                )
            )
            
            # Souƒçasn√© riziko
            fig.add_hline(
                y=risk_assessment['average_risk'],
                line_dash="dash",
                line_color=risk_assessment['color_indicator'],
                annotation_text=f"Souƒçasn√© riziko: {risk_assessment['risk_level']}"
            )
            
            # Prahov√© hodnoty
            fig.add_hrect(
                y0=0, y1=0.3,
                fillcolor="green", opacity=0.1,
                annotation_text="N√≠zk√© riziko", annotation_position="top left"
            )
            
            fig.add_hrect(
                y0=0.3, y1=0.6,
                fillcolor="yellow", opacity=0.1,
                annotation_text="St≈ôedn√≠ riziko", annotation_position="top left"
            )
            
            fig.add_hrect(
                y0=0.6, y1=1.0,
                fillcolor="red", opacity=0.1,
                annotation_text="Vysok√© riziko", annotation_position="top left"
            )
            
            fig.update_layout(
                title="Anal√Ωza Rizika Zranƒõn√≠",
                xaxis_title="Datum",
                yaxis_title="Sk√≥re Rizika (0-1)",
                yaxis=dict(range=[0, 1]),
                template='plotly_white'
            )
            
            return fig
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi vytv√°≈ôen√≠ grafu rizika: {e}")
            return go.Figure()

class SportsAnalyticsSystem:
    """Hlavn√≠ syst√©m sportovn√≠ anal√Ωzy"""
    
    def __init__(self):
        self.data_manager = SportDataManager()
        self.biomech_analyzer = BiomechanicalAnalyzer()
        self.rag_system = SportsAnalyticsRAG()
        self.visualizer = SportsVisualizer()
        
        # Inicializace uk√°zkov√Ωch dat
        self.data_manager.create_sample_data()
    
    def comprehensive_player_analysis(self, player_id: str) -> Dict[str, Any]:
        """Komplexn√≠ anal√Ωza hr√°ƒçe"""
        try:
            # Z√≠sk√°n√≠ statistik
            game_stats = self.data_manager.get_player_statistics(player_id, days=60)
            
            if not game_stats:
                return {'error': f'≈Ω√°dn√© statistiky pro hr√°ƒçe {player_id}'}
            
            # Anal√Ωza v√Ωkonnosti
            performance_analysis = self.rag_system.analyze_player_performance(player_id, game_stats)
            
            # Simulace biomechanick√Ωch dat (v re√°ln√© aplikaci by byla z videa/senzor≈Ø)
            biomech_data = self._generate_sample_biomech_data(player_id)
            
            # Anal√Ωza rizika zranƒõn√≠
            injury_risk = self.rag_system.predict_injury_risk(biomech_data)
            
            # Vytvo≈ôen√≠ vizualizac√≠
            performance_dashboard = self.visualizer.create_performance_dashboard(performance_analysis)
            injury_chart = self.visualizer.create_injury_risk_chart(injury_risk)
            
            return {
                'player_id': player_id,
                'performance_analysis': performance_analysis,
                'injury_risk_assessment': injury_risk,
                'visualizations': {
                    'performance_dashboard': performance_dashboard.to_json(),
                    'injury_risk_chart': injury_chart.to_json()
                },
                'recommendations': self._compile_recommendations(performance_analysis, injury_risk),
                'analysis_timestamp': datetime.now().isoformat()
            }
            
        except Exception as e:
            logger.error(f"Chyba p≈ôi komplexn√≠ anal√Ωze: {e}")
            return {'error': str(e)}
    
    def _generate_sample_biomech_data(self, player_id: str) -> List[BiomechanicalData]:
        """Generov√°n√≠ uk√°zkov√Ωch biomechanick√Ωch dat"""
        biomech_data = []
        
        for i in range(20):  # 20 mƒõ≈ôen√≠
            timestamp = (datetime.now() - timedelta(hours=i)).isoformat()
            
            data = BiomechanicalData(
                timestamp=timestamp,
                player_id=player_id,
                joint_angles={
                    'knee_left': np.random.uniform(10, 170),
                    'knee_right': np.random.uniform(10, 170),
                    'ankle_left': np.random.uniform(70, 110),
                    'ankle_right': np.random.uniform(70, 110)
                },
                force_distribution={
                    'left_foot': np.random.uniform(0.3, 0.7),
                    'right_foot': np.random.uniform(0.3, 0.7)
                },
                acceleration={
                    'x': np.random.uniform(-5, 5),
                    'y': np.random.uniform(-5, 5),
                    'z': np.random.uniform(-2, 2)
                },
                activity_type='training',
                injury_risk_score=np.random.beta(2, 8)  # P≈ôev√°≈ænƒõ n√≠zk√© riziko
            )
            
            biomech_data.append(data)
        
        return biomech_data
    
    def _compile_recommendations(self, performance: Dict[str, Any], 
                               injury_risk: Dict[str, Any]) -> Dict[str, List[str]]:
        """Kompilace v≈°ech doporuƒçen√≠"""
        recommendations = {
            'performance_improvements': performance.get('detailed_recommendations', []),
            'injury_prevention': [],
            'training_focus': [],
            'immediate_actions': []
        }
        
        # Doporuƒçen√≠ pro prevenci zranƒõn√≠
        risk_level = injury_risk.get('risk_assessment', {}).get('risk_level', 'Nezn√°m√©')
        
        if risk_level == 'Vysok√©':
            recommendations['immediate_actions'].extend([
                'Konzultace s fyziotherapeutem',
                'Sn√≠≈æen√≠ tr√©ninkov√© intenzity',
                'D≈Øraz na regeneraci'
            ])
        elif risk_level == 'St≈ôedn√≠':
            recommendations['injury_prevention'].extend([
                'Monitoring biomechaniky',
                'Preventivn√≠ cviƒçen√≠',
                'Pravideln√© kontroly'
            ])
        
        # Tr√©ninkov√© doporuƒçen√≠
        avg_stats = performance.get('aggregate_stats', {})
        if avg_stats.get('goals_per_game', 0) < 0.5:
            recommendations['training_focus'].append('St≈ôeleck√° p≈ô√≠prava')
        
        if avg_stats.get('pass_accuracy', 1) < 0.85:
            recommendations['training_focus'].append('Technick√° pr√°ce s m√≠ƒçem')
        
        return recommendations

# Demonstraƒçn√≠ pou≈æit√≠
def main():
    """Demonstrace funkcionality syst√©mu"""
    try:
        print("üèÜ Inicializace Syst√©mu Sportovn√≠ Anal√Ωzy...")
        system = SportsAnalyticsSystem()
        
        # Test anal√Ωzy hr√°ƒçe
        player_id = "P001"
        print(f"\nüìä Spou≈°t√≠m komplexn√≠ anal√Ωzu hr√°ƒçe {player_id}...")
        
        analysis = system.comprehensive_player_analysis(player_id)
        
        if 'error' not in analysis:
            print("\n‚úÖ V√ùSLEDKY ANAL√ùZY:")
            print("=" * 60)
            
            # V√Ωkonnostn√≠ anal√Ωza
            performance = analysis['performance_analysis']
            if 'aggregate_stats' in performance:
                stats = performance['aggregate_stats']
                print(f"üéØ V√ùKONNOSTN√ç STATISTIKY:")
                print(f"   ‚Ä¢ G√≥ly na z√°pas: {stats['goals_per_game']:.2f}")
                print(f"   ‚Ä¢ Asistence na z√°pas: {stats['assists_per_game']:.2f}")
                print(f"   ‚Ä¢ P≈ôesnost p≈ôihr√°vek: {stats['pass_accuracy']:.1%}")
                print(f"   ‚Ä¢ Pr≈Ømƒõrn√° rychlost: {stats['avg_max_speed']:.1f} km/h")
                print(f"   ‚Ä¢ Forma: {performance.get('form_trend', 'N/A')}")
            
            # Riziko zranƒõn√≠
            injury_risk = analysis['injury_risk_assessment']
            if 'risk_assessment' in injury_risk:
                risk = injury_risk['risk_assessment']
                print(f"\n‚öïÔ∏è ANAL√ùZA RIZIKA ZRANƒöN√ç:")
                print(f"   ‚Ä¢ √örove≈à rizika: {risk['risk_level']}")
                print(f"   ‚Ä¢ Pr≈Ømƒõrn√© sk√≥re: {risk['average_risk']:.3f}")
                print(f"   ‚Ä¢ Trend: {risk['trend']}")
            
            # Doporuƒçen√≠
            recommendations = analysis['recommendations']
            print(f"\nüí° KL√çƒåOV√Å DOPORUƒåEN√ç:")
            for category, items in recommendations.items():
                if items:
                    print(f"   {category.replace('_', ' ').title()}:")
                    for item in items[:2]:  # Zobraz max 2 polo≈æky
                        print(f"   ‚Ä¢ {item}")
            
            print(f"\nüïê Anal√Ωza dokonƒçena: {analysis['analysis_timestamp']}")
            
        else:
            print(f"‚ùå Chyba p≈ôi anal√Ωze: {analysis['error']}")
            
    except Exception as e:
        logger.error(f"Chyba v main funkci: {e}")

if __name__ == "__main__":
    # Nastaven√≠ environment variables
    # os.environ['OPENAI_API_KEY'] = 'your-openai-api-key-here'
    
    main()
````

### Po≈æadovan√© z√°vislosti

````toml
# Core AI/ML libraries
langchain==0.0.350
openai==1.3.0
chromadb==0.4.18

# Computer Vision
opencv-python==4.8.1.78
mediapipe==0.10.8

# Machine Learning
scikit-learn==1.3.2
numpy==1.24.4
pandas==2.1.3

# Visualization
matplotlib==3.8.2
seaborn==0.13.0
plotly==5.17.0

# Database and utilities
sqlite3
requests==2.31.0
python-dotenv==1.0.0

# Optional: Advanced features
tensorflow==2.15.0
streamlit==1.28.2
````

### Instalaƒçn√≠ skript

````bash
#!/bin/bash

echo "üèÜ Nastaven√≠ prost≈ôed√≠ pro Sportovn√≠ Anal√Ωzu..."

# Vytvo≈ôen√≠ virtu√°ln√≠ho prost≈ôed√≠
python -m venv sports_env
source sports_env/bin/activate  # Windows: sports_env\Scripts\activate

# Instalace z√°vislost√≠
pip install -r requirements.txt

# Vytvo≈ôen√≠ adres√°≈ô≈Ø
mkdir -p data/videos
mkdir -p data/biomechanics
mkdir -p results/analysis
mkdir -p sports_chroma_db

echo "‚úÖ Prost≈ôed√≠ √∫spƒõ≈°nƒõ nastaveno!"
echo "üìù Nezapome≈àte nastavit OPENAI_API_KEY v .env souboru"
echo "üé• Um√≠stƒõte tr√©ninkov√© videa do data/videos/"
````

## 5. Shrnut√≠ Projektu

### Kl√≠ƒçov√° Hodnota Projektu
Syst√©m sportovn√≠ anal√Ωzy s RAG technologi√≠ p≈ôin√°≈°√≠ revoluci v oblasti:

- **Personalizovan√© anal√Ωzy**: AI-driven poznatky p≈ôizp≈Øsoben√© jednotliv√Ωm hr√°ƒç≈Øm
- **Prediktivn√≠ zdravotnictv√≠**: Prevence zranƒõn√≠ zalo≈æen√° na biomechanick√Ωch datech
- **Optimalizace v√Ωkonnosti**: Data-driven doporuƒçen√≠ pro zlep≈°en√≠ hern√≠ho v√Ωkonu
- **Strategick√© pl√°nov√°n√≠**: Inteligentn√≠ podpora rozhodov√°n√≠ tren√©r≈Ø a analytik≈Ø
- **Demokratizace pokroƒçil√Ωch anal√Ωz**: P≈ô√≠stup k profesion√°ln√≠m n√°stroj≈Øm pro v≈°echny √∫rovnƒõ

### Technologick√© Inovace
- **Multimod√°ln√≠ RAG**: Kombinace textov√Ωch, video a senzorov√Ωch dat
- **Real-time processing**: Okam≈æit√© zpracov√°n√≠ bƒõhem live ud√°lost√≠
- **Biomechanick√° AI**: Pokroƒçil√© rozpozn√°v√°n√≠ pohybov√Ωch vzorc≈Ø
- **Prediktivn√≠ modelov√°n√≠**: Machine learning pro prevenci zranƒõn√≠
- **Integrovan√° platforma**: Spojen√≠ v≈°ech aspekt≈Ø sportovn√≠ anal√Ωzy

### Obchodn√≠ P≈ô√≠nosy
- **Konkurenƒçn√≠ v√Ωhoda**: Lep≈°√≠ v√Ωkonnost t√Ωm≈Ø a jednotlivc≈Ø
- **Sn√≠≈æen√≠ n√°klad≈Ø**: Prevence zranƒõn√≠ a optimalizace tr√©nink≈Ø
- **Roz≈°√≠≈ôen√≠ trhu**: Nov√© slu≈æby pro sportovn√≠ organizace
- **Vƒõdeck√Ω pokrok**: Pokroƒçil√© poznatky o lidsk√© v√Ωkonnosti
- **Fan engagement**: Obohacen√≠ z√°≈æitku pro fanou≈°ky

Tento projekt p≈ôedstavuje budoucnost sportovn√≠ anal√Ωzy, kde AI a pokroƒçil√© technologie umo≈æ≈àuj√≠ dosa≈æen√≠ nov√Ωch v√Ω≈°in lidsk√© v√Ωkonnosti p≈ôi zachov√°n√≠ zdrav√≠ a bezpeƒçnosti atlet≈Ø.